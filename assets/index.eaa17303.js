var _e=Object.defineProperty,me=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var te=(e,t,o)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,K=(e,t)=>{for(var o in t||(t={}))ve.call(t,o)&&te(e,o,t[o]);if(ee)for(var o of ee(t))fe.call(t,o)&&te(e,o,t[o]);return e},se=(e,t)=>me(e,he(t));import{d as ae,o as be,I as ge,c as ye,s as xe,A as $e,g as w,a as f,b as P,u as F,e as W,f as D,r as U,h as r,i as p,j as s,F as k,k as C,l as v,w as g,m as N,t as h,n as m,p as X,q as Q,v as x,x as b,y as O,z as V,B as ke,C as we,D as ue,E as re,G as Ce,H as $,J as ce,S as Ee,K as Ae,L as Be,P as De,M as ie,N as le,O as Ie,Q as Re,R as Se,T as Le,U as J,V as q,W as Pe,X as Ne,Y as Me,Z as de,_ as qe,$ as Fe,a0 as Ue,a1 as Oe,a2 as Te,a3 as He,a4 as Ve,a5 as Ge,a6 as je,a7 as ze,a8 as Xe,a9 as Qe,aa as Je,ab as Ye,ac as Ze}from"./vendor.737048de.js";const Ke=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}};Ke();const R=ae("error",{state:()=>({loading:!1,errorMessage:""}),actions:{setErrorMessage(e){this.errorMessage=e},setLoading(e){this.loading=e}}}),We=be(({graphQLErrors:e})=>{if(e){const{message:t}=e[0];R().setErrorMessage(t)}});let z=0;const et=async(e,t)=>{R().setErrorMessage(""),z++,z===1&&!R().loading&&R().setLoading(!0);const o=await fetch(e,t);return setTimeout(()=>{z--,z===0&&R().loading&&R().setLoading(!1)},300),o},tt=new ge({typePolicies:{Query:{fields:{PRODUCT_QUERY:{merge:!0}}}}}),st=ye({uri:"https://sx3pwmngq3.execute-api.us-east-1.amazonaws.com/dev/graphql",fetch:et}),nt=xe((e,{headers:t})=>{const o=localStorage.getItem("token");return o?{headers:se(K({},t),{Authorization:o||null})}:{headers:K({},t)}}),E=new $e({link:nt.concat(We.concat(st)),cache:tt});var ot=async()=>{try{const{data:{me:e}}=await E.query({query:w`
        query me {
          me {
            phone
            point
            isAdmin
            exchangeRecords {
              id
              point
              productName
              createdAt
            }
            consumeRecords {
              id
              point
              createdAt
            }
          }
        }
      `,fetchPolicy:"no-cache"});return e}catch(e){console.log(e)}},ne=({phone:e,password:t})=>({login:async()=>{try{const{data:{login:n}}=await E.mutate({mutation:w`
          mutation login($input: LoginInput!) {
            login(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return n.token}catch(n){throw n}},adminLogin:async()=>{try{const{data:{adminLogin:n}}=await E.mutate({mutation:w`
          mutation adminLogin($input: LoginInput!) {
            adminLogin(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return n.token}catch(n){throw n}}}),at=e=>({register:async()=>{try{await E.mutate({mutation:w`
          mutation register($input: RegisterInput!) {
            register(input: $input) {
              phone
            }
          }
        `,variables:{input:{phone:e}}})}catch(o){throw o}}});const oe={phone:"",point:0,exchangeRecords:[],consumeRecords:[],isAdmin:!1},I=ae("auth",{state:()=>({accessToken:null,user:oe}),getters:{isLogin(){return!!this.accessToken},isAdmin(){return this.user.isAdmin},point(){return this.user.point},exchangeRecords(){return this.user.exchangeRecords},consumeRecords(){return this.user.consumeRecords}},actions:{async authLogin({phone:e,password:t}){const{login:o}=ne({phone:e,password:t});try{const a=await o();this.setToken(a)}catch(a){throw a}},async authRegister({phone:e}){const{register:t}=at(e);await t(),await this.authLogin({phone:e,password:e})},async adminLogin({phone:e,password:t}){const{adminLogin:o}=ne({phone:e,password:t});try{const a=await o();this.setToken(a)}catch(a){throw a}},authLogout(){this.removeToken(),this.setUser(oe)},setToken(e){!e||(this.accessToken=e,localStorage.setItem("token",e))},removeToken(){this.accessToken=null,localStorage.removeItem("token")},setUser(e){this.user=e},async fetchMe(){const e=await ot();!e||this.setUser(e)}}});var A=(e,t)=>{const o=e.__vccOpts||e;for(const[a,n]of t)o[a]=n;return o};const pe=e=>(X("data-v-7b471e2e"),e=e(),Q(),e),ut={class:"w-56 bg-primary-light"},rt={class:"h-full"},ct={class:"h-full p-10 flex flex-col items-center"},it=pe(()=>s("li",{class:"mb-5 logo"},null,-1)),lt={key:0},dt=pe(()=>s("button",{class:"btn btn-primary w-40"},"\u7BA1\u7406\u8005",-1)),pt={key:1},_t=f({setup(e){const{isLogin:t}=P(I()),o=F(),a=W(),n=D(()=>{const l=a.name;return l?l.includes("admin"):!1}),c=D(()=>!t.value||a.name==="home"?[]:n.value?[{label:"\u5546\u54C1",to:"/admin/products"},{label:"\u4FEE\u6539\u5B89\u5168\u78BC",to:"/admin/code"},{label:"\u7D00\u9304",to:"/admin/records"}]:[{label:"\u96C6\u9EDE\u5361",to:"/points"},{label:"\u514C\u63DB",to:"/exchange"},{label:"\u7D00\u9304",to:"/records"}]),{authLogout:u}=I(),i=async()=>{if(await u(),n.value){await o.push("/admin/login");return}await o.push("/")};return(l,d)=>{const _=U("router-link");return r(),p("aside",ut,[s("nav",rt,[s("ul",ct,[it,(r(!0),p(k,null,C(m(c),({label:y,to:B})=>(r(),p("li",{key:y},[v(_,{to:B},{default:g(()=>[N(h(y),1)]),_:2},1032,["to"])]))),128)),m(t)?(r(),p("li",pt,[s("button",{class:"btn btn-primary w-40",onClick:i},h(m(n)?"\u767B\u51FA":"\u5B8C\u6210"),1)])):(r(),p("li",lt,[v(_,{to:"/admin/login"},{default:g(()=>[dt]),_:1})]))])])])}}});var mt=A(_t,[["__scopeId","data-v-7b471e2e"]]);const ht={class:"h-screen flex"},vt={key:0,class:"fixed z-50 inset-0 bg-black bg-opacity-60 flex-center text-white"},ft=f({setup(e){const{loading:t}=P(R()),o=W(),a=F(),n=I(),c=D(()=>o.name==="admin-login");a.beforeEach(async l=>{const d=await localStorage.getItem("token");d&&(await n.setToken(d),await n.fetchMe());const _=u(d);if(_&&i(_))return await n.removeToken(),{name:"home"};if(l.meta.requiresAdmin&&!n.isAdmin)return{name:"admin-login"};if(l.meta.requiresAuth&&!n.isLogin)return{name:"home"}});const u=l=>{try{if(!l)return null;const{exp:d}=JSON.parse(atob(l.split(".")[1]));return d}catch{return null}},i=l=>Date.now()>l*1e3;return(l,d)=>{const _=U("router-view");return r(),p("div",ht,[m(t)?(r(),p("div",vt," Loading ... ")):x("",!0),m(c)?(r(),p("main",{key:2,class:O(["flex-1 pt-16 px-10 overflow-x-hidden relative",{"bg-white":m(c)}])},[v(_)],2)):(r(),b(mt,{key:1}))])}}}),bt="\u54C8\u56C9\uFF01\u9019\u662F\u500B vue \u5C08\u6848",gt="\u7B49\u5F85\u4E2D...";var yt={hello:bt,"My name is":"\u6211\u7684\u540D\u5B57\u662F","Ching Hui":"\u6674\u60E0","I'm a Uaena, also a frontend developer :)":"\u6211\u662FUaena\uFF0C\u4E5F\u662F\u4E00\u540D\u524D\u7AEF\u5DE5\u7A0B\u5E2B :)",loading:gt};const xt="Hello! It's a vue project",$t="loading...";var kt={hello:xt,"My name is":"My name is","Ching Hui":"Ching Hui","I'm a Uaena, also a frontend developer :)":"I'm a Uaena, also a rontend developer :)",loading:$t};class wt{set(t,o,a=30){const n={value:o,ttl:Date.now()+a*1e4};localStorage.setItem(t,JSON.stringify(n))}get(t){const o=localStorage.getItem(t);if(!o)return null;const{ttl:a,value:n}=JSON.parse(o);return Date.now()>a?(localStorage.removeItem(t),null):n}}const Ct={install:e=>{const t=new wt;e.provide("storage",t)}},S=f({props:{pack:{default:"fas"},icon:{default:""}},setup(e){return(t,o)=>{const a=U("font-awesome-icon");return r(),b(a,{icon:[e.pack,e.icon]},null,8,["icon"])}}}),Et=["onClick"],At={class:"modal min-w-[300px] bg-white p-6 pt-10 rounded-lg relative"},Bt={key:0,class:"h1 text-center mb-4"},Y=f({props:{title:{default:""}},emits:["close"],setup(e,{emit:t}){const o=()=>{t("close")};return(a,n)=>(r(),p("div",{class:"fixed inset-0 z-40 bg-black bg-opacity-60 flex-center",onClick:ke(o,["self"])},[s("div",At,[v(S,{icon:"plus",class:"rotate-45 absolute right-3 top-3 cursor-pointer",onClick:o}),V(a.$slots,"title",{},()=>[e.title?(r(),p("div",Bt,h(e.title),1)):x("",!0)]),V(a.$slots,"default")])],8,Et))}}),Dt={class:"flex items-center space-x-4"},It=f({emits:["close","submit"],setup(e,{emit:t}){return(o,a)=>(r(),b(Y,{title:"\u65B0\u865F\u78BC,\u662F\u5426\u8981\u8A3B\u518A?",onClose:a[2]||(a[2]=n=>t("close"))},{default:g(()=>[s("div",Dt,[s("button",{class:"btn btn-outline-primary btn-block",onClick:a[0]||(a[0]=n=>t("close"))}," \u53D6\u6D88 "),s("button",{class:"btn btn-primary btn-block",onClick:a[1]||(a[1]=n=>t("submit"))}," \u78BA\u8A8D ")])]),_:1}))}});const Rt=e=>(X("data-v-2f1876ce"),e=e(),Q(),e),St={class:"flex flex-col items-center"},Lt=Rt(()=>s("h2",{class:"h1 text-center mb-5"},"LOGIN",-1)),Pt={class:"wrapper"},Nt={class:"phone-input flex items-center"},Mt={key:0,class:"w-10 h-10 flex-center rounded-full border border-green-500 text-green-500"},qt={class:"phone-pad"},Ft=["onClick"],Ut={key:0},Ot={key:2},Tt=f({props:{phone:null},emits:["submit","input"],setup(e,{emit:t}){const o=e,a=8,n=10,c=11,u=12,i=D(()=>/((?=(09))[0-9]{10})$/g.test(o.phone));return we(()=>{const l=[...Array(10)].map((d,_)=>`${_}`);document.addEventListener("keyup",({key:d,keyCode:_})=>{(_>=48&&_<=57||_>=96&&_<=105)&&l.includes(d)&&t("input",d),_===a&&t("input",n)})}),(l,d)=>(r(),p("div",St,[Lt,s("div",Pt,[s("div",Nt,[ue(s("input",{"onUpdate:modelValue":d[0]||(d[0]=_=>Ce(phone)?phone.value=_:null),maxlength:"10",class:"flex-1 outline-none",readonly:""},null,512),[[re,e.phone]]),m(i)?(r(),p("div",Mt,[m(i)?(r(),b(S,{key:0,icon:"check",class:"text-xl"})):x("",!0)])):x("",!0)]),s("div",qt,[(r(),p(k,null,C(12,_=>s("button",{key:_,class:O(["phone-button",{invalid:!m(i),"login-button":_===u}]),onClick:y=>t("input",_)},[_<10?(r(),p("span",Ut,h(_),1)):_===n?(r(),b(S,{key:1,icon:"plus",class:"rotate-45"})):_===c?(r(),p("span",Ot,"0")):_===u?(r(),b(S,{key:3,icon:"check",class:"check-icon"})):x("",!0)],10,Ft)),64))])])]))}});var Ht=A(Tt,[["__scopeId","data-v-2f1876ce"]]);const Vt=f({setup(e){const c=$(!1),u=$("");D(()=>/((?=(09))[0-9]{10})$/g.test(u.value));const i=M=>{let H=String(M);if(M===10){u.value=u.value.slice(0,-1);return}if(M===12){j();return}M===11&&(H="0"),!(u.value.length>=10)&&(u.value+=H)},l=F(),{isLogin:d}=P(I()),{authLogin:_,authRegister:y}=I();ce(()=>{d.value&&l.push("/points")});const B=async()=>{c.value=!1,await y({phone:u.value}),alert("\u5B8C\u6210")},j=async()=>{try{await _({phone:u.value,password:u.value})}catch(M){M.message==="this phone not register"&&(c.value=!0)}finally{}};return(M,H)=>(r(),p("div",null,[v(Ht,{onSubmit:j,phone:u.value,onInput:i},null,8,["phone"]),c.value?(r(),b(It,{key:0,onSubmit:B,onClose:H[0]||(H[0]=Yn=>c.value=!1)})):x("",!0)]))}});const Gt={class:"flex-center"},jt={class:"grid grid-cols-5 gap-6"},zt={class:"tag"},Xt=f({props:{points:null},setup(e){const t=e,o=[Be,De],a=10,n=D(()=>t.points===0?1:Math.ceil(t.points/a)),c=(i,l)=>(n.value-1-i)*a+l,u=(i,l)=>c(i,l)<=t.points;return(i,l)=>(r(),p("section",Gt,[v(m(Ae),{effect:"cards",grabCursor:!0,modules:o,pagination:{clickable:!0}},{default:g(()=>[(r(!0),p(k,null,C(m(n),(d,_)=>(r(),b(m(Ee),{key:`point-card-${d}`},{default:g(()=>[s("div",jt,[(r(),p(k,null,C(a,y=>s("div",{key:`point-${c(_,y)}`,class:O(["point",{"have-stamp":u(_,y)}])},[s("span",zt," UBRO "+h(c(_,y)),1)],2)),64))])]),_:2},1024))),128))]),_:1})]))}});var Qt=A(Xt,[["__scopeId","data-v-2dba6f70"]]);const Jt={class:"flex items-center space-x-4 mb-4"},Yt=s("label",{for:"code"},"\u5B89\u5168\u78BC",-1),Zt={class:"text-red-500 text-sm mb-1"},Kt=["disabled"],Wt=f({props:{number:null},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=I(),n=$(""),c=D(()=>`\u65B0\u589E ${o.number} \u9EDE`),{errorMessage:u}=P(R()),i=async()=>{try{await E.mutate({mutation:w`
          mutation updatePoint($input: UpdatePointInput!) {
            updatePoint(input: $input)
          }
        `,variables:{input:{point:Number(o.number),securityCode:n.value}}}),await a.fetchMe(),t("submit"),t("close")}catch(l){console.log(l)}};return(l,d)=>(r(),b(Y,{title:m(c),onClose:d[1]||(d[1]=_=>t("close"))},{default:g(()=>[s("div",Jt,[Yt,ue(s("input",{"onUpdate:modelValue":d[0]||(d[0]=_=>n.value=_),placeholder:"\u8ACB\u8F38\u5165\u5B89\u5168\u78BC",name:"code",type:"password",class:"border px-2",maxlength:"4",minlength:"4"},null,512),[[re,n.value]])]),s("p",Zt,h(m(u)),1),s("button",{disabled:n.value.length<4,class:"btn btn-primary btn-block",onClick:i}," \u78BA\u8A8D\u65B0\u589E ",8,Kt)]),_:1},8,["title"]))}});const es={class:"flex flex-col flex-center"},ts={class:"wrapper"},ss={class:"grid grid-cols-2 gap-6"},ns={class:"card text-3xl flex-center"},os={class:"card p-4 flex justify-between space-x-4"},as={class:"flex-1 flex items-center space-x-6"},us={class:"flex-1 text-center font-bold text-lg"},rs=["disabled"],cs=f({setup(e){const{point:t}=P(I()),o=$(!1),a=$(0),n=()=>{a.value++},c=()=>{a.value<=0||a.value--},u=()=>{a.value=0};return(i,l)=>(r(),p("div",es,[s("div",ts,[v(Qt,{points:m(t),class:"mb-5"},null,8,["points"]),s("div",ss,[s("div",ns,"\u7E3D\u9EDE\u6578\uFF1A "+h(m(t))+" \u9EDE",1),s("div",os,[s("div",as,[s("button",{onClick:c,class:"btn control-button"},[v(S,{icon:"minus"})]),s("div",us,h(a.value),1),s("button",{onClick:n,class:"btn control-button"},[v(S,{icon:"plus"})])]),s("button",{class:"btn btn-primary stamp-button",onClick:l[0]||(l[0]=d=>o.value=!0),disabled:a.value===0},[v(S,{icon:"stamp"})],8,rs)])])]),o.value?(r(),b(Wt,{key:0,number:a.value,onClose:l[1]||(l[1]=d=>o.value=!1),onSubmit:u},null,8,["number"])):x("",!0)]))}});var is=A(cs,[["__scopeId","data-v-50971a5e"]]);const ls={class:"product-table rounded-t-2xl bg-white"},ds={class:"product-row !py-4 shadow text-gray-800 sticky top-0 bg-white"},G=f({props:{fields:null},setup(e){return(t,o)=>(r(),p("ul",ls,[s("li",ds,[s("div",null,[(r(!0),p(k,null,C(e.fields,a=>(r(),p("span",{key:a},h(a),1))),128))])]),V(t.$slots,"default")]))}});const ps=["onClick"],_s={class:"check"},ms=f({props:{products:null,active:null,point:null},emits:["change"],setup(e,{emit:t}){return(o,a)=>(r(),b(G,{fields:["\u514C\u63DB","\u54C1\u9805","\u9EDE\u6578"]},{default:g(()=>[(r(!0),p(k,null,C(e.products,n=>(r(),p("li",{onClick:c=>t("change",n.id),key:n.id,class:O(["product-row cursor-pointer",{active:e.active===n.id,"bg-gray-200 bg-opacity-50 pointer-events-none":e.point<n.point}])},[s("div",null,[s("span",null,[s("div",_s,[v(S,{icon:"check"})])]),s("span",null,h(n.name),1),s("span",null,h(n.point),1)])],10,ps))),128))]),_:1}))}});var hs=A(ms,[["__scopeId","data-v-b4cf217e"]]);const vs={class:"flex items-center space-x-4"},fs=f({props:{productId:null},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=I(),n=async()=>{try{await E.mutate({mutation:w`
          mutation exchange($productId: Int!) {
            exchange(productId: $productId)
          }
        `,variables:{productId:o.productId}}),await a.fetchMe(),t("submit"),t("close")}catch(c){console.log(c)}};return(c,u)=>(r(),b(Y,{title:"\u78BA\u8A8D\u514C\u63DB?",onClose:u[1]||(u[1]=i=>t("close"))},{default:g(()=>[s("div",vs,[s("button",{class:"btn btn-outline-primary btn-block",onClick:u[0]||(u[0]=i=>t("close"))}," \u53D6\u6D88 "),s("button",{class:"btn btn-primary btn-block",onClick:n},"\u78BA\u8A8D")])]),_:1}))}}),bs={class:"flex-center h-full"},gs={class:"wrapper flex flex-col h-full"},ys={class:"flex-center mb-4 space-x-5"},xs={class:"h1 !font-normal inline-block p-2"},$s=N(" \u76EE\u524D\u6709 "),ks={class:"text-primary-dark font-bold mx-1"},ws=N(" \u9EDE "),Cs={class:"flex-1 bg-white overflow-y-scroll rounded-t-2xl"},Es={class:"sticky top-0 z-10 bg-white px-6 py-3 shadow flex items-center justify-between"},As={class:"flex items-center space-x-4"},Bs=s("span",null,"\u514C\u63DB",-1),Ds={class:"border-b-2 border-b-primary pb-0.5 text-xl font-medium"},Is=N(" \u4F7F\u7528 "),Rs={class:"font-medium text-lg"},Ss=N(" \u9EDE "),Ls=["disabled"],Ps={key:0,class:"flex-center mt-10 font-medium"},Ns=f({setup(e){const{result:t,loading:o}=ie(w`
    query {
      products {
        id
        name
        point
      }
    }
  `),a=le(t,null,y=>y.products),{point:n}=P(I()),c=$(!1),u=$(null),i=y=>{u.value=u.value===y?null:y},l=D(()=>{if(!!Array.isArray(a.value))return a.value.find(({id:y})=>y===u.value)}),d=D(()=>{var B;const y=((B=l.value)==null?void 0:B.point)||0;return n.value-y}),_=()=>{u.value=null};return(y,B)=>(r(),p("div",bs,[s("div",gs,[s("div",ys,[s("div",xs,[$s,s("span",ks,h(m(d))+" / "+h(m(n)),1),ws])]),s("div",Cs,[s("div",Es,[s("div",As,[Bs,s("span",Ds,h(m(l)?m(l).name:"\u5C1A\u672A\u514C\u63DB\u4EFB\u4F55\u5546\u54C1"),1),s("span",null,[Is,s("span",Rs,h(m(l)?m(l).point:0),1),Ss])]),s("button",{disabled:!u.value,class:"btn btn-primary w-40",onClick:B[0]||(B[0]=j=>c.value=!0)}," \u78BA\u8A8D\u514C\u63DB ",8,Ls)]),m(o)?(r(),p("div",Ps," \u6B63\u5728\u52AA\u529B\u5C0B\u627E\u6709\u4EC0\u9EBC\u53EF\u4EE5\u514C\u63DB\u7684\u597D\u6771\u897F ... ")):(r(),b(hs,{key:1,products:m(a),onChange:i,active:u.value,point:m(n)},null,8,["products","active","point"]))])]),c.value?(r(),b(fs,{key:0,"product-id":u.value,onClose:B[1]||(B[1]=j=>c.value=!1),onSubmit:_},null,8,["product-id"])):x("",!0)]))}}),Z=f({props:{rules:{default:()=>({})},action:null,initialValues:{default:()=>({})}},setup(e){const t=e,{handleSubmit:o,meta:a,values:n,resetForm:c}=Ie({initialValues:t.initialValues,validationSchema:t.rules}),u=o(async()=>{try{await t.action(n),c()}catch(i){throw i}});return(i,l)=>(r(),p("form",{onSubmit:l[0]||(l[0]=(...d)=>m(u)&&m(u)(...d))},[V(i.$slots,"default",{invalid:!m(a).valid,values:m(n)})],32))}}),Ms={key:0,class:"font-medium block mb-1"},qs={key:1,class:"text-red-500 mt-1"},Fs=f({props:{name:{default:""},label:{default:""}},setup(e){const t=e,{errorMessage:o,handleChange:a,value:n,meta:c}=Re(t.name,void 0,{validateOnValueUpdate:!1}),u=D(()=>o.value?{blur:a,change:a,input:a}:{blur:a,change:a,input:i=>a(i,!1)});return(i,l)=>(r(),p("div",null,[e.label?(r(),p("label",Ms,[s("span",null,h(e.label),1)])):x("",!0),V(i.$slots,"default",{error:m(o),value:m(n),validationListeners:m(u)}),m(o)?(r(),p("div",qs,h(m(o)),1)):x("",!0)]))}}),Us=["type","placeholder","name","value"],L=f({props:{name:{default:""},label:{default:""},type:{default:"text"},placeholder:{default:""}},setup(e){const t=e,o=D(()=>t.name||t.label||"Field");return(a,n)=>(r(),b(Fs,{label:e.label,name:m(o)},{default:g(({error:c,validationListeners:u,value:i})=>[s("input",Se({class:["form-input bg-white",{"border-red-500":c}],type:e.type,placeholder:e.placeholder,name:m(o),value:i},Le(u)),null,16,Us)]),_:1},8,["label","name"]))}});const Os=e=>(X("data-v-f1054a8c"),e=e(),Q(),e),Ts={class:"container h-full flex lg:items-center"},Hs={class:"w-full grid lg:grid-cols-2 lg:gap-20"},Vs={class:"flex space-x-4"},Gs={class:"btn btn-outline-primary btn-block",type:"button"},js=N("\u56DE\u4F7F\u7528\u8005\u767B\u5165"),zs=Os(()=>s("button",{class:"btn btn-primary btn-block",type:"submit"},"\u767B\u5165",-1)),Xs={class:"mt-1 text-sm text-red-500"},Qs=Pe('<div class="row-start-1 flex flex-col lg:col-start-2 lg:-translate-y-1/2" data-v-f1054a8c><h2 class="h1" data-v-f1054a8c>\u7BA1\u7406\u54E1\u767B\u5165</h2><div class="flex-1 relative text-primary text-[5rem] sm:text-[12.5rem] flex items-center" data-v-f1054a8c><span class="z-10" data-v-f1054a8c>Ubro</span><div class="logo" data-v-f1054a8c></div></div></div>',1),Js=f({setup(e){const t=J({phone:q().required(),password:q().required()}),{adminLogin:o}=I(),a=F();let n=$("");const c=async u=>{try{const{phone:i,password:l}=u;await o({phone:i,password:l}),n.value="",a.push({name:"admin-products.index"})}catch(i){n.value=i.message}};return(u,i)=>{const l=U("router-link");return r(),p("div",Ts,[s("div",Hs,[v(Z,{rules:m(t),action:c,class:"space-y-6"},{default:g(({values:d})=>[v(L,{name:"phone",label:"Account",required:""}),v(L,{name:"password",label:"Password",type:"password"}),s("div",Vs,[s("button",Gs,[v(l,{class:"block",to:"/"},{default:g(()=>[js]),_:1})]),zs]),s("div",Xs,h(m(n)),1)]),_:1},8,["rules"]),Qs])])}}});var Ys=A(Js,[["__scopeId","data-v-f1054a8c"]]);const Zs={class:"container flex-center mt-20"},Ks={class:"bg-white p-10 rounded-2xl"},Ws=["disabled"],en={class:"mt-1 text-sm text-red-500"},tn={class:"mt-1 text-sm text-blue-500"},sn=f({setup(e){const t=J({code:q().required().length(4),codeConfirmation:q().required().oneOf([Ne("code")],"code do not match")});let o=$("");const{errorMessage:a}=P(R()),n=async c=>{const{code:u}=c;o.value="",await E.mutate({mutation:w`
        mutation updateSecurityCode($code: String!) {
          updateSecurityCode(code: $code)
        }
      `,variables:{code:u}}),o.value="\u66F4\u65B0\u6210\u529F"};return(c,u)=>(r(),p("div",Zs,[s("div",Ks,[v(Z,{rules:m(t),action:n,class:"w-64 space-y-6"},{default:g(({invalid:i})=>[v(L,{name:"code",label:"\u5B89\u5168\u78BC",type:"password"}),v(L,{name:"codeConfirmation",label:"\u8ACB\u518D\u8F38\u5165\u4E00\u6B21",type:"password"}),s("button",{disabled:i,class:"btn btn-primary btn-block",type:"submit"}," \u8B8A\u66F4 ",8,Ws),s("div",en,h(m(a)),1),s("div",tn,h(m(o)),1)]),_:1},8,["rules"])])]))}});var nn=A(sn,[["__scopeId","data-v-74cf5f26"]]);const on={class:"h-full flex flex-col"},an={class:"flex justify-center space-x-10 mb-10"},un=["onClick"],rn=f({setup(e){const{exchangeRecords:t,consumeRecords:o}=P(I()),a={EXCHANGE:"\u514C\u63DB\u7D00\u9304",CONSUME:"\u96C6\u9EDE\u7D00\u9304"},n=$("EXCHANGE");return(c,u)=>(r(),p("div",on,[s("div",an,[(r(),p(k,null,C(a,(i,l)=>s("div",{class:O(["tab",{active:n.value===l}]),key:l,onClick:d=>n.value=l},h(i),11,un)),64))]),n.value==="EXCHANGE"?(r(),b(G,{key:0,class:"records",fields:["#","\u54C1\u9805","\u82B1\u8CBB\u9EDE\u6578","\u514C\u63DB\u6642\u9593"]},{default:g(()=>[(r(!0),p(k,null,C(m(t),(i,l)=>(r(),p("li",{key:i.id,class:"product-row"},[s("div",null,[s("span",null,h(l+1),1),s("span",null,h(i.productName),1),s("span",null,h(i.point),1),s("span",null,h(i.createdAt),1)])]))),128))]),_:1})):x("",!0),n.value==="CONSUME"?(r(),b(G,{key:1,class:"records",fields:["#","\u9EDE\u6578","\u66F4\u65B0\u6642\u9593"]},{default:g(()=>[(r(!0),p(k,null,C(m(o),(i,l)=>(r(),p("li",{key:i.id,class:"product-row"},[s("div",null,[s("span",null,h(l+1),1),s("span",null,h(i.point),1),s("span",null,h(i.createdAt),1)])]))),128))]),_:1})):x("",!0)]))}});var cn=A(rn,[["__scopeId","data-v-0cc1c61c"]]);const ln={class:"h-full flex flex-col"},dn={class:"flex justify-center space-x-10 mb-10"},pn=["onClick"],_n=f({setup(e){const t=w`
    query {
      consumeRecords {
        id
        point
        user
        createdAt
      }

      exchangeRecords {
        id
        productName
        point
        user
        createdAt
      }
    }
  `,o=$([]),a=$([]),n=async()=>{const{data:i}=await E.query({query:t});o.value=i.exchangeRecords,a.value=i.consumeRecords};ce(async()=>{await n()});const c={EXCHANGE:"\u514C\u63DB\u7D00\u9304",CONSUME:"\u96C6\u9EDE\u7D00\u9304"},u=$("EXCHANGE");return(i,l)=>(r(),p("div",ln,[s("div",dn,[(r(),p(k,null,C(c,(d,_)=>s("div",{class:O(["tab",{active:u.value===_}]),key:_,onClick:y=>u.value=_},h(d),11,pn)),64))]),u.value==="EXCHANGE"?(r(),b(G,{key:0,class:"records",fields:["#","\u54C1\u9805","\u9867\u5BA2","\u82B1\u8CBB\u9EDE\u6578","\u514C\u63DB\u6642\u9593"]},{default:g(()=>[(r(!0),p(k,null,C(o.value,(d,_)=>(r(),p("li",{key:d.id,class:"product-row"},[s("div",null,[s("span",null,h(_+1),1),s("span",null,h(d.productName),1),s("span",null,h(d.user),1),s("span",null,h(d.point),1),s("span",null,h(d.createdAt),1)])]))),128))]),_:1})):x("",!0),u.value==="CONSUME"?(r(),b(G,{key:1,class:"records",fields:["#","\u9867\u5BA2","\u9EDE\u6578","\u66F4\u65B0\u6642\u9593"]},{default:g(()=>[(r(!0),p(k,null,C(a.value,(d,_)=>(r(),p("li",{key:d.id,class:"product-row"},[s("div",null,[s("span",null,h(_+1),1),s("span",null,h(d.user),1),s("span",null,h(d.point),1),s("span",null,h(d.createdAt),1)])]))),128))]),_:1})):x("",!0)]))}});var mn=A(_n,[["__scopeId","data-v-8b8edd78"]]);const hn={class:"flex items-center space-x-4"},vn=f({props:{deletedId:null},emits:["close","submit"],setup(e,{emit:t}){const o=e;return(a,n)=>(r(),b(Y,{title:"\u78BA\u8A8D\u522A\u9664?",onClose:n[2]||(n[2]=c=>t("close"))},{default:g(()=>[s("div",hn,[s("button",{class:"btn btn-outline-primary btn-block",onClick:n[0]||(n[0]=c=>t("close"))}," \u53D6\u6D88 "),s("button",{class:"btn btn-primary btn-block",onClick:n[1]||(n[1]=c=>t("submit",o.deletedId))}," \u78BA\u8A8D ")])]),_:1}))}});const fn=e=>(X("data-v-5f681052"),e=e(),Q(),e),bn={class:"product-table bg-white h-full overflow-y-scroll rounded-t-2xl"},gn=fn(()=>s("li",{class:"product-row !pt-6 text-gray-800 sticky top-0 bg-white"},[s("div",null,[s("span",null,"\u54C1\u9805"),s("span",null,"\u9EDE\u6578"),s("span",null,"\u529F\u80FD")])],-1)),yn={class:"divide-x-2"},xn={class:"px-2 cursor-pointer"},$n=N(" \u4FEE\u6539 "),kn=["onClick"],wn=f({props:{products:null},emits:["delete-product"],setup(e,{emit:t}){const o=$(!1),a=$(null),n=u=>{a.value=u,Me(()=>o.value=!0)},c=async u=>{await t("delete-product",u),o.value=!1};return(u,i)=>{const l=U("router-link");return r(),p("ul",bn,[gn,(r(!0),p(k,null,C(e.products,d=>(r(),p("li",{key:d.id,class:"product-row"},[s("div",null,[s("span",null,h(d.name),1),s("span",null,h(d.point),1),s("div",yn,[s("span",xn,[v(l,{to:`/admin/products/${d.id}/update`},{default:g(()=>[$n]),_:2},1032,["to"])]),s("span",{class:"text-red-700 px-2 cursor-pointer",onClick:_=>n(d.id)}," \u522A\u9664 ",8,kn)])])]))),128)),o.value?(r(),b(vn,{key:0,onClose:i[0]||(i[0]=d=>o.value=!1),onSubmit:c,"deleted-id":a.value},null,8,["deleted-id"])):x("",!0)])}}});var Cn=A(wn,[["__scopeId","data-v-5f681052"]]);const En={class:"flex justify-end mb-5"},An={class:"btn btn-primary w-40"},Bn=N(" \u65B0\u589E "),Dn=f({setup(e){const t=w`
    query {
      products {
        id
        name
        point
      }
    }
  `,{result:o}=ie(t),a=le(o,null,c=>c.products),n=async c=>{try{await E.mutate({mutation:w`
          mutation deleteProduct($id: Int!) {
            deleteProduct(id: $id)
          }
        `,variables:{id:c},update:(u,{data:{deleteProduct:i}})=>{let l=u.readQuery({query:t});l&&(l={products:l.products.filter(({id:d})=>d!==i)}),u.writeQuery({query:t,data:l})}})}catch(u){throw u}};return(c,u)=>{const i=U("router-link");return r(),p(k,null,[s("div",En,[s("button",An,[v(i,{class:"block",to:"/admin/products/create"},{default:g(()=>[Bn]),_:1})])]),v(Cn,{products:m(a),onDeleteProduct:n},null,8,["products"])],64)}}});const In={class:"flex justify-center mt-20"},Rn={class:"bg-white p-6 rounded-xl wrapper"},Sn=["disabled"],Ln={key:0,class:"mt-1 text-sm text-red-500"},Pn=f({setup(e){const t=$(""),o=F(),a=J({name:q().required(),point:de().required()}),n=async c=>{try{const{name:u,point:i}=c;await E.mutate({mutation:w`
          mutation createProduct($input: CreateProductInput!) {
            createProduct(input: $input) {
              id
            }
          }
        `,variables:{input:{name:u,point:Number(i)}}}),await o.push("/admin/products")}catch(u){t.value=u.message}};return(c,u)=>(r(),p("div",In,[s("div",Rn,[v(Z,{rules:m(a),action:n,class:"space-y-6"},{default:g(({invalid:i})=>[v(L,{name:"name",label:"\u54C1\u9805"}),v(L,{name:"point",type:"number",label:"\u9EDE\u6578"}),s("button",{class:"btn btn-primary btn-block",type:"submit",disabled:i}," \u65B0\u589E ",8,Sn)]),_:1},8,["rules"]),t.value?(r(),p("div",Ln,h(t.value),1)):x("",!0)])]))}});var Nn=A(Pn,[["__scopeId","data-v-2d6b8f54"]]);const Mn={class:"flex justify-center mt-20"},qn={class:"bg-white p-6 rounded-xl wrapper"},Fn=["disabled"],Un=f({setup(e){const t=F(),o=W(),a=J({name:q().required(),point:de().required()}),n=qe({name:"",point:0}),c=$(!0),u=async()=>{c.value=!0;const{data:{product:l}}=await E.query({query:w`
        query product($id: Int!) {
          product(id: $id) {
            id
            name
            point
          }
        }
      `,variables:{id:+o.params.id}});n.name=l.name,n.point=l.point,c.value=!1};Fe(()=>{u()});const i=async l=>{const{name:d,point:_}=l;await E.mutate({mutation:w`
        mutation updateProduct($input: UpdateProductInput!) {
          updateProduct(input: $input) {
            id
            name
            point
          }
        }
      `,variables:{input:{id:Number(o.params.id),name:d,point:Number(_)}}}),await t.push("/admin/products")};return(l,d)=>(r(),p("div",Mn,[s("div",qn,[c.value?x("",!0):(r(),b(Z,{key:0,rules:m(a),action:i,"initial-values":m(n),class:"space-y-6"},{default:g(({invalid:_})=>[v(L,{name:"name",label:"\u54C1\u9805"}),v(L,{name:"point",type:"number",label:"\u9EDE\u6578"}),s("button",{class:"btn btn-primary btn-block",type:"submit",disabled:_}," \u66F4\u65B0 ",8,Fn)]),_:1},8,["rules","initial-values"]))])]))}});var On=A(Un,[["__scopeId","data-v-5d58d394"]]);const Tn={};function Hn(e,t){return r(),p("div",null,"UBRO TEST")}var Vn=A(Tn,[["render",Hn]]);const T=Ue({setup(){Oe(ze,E)},render:()=>Te(ft)}),Gn=He(),jn=[Je,Ye,Ze];function zn(){jn.forEach(e=>Xe.add(e)),T.component("font-awesome-icon",Qe)}zn();const Xn=Ve({locale:"en",fallbackLocale:"en",messages:{"zh-TW":yt,en:kt}}),Qn=[{path:"/",component:Vt,name:"home"},{path:"/points",component:is,name:"user-points",meta:{requiresAuth:!0}},{path:"/records",component:cn,name:"user-records",meta:{requiresAuth:!0}},{path:"/exchange",component:Ns,name:"user-exchange",meta:{requiresAuth:!0}},{path:"/admin/login",name:"admin-login",component:Ys},{path:"/admin/code",name:"admin-code",component:nn,meta:{requiresAdmin:!0}},{path:"/admin/records",component:mn,name:"admin-records",meta:{requiresAdmin:!0}},{path:"/admin/products",component:Dn,name:"admin-products.index",meta:{requiresAdmin:!0}},{path:"/admin/products/create",component:Nn,name:"admin-products.store",meta:{requiresAdmin:!0}},{path:"/admin/products/:id/update",component:On,name:"admin-products.update",meta:{requiresAdmin:!0}},{path:"/test",component:Vn}],Jn=Ge({history:je("ubro"),routes:Qn});T.use(Ct);T.use(Gn);T.use(Xn);T.use(Jn);T.mount("#app");
