var ae=Object.defineProperty,ie=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var K=(e,t,s)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,z=(e,t)=>{for(var s in t||(t={}))ue.call(t,s)&&K(e,s,t[s]);if(Z)for(var s of Z(t))le.call(t,s)&&K(e,s,t[s]);return e},W=(e,t)=>ie(e,re(t));import{I as ce,c as de,s as pe,A as _e,g as w,d as me,a as f,u as G,b as Q,e as E,f as q,r as M,o as c,h as _,i as o,j as h,k as p,F as L,l as D,w as $,m as P,t as b,p as R,n as U,q as x,v as g,x as F,y as he,z as ee,B as te,C as ve,D as y,E as fe,S as be,G as ge,P as ye,H as xe,J as T,K as $e,L as se,M as ne,N as ke,O as we,Q as Ce,R as Ee,T as V,U as N,V as Ie,W as Be,X as Ae,Y as oe,Z as Le,_ as Se,$ as Pe,a0 as De,a1 as Ne,a2 as qe,a3 as Me,a4 as Oe,a5 as Re,a6 as Ue,a7 as Te,a8 as Fe,a9 as Ve,aa as He,ab as je}from"./vendor.792be4fd.js";const ze=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}};ze();const Ge=new ce,Qe=de({uri:"https://sx3pwmngq3.execute-api.us-east-1.amazonaws.com/dev/graphql"}),Je=pe((e,{headers:t})=>{const s=localStorage.getItem("token");return s?{headers:W(z({},t),{Authorization:s||null})}:{headers:z({},t)}}),C=new _e({link:Je.concat(Qe),cache:Ge});var Ze=async()=>{try{const{data:{me:e}}=await C.query({query:w`
        query me {
          me {
            phone
            point
            isAdmin
          }
        }
      `,fetchPolicy:"no-cache"});return e}catch(e){console.log(e)}},Ke=e=>({register:async()=>{try{const{data:{login:s}}=await C.mutate({mutation:w`
          mutation register($input: RegisterInput!) {
            register(input: $input) {
              phone
            }
          }
        `,variables:{input:{phone:e}}})}catch{console.error("error")}}}),X=({phone:e,password:t})=>{const{register:s}=Ke(e),a=async()=>{try{const{data:{login:i}}=await C.mutate({mutation:w`
          mutation login($input: LoginInput!) {
            login(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return i.token}catch(i){if(i.message==="this phone not register")return await s(),await a();throw i}};return{login:a,adminLogin:async()=>{try{const{data:{adminLogin:i}}=await C.mutate({mutation:w`
          mutation adminLogin($input: LoginInput!) {
            adminLogin(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return i.token}catch(i){throw i}}}};const Y={phone:"",point:0,isAdmin:!1},B=me("auth",{state:()=>({accessToken:null,user:Y}),getters:{isLogin(){return!!this.accessToken},isAdmin(){return this.user.isAdmin},point(){return this.user.point}},actions:{async authLogin({phone:e,password:t}){const{login:s}=X({phone:e,password:t}),a=await s();this.setToken(a)},async adminLogin({phone:e,password:t}){const{adminLogin:s}=X({phone:e,password:t});try{const a=await s();this.setToken(a)}catch(a){throw a}},authLogout(){this.removeToken(),this.setUser(Y)},setToken(e){!e||(this.accessToken=e,localStorage.setItem("token",e))},removeToken(){this.accessToken=null,localStorage.removeItem("token")},setUser(e){this.user=e},async fetchMe(){const e=await Ze();!e||this.setUser(e)}}});var I=(e,t)=>{const s=e.__vccOpts||e;for(const[a,n]of t)s[a]=n;return s};const We=e=>(R("data-v-98caa87a"),e=e(),U(),e),Xe={class:"w-56 bg-primary-light"},Ye={class:"h-full"},et={class:"h-full p-10 flex flex-col items-center"},tt={class:"mb-5 logo"},st={key:0},nt=We(()=>o("button",{class:"btn btn-primary w-40"},"\u7BA1\u7406\u8005",-1)),ot={key:1},at=f({setup(e){const t=G(),{isLogin:s,isAdmin:a}=Q(B()),n=E(()=>a.value?"/admin/products":"/"),i=E(()=>{var d;return a.value&&s.value?[{label:"\u5546\u54C1",to:"/admin/products"},{label:"\u5B89\u5168\u78BC",to:"/admin/code"}]:!a.value&&s.value&&!((d=t.name)!=null&&d.includes("admin"))?[{label:"\u96C6\u9EDE\u5361",to:"/points"},{label:"\u514C\u63DB",to:"/exchange"}]:[]}),{authLogout:u}=B(),r=q(),l=async()=>{await u(),await r.push("/")};return(d,m)=>{const v=M("router-link");return c(),_("aside",Xe,[o("nav",Ye,[o("ul",et,[o("li",tt,[h(v,{to:p(n),class:"w-full h-full block"},null,8,["to"])]),(c(!0),_(L,null,D(p(i),({label:k,to:j})=>(c(),_("li",{key:k},[h(v,{to:j},{default:$(()=>[P(b(k),1)]),_:2},1032,["to"])]))),128)),p(s)?(c(),_("li",ot,[o("button",{class:"btn btn-primary w-40",onClick:l},"\u5B8C\u6210")])):(c(),_("li",st,[h(v,{to:"/admin/login"},{default:$(()=>[nt]),_:1})]))])])])}}});var it=I(at,[["__scopeId","data-v-98caa87a"]]);const rt={class:"h-screen flex"},ut=f({setup(e){const t=G(),s=q(),a=B(),n=E(()=>t.name==="admin-login");s.beforeEach(async r=>{const l=await localStorage.getItem("token");if(!l)return;const d=i(l);if(d&&u(d))return await a.removeToken(),{name:"home"};if(await a.setToken(l),await a.fetchMe(),r.meta.requiresAuth&&!a.isLogin)return{name:"home"};if(r.meta.requiresAdmin&&!a.isAdmin)return{name:"admin-login"}});const i=r=>{try{if(!r)return null;const{exp:l}=JSON.parse(atob(r.split(".")[1]));return l}catch{return null}},u=r=>Date.now()>r*1e3;return(r,l)=>{const d=M("router-view");return c(),_("div",rt,[p(n)?g("",!0):(c(),x(it,{key:0})),o("main",{class:F(["flex-1 pt-16 px-10 overflow-x-hidden relative",{"bg-white":p(n)}])},[h(d)],2)])}}}),lt="\u54C8\u56C9\uFF01\u9019\u662F\u500B vue \u5C08\u6848",ct="\u7B49\u5F85\u4E2D...";var dt={hello:lt,"My name is":"\u6211\u7684\u540D\u5B57\u662F","Ching Hui":"\u6674\u60E0","I'm a Uaena, also a frontend developer :)":"\u6211\u662FUaena\uFF0C\u4E5F\u662F\u4E00\u540D\u524D\u7AEF\u5DE5\u7A0B\u5E2B :)",loading:ct};const pt="Hello! It's a vue project",_t="loading...";var mt={hello:pt,"My name is":"My name is","Ching Hui":"Ching Hui","I'm a Uaena, also a frontend developer :)":"I'm a Uaena, also a rontend developer :)",loading:_t};class ht{set(t,s,a=30){const n={value:s,ttl:Date.now()+a*1e4};localStorage.setItem(t,JSON.stringify(n))}get(t){const s=localStorage.getItem(t);if(!s)return null;const{ttl:a,value:n}=JSON.parse(s);return Date.now()>a?(localStorage.removeItem(t),null):n}}const vt={install:e=>{const t=new ht;e.provide("storage",t)}},A=f({props:{pack:{default:"fas"},icon:{default:""}},setup(e){return(t,s)=>{const a=M("font-awesome-icon");return c(),x(a,{icon:[e.pack,e.icon]},null,8,["icon"])}}});const ft=e=>(R("data-v-2f1876ce"),e=e(),U(),e),bt={class:"flex flex-col items-center"},gt=ft(()=>o("h2",{class:"h1 text-center mb-5"},"LOGIN",-1)),yt={class:"wrapper"},xt={class:"phone-input flex items-center"},$t={key:0,class:"w-10 h-10 flex-center rounded-full border border-green-500 text-green-500"},kt={class:"phone-pad"},wt=["onClick"],Ct={key:0},Et={key:2},It=f({props:{phone:null},emits:["submit","input"],setup(e,{emit:t}){const s=e,a=8,n=10,i=11,u=12,r=E(()=>/((?=(09))[0-9]{10})$/g.test(s.phone));return he(()=>{const l=[...Array(10)].map((d,m)=>`${m}`);document.addEventListener("keyup",({key:d,keyCode:m})=>{(m>=48&&m<=57||m>=96&&m<=105)&&l.includes(d)&&t("input",d),m===a&&t("input",n)})}),(l,d)=>(c(),_("div",bt,[gt,o("div",yt,[o("div",xt,[ee(o("input",{"onUpdate:modelValue":d[0]||(d[0]=m=>ve(phone)?phone.value=m:null),maxlength:"10",class:"flex-1 outline-none",readonly:""},null,512),[[te,e.phone]]),p(r)?(c(),_("div",$t,[p(r)?(c(),x(A,{key:0,icon:"check",class:"text-xl"})):g("",!0)])):g("",!0)]),o("div",kt,[(c(),_(L,null,D(12,m=>o("button",{key:m,class:F(["phone-button",{invalid:!p(r),"login-button":m===u}]),onClick:v=>t("input",m)},[m<10?(c(),_("span",Ct,b(m),1)):m===n?(c(),x(A,{key:1,icon:"plus",class:"rotate-45"})):m===i?(c(),_("span",Et,"0")):m===u?(c(),x(A,{key:3,icon:"check",class:"check-icon"})):g("",!0)],10,wt)),64))])])]))}});var Bt=I(It,[["__scopeId","data-v-2f1876ce"]]);const At={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white"},Lt=f({setup(e){const i=y("");E(()=>/((?=(09))[0-9]{10})$/g.test(i.value));const u=v=>{let k=String(v);if(v===10){i.value=i.value.slice(0,-1);return}if(v===12){m();return}v===11&&(k="0"),!(i.value.length>=10)&&(i.value+=k)},r=q(),l=B();fe(()=>{l.isLogin&&r.push("/points")});let d=y(!1);const m=async()=>{d.value=!0,await l.authLogin({phone:i.value,password:i.value}),d.value=!1};return(v,k)=>(c(),_(L,null,[p(d)?(c(),_("div",At," Loading ... ")):g("",!0),p(l).isLogin?g("",!0):(c(),x(Bt,{key:1,onSubmit:m,phone:i.value,onInput:u},null,8,["phone"]))],64))}});const St={class:"flex-center"},Pt={class:"grid grid-cols-5 gap-6"},Dt={class:"tag"},Nt=f({props:{points:null},setup(e){const t=e,s=[ge,ye],a=10,n=E(()=>t.points===0?1:Math.ceil(t.points/a)),i=(r,l)=>(n.value-1-r)*a+l,u=(r,l)=>i(r,l)<=t.points;return(r,l)=>(c(),_("section",St,[h(p(be),{effect:"cards",grabCursor:!0,modules:s,pagination:{clickable:!0}},{default:$(()=>[(c(!0),_(L,null,D(p(n),(d,m)=>(c(),x(p(xe),{key:`point-card-${d}`},{default:$(()=>[o("div",Pt,[(c(),_(L,null,D(a,v=>o("div",{key:`point-${i(m,v)}`,class:F(["point",{"have-stamp":u(m,v)}])},[o("span",Dt," UBRO "+b(i(m,v)),1)],2)),64))])]),_:2},1024))),128))]),_:1})]))}});var qt=I(Nt,[["__scopeId","data-v-2dba6f70"]]);const Mt=["onClick"],Ot={class:"modal min-w-[300px] bg-white p-6 rounded-lg relative"},Rt={key:0,class:"h1 text-center mb-4"},J=f({props:{title:{default:""}},emits:["close"],setup(e,{emit:t}){const s=()=>{t("close")};return(a,n)=>(c(),_("div",{class:"fixed inset-0 z-50 bg-black bg-opacity-60 flex-center",onClick:$e(s,["self"])},[o("div",Ot,[h(A,{icon:"plus",class:"rotate-45 absolute right-6 top-6 cursor-pointer",onClick:s}),T(a.$slots,"title",{},()=>[e.title?(c(),_("div",Rt,b(e.title),1)):g("",!0)]),T(a.$slots,"default")])],8,Mt))}}),Ut={class:"flex items-center space-x-4 mb-4"},Tt=o("label",{for:"code"},"\u5B89\u5168\u78BC",-1),Ft=["disabled"],Vt=f({props:{number:null},emits:["close","submit"],setup(e,{emit:t}){const s=e,a=B(),n=y(""),i=E(()=>`\u65B0\u589E ${s.number} \u9EDE`),u=async()=>{try{await C.mutate({mutation:w`
          mutation updatePoint($point: Int!) {
            updatePoint(point: $point)
          }
        `,variables:{point:Number(s.number)}}),await a.fetchMe(),t("submit"),t("close")}catch(r){console.log(r)}};return(r,l)=>(c(),x(J,{title:p(i),onClose:l[1]||(l[1]=d=>t("close"))},{default:$(()=>[o("div",Ut,[Tt,ee(o("input",{"onUpdate:modelValue":l[0]||(l[0]=d=>n.value=d),placeholder:"\u8ACB\u8F38\u5165\u5B89\u5168\u78BC",name:"code",type:"password",class:"border px-2",maxlength:"4",minlength:"4"},null,512),[[te,n.value]])]),o("button",{disabled:n.value.length<4,class:"btn btn-primary btn-block",onClick:u}," \u78BA\u8A8D\u65B0\u589E ",8,Ft)]),_:1},8,["title"]))}});const Ht={class:"flex flex-col flex-center"},jt={class:"wrapper"},zt={class:"bg-white rounded-2xl p-4 w-[20rem] flex justify-between space-x-4"},Gt={class:"flex-1 flex items-center space-x-6"},Qt={class:"flex-1 text-center font-bold text-lg"},Jt=["disabled"],Zt=f({setup(e){const{point:t}=Q(B()),s=y(!1),a=y(0),n=()=>{a.value++},i=()=>{a.value<=0||a.value--},u=()=>{a.value=0};return(r,l)=>(c(),_("div",Ht,[o("div",jt,[h(qt,{points:p(t),class:"mb-5"},null,8,["points"]),o("div",zt,[o("div",Gt,[o("button",{onClick:i,class:"btn control-button"},[h(A,{icon:"minus"})]),o("div",Qt,b(a.value),1),o("button",{onClick:n,class:"btn control-button"},[h(A,{icon:"plus"})])]),o("button",{class:"btn btn-primary stamp-button",onClick:l[0]||(l[0]=d=>s.value=!0),disabled:a.value===0},[h(A,{icon:"stamp"})],8,Jt)])]),s.value?(c(),x(Vt,{key:0,number:a.value,onClose:l[1]||(l[1]=d=>s.value=!1),onSubmit:u},null,8,["number"])):g("",!0)]))}});var Kt=I(Zt,[["__scopeId","data-v-7ad3679d"]]);const Wt=e=>(R("data-v-26926b64"),e=e(),U(),e),Xt={class:"product-table py-6"},Yt=Wt(()=>o("li",{class:"product-row p-2 text-gray-800"},[o("div",null,[o("span",null,"\u514C\u63DB"),o("span",null,"\u54C1\u9805"),o("span",null,"\u9EDE\u6578")])],-1)),es=["onClick"],ts={class:"check"},ss=f({props:{products:null,active:null,point:null},emits:["change"],setup(e,{emit:t}){return(s,a)=>(c(),_("ul",Xt,[Yt,(c(!0),_(L,null,D(e.products,n=>(c(),_("li",{onClick:i=>t("change",n.id),key:n.id,class:F(["product-row cursor-pointer",{active:e.active===n.id,"bg-gray-200 bg-opacity-50 pointer-events-none":e.point<n.point}])},[o("div",null,[o("span",null,[o("div",ts,[h(A,{icon:"check"})])]),o("span",null,b(n.name),1),o("span",null,b(n.point),1)])],10,es))),128))]))}});var ns=I(ss,[["__scopeId","data-v-26926b64"]]);const os={class:"flex items-center space-x-4"},as=f({props:{productId:null},emits:["close","submit"],setup(e,{emit:t}){const s=e,a=B(),n=async()=>{try{await C.mutate({mutation:w`
          mutation exchange($productId: Int!) {
            exchange(productId: $productId)
          }
        `,variables:{productId:s.productId}}),await a.fetchMe(),t("submit"),t("close")}catch(i){console.log(i)}};return(i,u)=>(c(),x(J,{title:"\u78BA\u8A8D\u514C\u63DB?",onClose:u[1]||(u[1]=r=>t("close"))},{default:$(()=>[o("div",os,[o("button",{class:"btn btn-outline-primary btn-block",onClick:u[0]||(u[0]=r=>t("close"))}," \u53D6\u6D88 "),o("button",{class:"btn btn-primary btn-block",onClick:n},"\u78BA\u8A8D")])]),_:1}))}}),is={class:"flex-center h-full"},rs={class:"wrapper flex flex-col h-full"},us={class:"flex-center mb-4 space-x-5"},ls={class:"h1 !font-normal inline-block p-2"},cs=P(" \u76EE\u524D\u6709 "),ds={class:"text-primary-dark font-bold mx-1"},ps=P(" \u9EDE "),_s={class:"flex-1 bg-white overflow-y-scroll rounded-t-2xl"},ms={class:"sticky top-0 bg-white px-6 py-3 shadow flex items-center justify-between"},hs={class:"flex items-center space-x-4"},vs=o("span",null,"\u514C\u63DB",-1),fs={class:"border-b-2 border-b-primary pb-0.5 text-xl font-medium"},bs=P(" \u4F7F\u7528 "),gs={class:"font-medium text-lg"},ys=P(" \u9EDE "),xs=["disabled"],$s={key:0,class:"flex-center mt-10 font-medium"},ks=f({setup(e){const{result:t,loading:s}=se(w`
    query {
      products {
        id
        name
        point
      }
    }
  `),a=ne(t,null,v=>v.products),{point:n}=Q(B()),i=y(!1),u=y(null),r=v=>{u.value=u.value===v?null:v},l=E(()=>{if(!!Array.isArray(a.value))return a.value.find(({id:v})=>v===u.value)}),d=E(()=>{var k;const v=((k=l.value)==null?void 0:k.point)||0;return n.value-v}),m=()=>{u.value=null};return(v,k)=>(c(),_("div",is,[o("div",rs,[o("div",us,[o("div",ls,[cs,o("span",ds,b(p(d))+" / "+b(p(n)),1),ps])]),o("div",_s,[o("div",ms,[o("div",hs,[vs,o("span",fs,b(p(l)?p(l).name:"\u5C1A\u672A\u514C\u63DB\u4EFB\u4F55\u5546\u54C1"),1),o("span",null,[bs,o("span",gs,b(p(l)?p(l).point:0),1),ys])]),o("button",{disabled:!u.value,class:"btn btn-primary w-40",onClick:k[0]||(k[0]=j=>i.value=!0)}," \u78BA\u8A8D\u514C\u63DB ",8,xs)]),p(s)?(c(),_("div",$s," \u6B63\u5728\u52AA\u529B\u5C0B\u627E\u6709\u4EC0\u9EBC\u53EF\u4EE5\u514C\u63DB\u7684\u597D\u6771\u897F ... ")):(c(),x(ns,{key:1,products:p(a),onChange:r,active:u.value,point:p(n)},null,8,["products","active","point"]))])]),i.value?(c(),x(as,{key:0,"product-id":u.value,onClose:k[1]||(k[1]=j=>i.value=!1),onSubmit:m},null,8,["product-id"])):g("",!0)]))}}),H=f({props:{rules:{default:()=>({})},action:null,initialValues:{default:()=>({})}},setup(e){const t=e,{handleSubmit:s,meta:a,values:n,resetForm:i}=ke({initialValues:t.initialValues,validationSchema:t.rules}),u=s(async()=>{try{await t.action(n),i()}catch(r){throw r}});return(r,l)=>(c(),_("form",{onSubmit:l[0]||(l[0]=(...d)=>p(u)&&p(u)(...d))},[T(r.$slots,"default",{invalid:!p(a).valid,values:p(n)})],32))}}),ws={key:0,class:"font-medium block mb-1"},Cs={key:1,class:"text-red-500 mt-1"},Es=f({props:{name:{default:""},label:{default:""}},setup(e){const t=e,{errorMessage:s,handleChange:a,value:n,meta:i}=we(t.name,void 0,{validateOnValueUpdate:!1}),u=E(()=>s.value?{blur:a,change:a,input:a}:{blur:a,change:a,input:r=>a(r,!1)});return(r,l)=>(c(),_("div",null,[e.label?(c(),_("label",ws,[o("span",null,b(e.label),1)])):g("",!0),T(r.$slots,"default",{error:p(s),value:p(n),validationListeners:p(u)}),p(s)?(c(),_("div",Cs,b(p(s)),1)):g("",!0)]))}}),Is=["type","placeholder","name","value"],S=f({props:{name:{default:""},label:{default:""},type:{default:"text"},placeholder:{default:""}},setup(e){const t=e,s=E(()=>t.name||t.label||"Field");return(a,n)=>(c(),x(Es,{label:e.label,name:p(s)},{default:$(({error:i,validationListeners:u,value:r})=>[o("input",Ce({class:["form-input bg-white",{"border-red-500":i}],type:e.type,placeholder:e.placeholder,name:p(s),value:r},Ee(u)),null,16,Is)]),_:1},8,["label","name"]))}});const Bs=e=>(R("data-v-8d56f61e"),e=e(),U(),e),As={class:"container h-full flex lg:items-center"},Ls={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white"},Ss={class:"w-full grid lg:grid-cols-2 lg:gap-20"},Ps={class:"flex space-x-4"},Ds={class:"btn btn-outline-primary btn-block",type:"button"},Ns=P("GoBack"),qs=Bs(()=>o("button",{class:"btn btn-primary btn-block",type:"submit"},"Login",-1)),Ms={class:"mt-1 text-sm text-red-500"},Os=Ie('<div class="row-start-1 flex flex-col lg:col-start-2 lg:-translate-y-1/2" data-v-8d56f61e><h2 class="h1" data-v-8d56f61e>\u7BA1\u7406\u54E1\u767B\u5165</h2><div class="flex-1 relative text-primary text-[5rem] sm:text-[12.5rem] flex items-center" data-v-8d56f61e><span class="z-10" data-v-8d56f61e>Ubro</span><div class="logo" data-v-8d56f61e></div></div></div>',1),Rs=f({setup(e){const t=V({phone:N().required(),password:N().required()}),{adminLogin:s}=B(),a=q();let n=y(!1),i=y("");const u=async r=>{try{n.value=!0;const{phone:l,password:d}=r;await s({phone:l,password:d}),i.value="",n.value=!1,a.push({name:"admin-products.index"})}catch(l){i.value=l.message,n.value=!1}};return(r,l)=>{const d=M("router-link");return c(),_("div",As,[p(n)?(c(),_("div",Ls," Loading ... ")):g("",!0),o("div",Ss,[h(H,{rules:p(t),action:u,class:"space-y-6"},{default:$(({values:m})=>[h(S,{name:"phone",label:"Account",required:""}),h(S,{name:"password",label:"Password",type:"password"}),o("div",Ps,[o("button",Ds,[h(d,{class:"block",to:"/"},{default:$(()=>[Ns]),_:1})]),qs]),o("div",Ms,b(p(i)),1)]),_:1},8,["rules"]),Os])])}}});var Us=I(Rs,[["__scopeId","data-v-8d56f61e"]]);const Ts={class:"container flex-center mt-20"},Fs={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white"},Vs={class:"bg-white p-10 rounded-2xl"},Hs=["disabled"],js={class:"mt-1 text-sm text-red-500"},zs={class:"mt-1 text-sm text-blue-500"},Gs=f({setup(e){const t=V({code:N().required().length(4),codeConfirmation:N().required().oneOf([Be("code")],"code do not match")});let s=y(!1),a=y(""),n=y("");const i=async u=>{try{s.value=!0;const{code:r}=u;await C.mutate({mutation:w`
          mutation updateSecurityCode($code: String!) {
            updateSecurityCode(code: $code)
          }
        `,variables:{code:r}}),a.value="",n.value="\u66F4\u65B0\u6210\u529F",s.value=!1}catch(r){a.value=r.message,n.value="",s.value=!1}};return(u,r)=>(c(),_("div",Ts,[p(s)?(c(),_("div",Fs," Loading ... ")):g("",!0),o("div",Vs,[h(H,{rules:p(t),action:i,class:"w-64 space-y-6"},{default:$(({invalid:l})=>[h(S,{name:"code",label:"\u5B89\u5168\u78BC",type:"password"}),h(S,{name:"codeConfirmation",label:"\u4E8C\u6B21\u9A57\u8B49",type:"password"}),o("button",{disabled:l,class:"btn btn-primary btn-block",type:"submit"}," \u8B8A\u66F4 ",8,Hs),o("div",js,b(p(a)),1),o("div",zs,b(p(n)),1)]),_:1},8,["rules"])])]))}});var Qs=I(Gs,[["__scopeId","data-v-c7ed979a"]]);const Js={class:"flex items-center space-x-4"},Zs=f({props:{deletedId:null},emits:["close","submit"],setup(e,{emit:t}){const s=e;return(a,n)=>(c(),x(J,{title:"\u78BA\u8A8D\u522A\u9664?",onClose:n[2]||(n[2]=i=>t("close"))},{default:$(()=>[o("div",Js,[o("button",{class:"btn btn-outline-primary btn-block",onClick:n[0]||(n[0]=i=>t("close"))}," \u53D6\u6D88 "),o("button",{class:"btn btn-primary btn-block",onClick:n[1]||(n[1]=i=>t("submit",s.deletedId))}," \u78BA\u8A8D ")])]),_:1}))}});const Ks=e=>(R("data-v-5f681052"),e=e(),U(),e),Ws={class:"product-table bg-white h-full overflow-y-scroll rounded-t-2xl"},Xs=Ks(()=>o("li",{class:"product-row !pt-6 text-gray-800 sticky top-0 bg-white"},[o("div",null,[o("span",null,"\u54C1\u9805"),o("span",null,"\u9EDE\u6578"),o("span",null,"\u529F\u80FD")])],-1)),Ys={class:"divide-x-2"},en={class:"px-2 cursor-pointer"},tn=P(" \u4FEE\u6539 "),sn=["onClick"],nn=f({props:{products:null},emits:["delete-product"],setup(e,{emit:t}){const s=y(!1),a=y(null),n=u=>{a.value=u,Ae(()=>s.value=!0)},i=async u=>{await t("delete-product",u),s.value=!1};return(u,r)=>{const l=M("router-link");return c(),_("ul",Ws,[Xs,(c(!0),_(L,null,D(e.products,d=>(c(),_("li",{key:d.id,class:"product-row"},[o("div",null,[o("span",null,b(d.name),1),o("span",null,b(d.point),1),o("div",Ys,[o("span",en,[h(l,{to:`/admin/products/${d.id}/update`},{default:$(()=>[tn]),_:2},1032,["to"])]),o("span",{class:"text-red-700 px-2 cursor-pointer",onClick:m=>n(d.id)}," \u522A\u9664 ",8,sn)])])]))),128)),s.value?(c(),x(Zs,{key:0,onClose:r[0]||(r[0]=d=>s.value=!1),onSubmit:i,"deleted-id":a.value},null,8,["deleted-id"])):g("",!0)])}}});var on=I(nn,[["__scopeId","data-v-5f681052"]]);const an={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white z-50"},rn={class:"flex justify-end mb-5"},un={class:"btn btn-primary w-40"},ln=P(" \u65B0\u589E "),cn=f({setup(e){const t=w`
    query {
      products {
        id
        name
        point
      }
    }
  `,{result:s}=se(t),a=ne(s,null,u=>u.products),n=y(!1),i=async u=>{try{n.value=!0,await C.mutate({mutation:w`
          mutation deleteProduct($id: Int!) {
            deleteProduct(id: $id)
          }
        `,variables:{id:u},update:(r,{data:{deleteProduct:l}})=>{let d=r.readQuery({query:t});d&&(d={products:d.products.filter(({id:m})=>m!==l)}),r.writeQuery({query:t,data:d})}}),n.value=!1}catch(r){throw r}};return(u,r)=>{const l=M("router-link");return c(),_(L,null,[n.value?(c(),_("div",an," Loading ... ")):g("",!0),o("div",rn,[o("button",un,[h(l,{class:"block",to:"/admin/products/create"},{default:$(()=>[ln]),_:1})])]),h(on,{products:p(a),onDeleteProduct:i},null,8,["products"])],64)}}});const dn={class:"flex justify-center mt-20"},pn={class:"bg-white p-6 rounded-xl wrapper"},_n=["disabled"],mn={key:0,class:"mt-1 text-sm text-red-500"},hn=f({setup(e){const t=y(""),s=q(),a=V({name:N().required(),point:oe().required()}),n=async i=>{try{const{name:u,point:r}=i;await C.mutate({mutation:w`
          mutation createProduct($input: CreateProductInput!) {
            createProduct(input: $input) {
              id
            }
          }
        `,variables:{input:{name:u,point:Number(r)}}}),await s.push("/admin/products")}catch(u){t.value=u.message}};return(i,u)=>(c(),_("div",dn,[o("div",pn,[h(H,{rules:p(a),action:n,class:"space-y-6"},{default:$(({invalid:r})=>[h(S,{name:"name",label:"\u54C1\u9805"}),h(S,{name:"point",type:"number",label:"\u9EDE\u6578"}),o("button",{class:"btn btn-primary btn-block",type:"submit",disabled:r}," \u65B0\u589E ",8,_n)]),_:1},8,["rules"]),t.value?(c(),_("div",mn,b(t.value),1)):g("",!0)])]))}});var vn=I(hn,[["__scopeId","data-v-2d6b8f54"]]);const fn={class:"flex justify-center mt-20"},bn={class:"bg-white p-6 rounded-xl wrapper"},gn=["disabled"],yn=f({setup(e){const t=q(),s=G(),a=V({name:N().required(),point:oe().required()}),n=Le({name:"",point:0}),i=y(!0),u=async()=>{i.value=!0;const{data:{product:l}}=await C.query({query:w`
        query product($id: Int!) {
          product(id: $id) {
            id
            name
            point
          }
        }
      `,variables:{id:+s.params.id}});n.name=l.name,n.point=l.point,i.value=!1};Se(()=>{u()});const r=async l=>{const{name:d,point:m}=l;await C.mutate({mutation:w`
        mutation updateProduct($input: UpdateProductInput!) {
          updateProduct(input: $input) {
            id
            name
            point
          }
        }
      `,variables:{input:{id:Number(s.params.id),name:d,point:Number(m)}}}),await t.push("/admin/products")};return(l,d)=>(c(),_("div",fn,[o("div",bn,[i.value?g("",!0):(c(),x(H,{key:0,rules:p(a),action:r,"initial-values":p(n),class:"space-y-6"},{default:$(({invalid:m})=>[h(S,{name:"name",label:"\u54C1\u9805"}),h(S,{name:"point",type:"number",label:"\u9EDE\u6578"}),o("button",{class:"btn btn-primary btn-block",type:"submit",disabled:m}," \u66F4\u65B0 ",8,gn)]),_:1},8,["rules","initial-values"]))])]))}});var xn=I(yn,[["__scopeId","data-v-5d58d394"]]);const O=Pe({setup(){De(Ue,C)},render:()=>Ne(ut)}),$n=qe(),kn=[Ve,He,je];function wn(){kn.forEach(e=>Te.add(e)),O.component("font-awesome-icon",Fe)}wn();const Cn=Me({locale:"en",fallbackLocale:"en",messages:{"zh-TW":dt,en:mt}}),En=[{path:"/",component:Lt,name:"home"},{path:"/points",component:Kt,name:"user-points",meta:{requiresAuth:!0}},{path:"/exchange",component:ks,name:"user-exchange",meta:{requiresAuth:!0}},{path:"/admin/login",name:"admin-login",component:Us},{path:"/admin/code",name:"admin-code",component:Qs},{path:"/admin/products",component:cn,name:"admin-products.index",meta:{requiresAdmin:!0}},{path:"/admin/products/create",component:vn,name:"admin-products.store",meta:{requiresAdmin:!0}},{path:"/admin/products/:id/update",component:xn,name:"admin-products.update",meta:{requiresAdmin:!0}}],In=Oe({history:Re("ubro"),routes:En});O.use(vt);O.use($n);O.use(Cn);O.use(In);O.mount("#app");
