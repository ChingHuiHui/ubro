var de=Object.defineProperty,pe=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var ee=(e,t,n)=>t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,W=(e,t)=>{for(var n in t||(t={}))me.call(t,n)&&ee(e,n,t[n]);if(Y)for(var n of Y(t))he.call(t,n)&&ee(e,n,t[n]);return e},te=(e,t)=>pe(e,_e(t));import{d as oe,o as ve,I as fe,c as be,s as ge,A as ye,g as x,a as v,u as X,b as F,e as E,f as R,r as O,h as c,i as m,j as o,F as M,k as N,l as d,m as h,w as y,p as V,n as H,q as S,t as f,v as $,x as g,y as Q,z as G,B as $e,C as xe,D as ae,E as re,G as ke,H as k,J as we,S as Ce,K as Ee,P as Be,L as Ie,M as ie,N as ue,O as Ae,Q as Le,R as Pe,T as Se,U as J,V as q,W as De,X as Me,Y as Fe,Z as ce,_ as Ne,$ as qe,a0 as Re,a1 as Oe,a2 as Ue,a3 as Te,a4 as Ve,a5 as He,a6 as je,a7 as ze,a8 as Ge,a9 as Qe,aa as Je,ab as Ze,ac as Ke}from"./vendor.ce06b553.js";const We=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};We();const A=oe("error",{state:()=>({loading:!1,errorMessage:""}),actions:{setErrorMessage(e){this.errorMessage=e},setLoading(e){this.loading=e}}}),Xe=ve(({graphQLErrors:e})=>{if(e){const{message:t}=e[0];A().setErrorMessage(t)}});let z=0;const Ye=async(e,t)=>{A().setErrorMessage(""),z++,z===1&&!A().loading&&A().setLoading(!0);const n=await fetch(e,t);return setTimeout(()=>{z--,z===0&&A().loading&&A().setLoading(!1)},300),n},et=new fe({typePolicies:{Query:{fields:{PRODUCT_QUERY:{merge:!0}}}}}),tt=be({uri:"https://sx3pwmngq3.execute-api.us-east-1.amazonaws.com/dev/graphql",fetch:Ye}),st=ge((e,{headers:t})=>{const n=localStorage.getItem("token");return n?{headers:te(W({},t),{Authorization:n||null})}:{headers:W({},t)}}),w=new ye({link:st.concat(Xe.concat(tt)),cache:et});var nt=async()=>{try{const{data:{me:e}}=await w.query({query:x`
        query me {
          me {
            phone
            point
            isAdmin
          }
        }
      `,fetchPolicy:"no-cache"});return e}catch(e){console.log(e)}},se=({phone:e,password:t})=>({login:async()=>{try{const{data:{login:s}}=await w.mutate({mutation:x`
          mutation login($input: LoginInput!) {
            login(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return s.token}catch(s){throw s}},adminLogin:async()=>{try{const{data:{adminLogin:s}}=await w.mutate({mutation:x`
          mutation adminLogin($input: LoginInput!) {
            adminLogin(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return s.token}catch(s){throw s}}}),ot=e=>({register:async()=>{try{await w.mutate({mutation:x`
          mutation register($input: RegisterInput!) {
            register(input: $input) {
              phone
            }
          }
        `,variables:{input:{phone:e}}})}catch(n){throw n}}});const ne={phone:"",point:0,isAdmin:!1},B=oe("auth",{state:()=>({accessToken:null,user:ne}),getters:{isLogin(){return!!this.accessToken},isAdmin(){return this.user.isAdmin},point(){return this.user.point}},actions:{async authLogin({phone:e,password:t}){const{login:n}=se({phone:e,password:t});try{const a=await n();this.setToken(a)}catch(a){throw a}},async authRegister({phone:e}){const{register:t}=ot(e);await t(),await this.authLogin({phone:e,password:e})},async adminLogin({phone:e,password:t}){const{adminLogin:n}=se({phone:e,password:t});try{const a=await n();this.setToken(a)}catch(a){throw a}},authLogout(){this.removeToken(),this.setUser(ne)},setToken(e){!e||(this.accessToken=e,localStorage.setItem("token",e))},removeToken(){this.accessToken=null,localStorage.removeItem("token")},setUser(e){this.user=e},async fetchMe(){const e=await nt();!e||this.setUser(e)}}});var I=(e,t)=>{const n=e.__vccOpts||e;for(const[a,s]of t)n[a]=s;return n};const le=e=>(V("data-v-24259786"),e=e(),H(),e),at={class:"w-56 bg-primary-light"},rt={class:"h-full"},it={class:"h-full p-10 flex flex-col items-center"},ut=le(()=>o("li",{class:"mb-5 logo"},null,-1)),ct={key:0},lt=le(()=>o("button",{class:"btn btn-primary w-40"},"\u7BA1\u7406\u8005",-1)),dt={key:1},pt=v({setup(e){const t=X(),{isLogin:n,isAdmin:a}=F(B()),s=E(()=>{var u;return a.value&&n.value?[{label:"\u5546\u54C1",to:"/admin/products"},{label:"\u4FEE\u6539\u5B89\u5168\u78BC",to:"/admin/code"}]:!a.value&&n.value&&!((u=t.name)!=null&&u.includes("admin"))?[{label:"\u96C6\u9EDE\u5361",to:"/points"},{label:"\u514C\u63DB",to:"/exchange"}]:[]}),{authLogout:i}=B(),r=R(),l=async()=>{await i(),await r.push("/")};return(u,p)=>{const _=O("router-link");return c(),m("aside",at,[o("nav",rt,[o("ul",it,[ut,(c(!0),m(M,null,N(d(s),({label:b,to:C})=>(c(),m("li",{key:b},[h(_,{to:C},{default:y(()=>[S(f(b),1)]),_:2},1032,["to"])]))),128)),d(n)?(c(),m("li",dt,[o("button",{class:"btn btn-primary w-40",onClick:l},"\u5B8C\u6210")])):(c(),m("li",ct,[h(_,{to:"/admin/login"},{default:y(()=>[lt]),_:1})]))])])])}}});var _t=I(pt,[["__scopeId","data-v-24259786"]]);const mt={class:"h-screen flex"},ht={key:0,class:"fixed z-50 inset-0 bg-black bg-opacity-60 flex-center text-white"},vt=v({setup(e){const{loading:t}=F(A()),n=X(),a=R(),s=B(),i=E(()=>n.name==="admin-login");a.afterEach(async u=>{const p=await localStorage.getItem("token");if(!p)return;const _=r(p);if(_&&l(_))return await s.removeToken(),{name:"home"};if(await s.setToken(p),await s.fetchMe(),u.meta.requiresAuth&&!s.isLogin)return{name:"home"};if(u.meta.requiresAdmin&&!s.isAdmin)return{name:"admin-login"}});const r=u=>{try{if(!u)return null;const{exp:p}=JSON.parse(atob(u.split(".")[1]));return p}catch{return null}},l=u=>Date.now()>u*1e3;return(u,p)=>{const _=O("router-view");return c(),m("div",mt,[d(t)?(c(),m("div",ht," Loading ... ")):$("",!0),d(i)?$("",!0):(c(),g(_t,{key:1})),o("main",{class:Q(["flex-1 pt-16 px-10 overflow-x-hidden relative",{"bg-white":d(i)}])},[h(_)],2)])}}}),ft="\u54C8\u56C9\uFF01\u9019\u662F\u500B vue \u5C08\u6848",bt="\u7B49\u5F85\u4E2D...";var gt={hello:ft,"My name is":"\u6211\u7684\u540D\u5B57\u662F","Ching Hui":"\u6674\u60E0","I'm a Uaena, also a frontend developer :)":"\u6211\u662FUaena\uFF0C\u4E5F\u662F\u4E00\u540D\u524D\u7AEF\u5DE5\u7A0B\u5E2B :)",loading:bt};const yt="Hello! It's a vue project",$t="loading...";var xt={hello:yt,"My name is":"My name is","Ching Hui":"Ching Hui","I'm a Uaena, also a frontend developer :)":"I'm a Uaena, also a rontend developer :)",loading:$t};class kt{set(t,n,a=30){const s={value:n,ttl:Date.now()+a*1e4};localStorage.setItem(t,JSON.stringify(s))}get(t){const n=localStorage.getItem(t);if(!n)return null;const{ttl:a,value:s}=JSON.parse(n);return Date.now()>a?(localStorage.removeItem(t),null):s}}const wt={install:e=>{const t=new kt;e.provide("storage",t)}},L=v({props:{pack:{default:"fas"},icon:{default:""}},setup(e){return(t,n)=>{const a=O("font-awesome-icon");return c(),g(a,{icon:[e.pack,e.icon]},null,8,["icon"])}}}),Ct=["onClick"],Et={class:"modal min-w-[300px] bg-white p-6 rounded-lg relative"},Bt={key:0,class:"h1 text-center mb-4"},Z=v({props:{title:{default:""}},emits:["close"],setup(e,{emit:t}){const n=()=>{t("close")};return(a,s)=>(c(),m("div",{class:"fixed inset-0 z-40 bg-black bg-opacity-60 flex-center",onClick:$e(n,["self"])},[o("div",Et,[h(L,{icon:"plus",class:"rotate-45 absolute right-6 top-6 cursor-pointer",onClick:n}),G(a.$slots,"title",{},()=>[e.title?(c(),m("div",Bt,f(e.title),1)):$("",!0)]),G(a.$slots,"default")])],8,Ct))}}),It={class:"flex items-center space-x-4"},At=v({emits:["close","submit"],setup(e,{emit:t}){return(n,a)=>(c(),g(Z,{title:"\u65B0\u865F\u78BC\uFF0C\u662F\u5426\u8981\u8A3B\u518A?",onClose:a[2]||(a[2]=s=>t("close"))},{default:y(()=>[o("div",It,[o("button",{class:"btn btn-outline-primary btn-block",onClick:a[0]||(a[0]=s=>t("close"))}," \u53D6\u6D88 "),o("button",{class:"btn btn-primary btn-block",onClick:a[1]||(a[1]=s=>t("submit"))}," \u78BA\u8A8D ")])]),_:1}))}});const Lt=e=>(V("data-v-2f1876ce"),e=e(),H(),e),Pt={class:"flex flex-col items-center"},St=Lt(()=>o("h2",{class:"h1 text-center mb-5"},"LOGIN",-1)),Dt={class:"wrapper"},Mt={class:"phone-input flex items-center"},Ft={key:0,class:"w-10 h-10 flex-center rounded-full border border-green-500 text-green-500"},Nt={class:"phone-pad"},qt=["onClick"],Rt={key:0},Ot={key:2},Ut=v({props:{phone:null},emits:["submit","input"],setup(e,{emit:t}){const n=e,a=8,s=10,i=11,r=12,l=E(()=>/((?=(09))[0-9]{10})$/g.test(n.phone));return xe(()=>{const u=[...Array(10)].map((p,_)=>`${_}`);document.addEventListener("keyup",({key:p,keyCode:_})=>{(_>=48&&_<=57||_>=96&&_<=105)&&u.includes(p)&&t("input",p),_===a&&t("input",s)})}),(u,p)=>(c(),m("div",Pt,[St,o("div",Dt,[o("div",Mt,[ae(o("input",{"onUpdate:modelValue":p[0]||(p[0]=_=>ke(phone)?phone.value=_:null),maxlength:"10",class:"flex-1 outline-none",readonly:""},null,512),[[re,e.phone]]),d(l)?(c(),m("div",Ft,[d(l)?(c(),g(L,{key:0,icon:"check",class:"text-xl"})):$("",!0)])):$("",!0)]),o("div",Nt,[(c(),m(M,null,N(12,_=>o("button",{key:_,class:Q(["phone-button",{invalid:!d(l),"login-button":_===r}]),onClick:b=>t("input",_)},[_<10?(c(),m("span",Rt,f(_),1)):_===s?(c(),g(L,{key:1,icon:"plus",class:"rotate-45"})):_===i?(c(),m("span",Ot,"0")):_===r?(c(),g(L,{key:3,icon:"check",class:"check-icon"})):$("",!0)],10,qt)),64))])])]))}});var Tt=I(Ut,[["__scopeId","data-v-2f1876ce"]]);const Vt=v({setup(e){const i=k(!1),r=k("");E(()=>/((?=(09))[0-9]{10})$/g.test(r.value));const l=D=>{let T=String(D);if(D===10){r.value=r.value.slice(0,-1);return}if(D===12){j();return}D===11&&(T="0"),!(r.value.length>=10)&&(r.value+=T)},u=R(),{isLogin:p}=F(B()),{authLogin:_,authRegister:b}=B();we(()=>{p.value&&u.push("/points")});const C=async()=>{i.value=!1,await b({phone:r.value}),alert("\u5B8C\u6210")},j=async()=>{try{await _({phone:r.value,password:r.value})}catch(D){D.message==="this phone not register"&&(i.value=!0)}finally{}};return(D,T)=>(c(),m("div",null,[d(p)?$("",!0):(c(),g(Tt,{key:0,onSubmit:j,phone:r.value,onInput:l},null,8,["phone"])),i.value?(c(),g(At,{key:1,onSubmit:C,onClose:T[0]||(T[0]=qn=>i.value=!1)})):$("",!0)]))}});const Ht={class:"flex-center"},jt={class:"grid grid-cols-5 gap-6"},zt={class:"tag"},Gt=v({props:{points:null},setup(e){const t=e,n=[Ee,Be],a=10,s=E(()=>t.points===0?1:Math.ceil(t.points/a)),i=(l,u)=>(s.value-1-l)*a+u,r=(l,u)=>i(l,u)<=t.points;return(l,u)=>(c(),m("section",Ht,[h(d(Ce),{effect:"cards",grabCursor:!0,modules:n,pagination:{clickable:!0}},{default:y(()=>[(c(!0),m(M,null,N(d(s),(p,_)=>(c(),g(d(Ie),{key:`point-card-${p}`},{default:y(()=>[o("div",jt,[(c(),m(M,null,N(a,b=>o("div",{key:`point-${i(_,b)}`,class:Q(["point",{"have-stamp":r(_,b)}])},[o("span",zt," UBRO "+f(i(_,b)),1)],2)),64))])]),_:2},1024))),128))]),_:1})]))}});var Qt=I(Gt,[["__scopeId","data-v-2dba6f70"]]);const Jt={class:"flex items-center space-x-4 mb-4"},Zt=o("label",{for:"code"},"\u5B89\u5168\u78BC",-1),Kt={class:"text-red-500 text-sm mb-1"},Wt=["disabled"],Xt=v({props:{number:null},emits:["close","submit"],setup(e,{emit:t}){const n=e,a=B(),s=k(""),i=E(()=>`\u65B0\u589E ${n.number} \u9EDE`),{errorMessage:r}=F(A()),l=async()=>{try{await w.mutate({mutation:x`
          mutation updatePoint($input: UpdatePointInput!) {
            updatePoint(input: $input)
          }
        `,variables:{input:{point:Number(n.number),securityCode:s.value}}}),await a.fetchMe(),t("submit"),t("close")}catch(u){console.log(u)}};return(u,p)=>(c(),g(Z,{title:d(i),onClose:p[1]||(p[1]=_=>t("close"))},{default:y(()=>[o("div",Jt,[Zt,ae(o("input",{"onUpdate:modelValue":p[0]||(p[0]=_=>s.value=_),placeholder:"\u8ACB\u8F38\u5165\u5B89\u5168\u78BC",name:"code",type:"password",class:"border px-2",maxlength:"4",minlength:"4"},null,512),[[re,s.value]])]),o("p",Kt,f(d(r)),1),o("button",{disabled:s.value.length<4,class:"btn btn-primary btn-block",onClick:l}," \u78BA\u8A8D\u65B0\u589E ",8,Wt)]),_:1},8,["title"]))}});const Yt={class:"flex flex-col flex-center"},es={class:"wrapper"},ts={class:"grid grid-cols-2 gap-6"},ss={class:"card text-3xl flex-center"},ns={class:"card p-4 flex justify-between space-x-4"},os={class:"flex-1 flex items-center space-x-6"},as={class:"flex-1 text-center font-bold text-lg"},rs=["disabled"],is=v({setup(e){const{point:t}=F(B()),n=k(!1),a=k(0),s=()=>{a.value++},i=()=>{a.value<=0||a.value--},r=()=>{a.value=0};return(l,u)=>(c(),m("div",Yt,[o("div",es,[h(Qt,{points:d(t),class:"mb-5"},null,8,["points"]),o("div",ts,[o("div",ss,"\u7E3D\u9EDE\u6578\uFF1A "+f(d(t))+" \u9EDE",1),o("div",ns,[o("div",os,[o("button",{onClick:i,class:"btn control-button"},[h(L,{icon:"minus"})]),o("div",as,f(a.value),1),o("button",{onClick:s,class:"btn control-button"},[h(L,{icon:"plus"})])]),o("button",{class:"btn btn-primary stamp-button",onClick:u[0]||(u[0]=p=>n.value=!0),disabled:a.value===0},[h(L,{icon:"stamp"})],8,rs)])])]),n.value?(c(),g(Xt,{key:0,number:a.value,onClose:u[1]||(u[1]=p=>n.value=!1),onSubmit:r},null,8,["number"])):$("",!0)]))}});var us=I(is,[["__scopeId","data-v-50971a5e"]]);const cs=e=>(V("data-v-26926b64"),e=e(),H(),e),ls={class:"product-table py-6"},ds=cs(()=>o("li",{class:"product-row p-2 text-gray-800"},[o("div",null,[o("span",null,"\u514C\u63DB"),o("span",null,"\u54C1\u9805"),o("span",null,"\u9EDE\u6578")])],-1)),ps=["onClick"],_s={class:"check"},ms=v({props:{products:null,active:null,point:null},emits:["change"],setup(e,{emit:t}){return(n,a)=>(c(),m("ul",ls,[ds,(c(!0),m(M,null,N(e.products,s=>(c(),m("li",{onClick:i=>t("change",s.id),key:s.id,class:Q(["product-row cursor-pointer",{active:e.active===s.id,"bg-gray-200 bg-opacity-50 pointer-events-none":e.point<s.point}])},[o("div",null,[o("span",null,[o("div",_s,[h(L,{icon:"check"})])]),o("span",null,f(s.name),1),o("span",null,f(s.point),1)])],10,ps))),128))]))}});var hs=I(ms,[["__scopeId","data-v-26926b64"]]);const vs={class:"flex items-center space-x-4"},fs=v({props:{productId:null},emits:["close","submit"],setup(e,{emit:t}){const n=e,a=B(),s=async()=>{try{await w.mutate({mutation:x`
          mutation exchange($productId: Int!) {
            exchange(productId: $productId)
          }
        `,variables:{productId:n.productId}}),await a.fetchMe(),t("submit"),t("close")}catch(i){console.log(i)}};return(i,r)=>(c(),g(Z,{title:"\u78BA\u8A8D\u514C\u63DB?",onClose:r[1]||(r[1]=l=>t("close"))},{default:y(()=>[o("div",vs,[o("button",{class:"btn btn-outline-primary btn-block",onClick:r[0]||(r[0]=l=>t("close"))}," \u53D6\u6D88 "),o("button",{class:"btn btn-primary btn-block",onClick:s},"\u78BA\u8A8D")])]),_:1}))}}),bs={class:"flex-center h-full"},gs={class:"wrapper flex flex-col h-full"},ys={class:"flex-center mb-4 space-x-5"},$s={class:"h1 !font-normal inline-block p-2"},xs=S(" \u76EE\u524D\u6709 "),ks={class:"text-primary-dark font-bold mx-1"},ws=S(" \u9EDE "),Cs={class:"flex-1 bg-white overflow-y-scroll rounded-t-2xl"},Es={class:"sticky top-0 bg-white px-6 py-3 shadow flex items-center justify-between"},Bs={class:"flex items-center space-x-4"},Is=o("span",null,"\u514C\u63DB",-1),As={class:"border-b-2 border-b-primary pb-0.5 text-xl font-medium"},Ls=S(" \u4F7F\u7528 "),Ps={class:"font-medium text-lg"},Ss=S(" \u9EDE "),Ds=["disabled"],Ms={key:0,class:"flex-center mt-10 font-medium"},Fs=v({setup(e){const{result:t,loading:n}=ie(x`
    query {
      products {
        id
        name
        point
      }
    }
  `),a=ue(t,null,b=>b.products),{point:s}=F(B()),i=k(!1),r=k(null),l=b=>{r.value=r.value===b?null:b},u=E(()=>{if(!!Array.isArray(a.value))return a.value.find(({id:b})=>b===r.value)}),p=E(()=>{var C;const b=((C=u.value)==null?void 0:C.point)||0;return s.value-b}),_=()=>{r.value=null};return(b,C)=>(c(),m("div",bs,[o("div",gs,[o("div",ys,[o("div",$s,[xs,o("span",ks,f(d(p))+" / "+f(d(s)),1),ws])]),o("div",Cs,[o("div",Es,[o("div",Bs,[Is,o("span",As,f(d(u)?d(u).name:"\u5C1A\u672A\u514C\u63DB\u4EFB\u4F55\u5546\u54C1"),1),o("span",null,[Ls,o("span",Ps,f(d(u)?d(u).point:0),1),Ss])]),o("button",{disabled:!r.value,class:"btn btn-primary w-40",onClick:C[0]||(C[0]=j=>i.value=!0)}," \u78BA\u8A8D\u514C\u63DB ",8,Ds)]),d(n)?(c(),m("div",Ms," \u6B63\u5728\u52AA\u529B\u5C0B\u627E\u6709\u4EC0\u9EBC\u53EF\u4EE5\u514C\u63DB\u7684\u597D\u6771\u897F ... ")):(c(),g(hs,{key:1,products:d(a),onChange:l,active:r.value,point:d(s)},null,8,["products","active","point"]))])]),i.value?(c(),g(fs,{key:0,"product-id":r.value,onClose:C[1]||(C[1]=j=>i.value=!1),onSubmit:_},null,8,["product-id"])):$("",!0)]))}}),K=v({props:{rules:{default:()=>({})},action:null,initialValues:{default:()=>({})}},setup(e){const t=e,{handleSubmit:n,meta:a,values:s,resetForm:i}=Ae({initialValues:t.initialValues,validationSchema:t.rules}),r=n(async()=>{try{await t.action(s),i()}catch(l){throw l}});return(l,u)=>(c(),m("form",{onSubmit:u[0]||(u[0]=(...p)=>d(r)&&d(r)(...p))},[G(l.$slots,"default",{invalid:!d(a).valid,values:d(s)})],32))}}),Ns={key:0,class:"font-medium block mb-1"},qs={key:1,class:"text-red-500 mt-1"},Rs=v({props:{name:{default:""},label:{default:""}},setup(e){const t=e,{errorMessage:n,handleChange:a,value:s,meta:i}=Le(t.name,void 0,{validateOnValueUpdate:!1}),r=E(()=>n.value?{blur:a,change:a,input:a}:{blur:a,change:a,input:l=>a(l,!1)});return(l,u)=>(c(),m("div",null,[e.label?(c(),m("label",Ns,[o("span",null,f(e.label),1)])):$("",!0),G(l.$slots,"default",{error:d(n),value:d(s),validationListeners:d(r)}),d(n)?(c(),m("div",qs,f(d(n)),1)):$("",!0)]))}}),Os=["type","placeholder","name","value"],P=v({props:{name:{default:""},label:{default:""},type:{default:"text"},placeholder:{default:""}},setup(e){const t=e,n=E(()=>t.name||t.label||"Field");return(a,s)=>(c(),g(Rs,{label:e.label,name:d(n)},{default:y(({error:i,validationListeners:r,value:l})=>[o("input",Pe({class:["form-input bg-white",{"border-red-500":i}],type:e.type,placeholder:e.placeholder,name:d(n),value:l},Se(r)),null,16,Os)]),_:1},8,["label","name"]))}});const Us=e=>(V("data-v-fbe53f98"),e=e(),H(),e),Ts={class:"container h-full flex lg:items-center"},Vs={class:"w-full grid lg:grid-cols-2 lg:gap-20"},Hs={class:"flex space-x-4"},js={class:"btn btn-outline-primary btn-block",type:"button"},zs=S("GoBack"),Gs=Us(()=>o("button",{class:"btn btn-primary btn-block",type:"submit"},"Login",-1)),Qs={class:"mt-1 text-sm text-red-500"},Js=De('<div class="row-start-1 flex flex-col lg:col-start-2 lg:-translate-y-1/2" data-v-fbe53f98><h2 class="h1" data-v-fbe53f98>\u7BA1\u7406\u54E1\u767B\u5165</h2><div class="flex-1 relative text-primary text-[5rem] sm:text-[12.5rem] flex items-center" data-v-fbe53f98><span class="z-10" data-v-fbe53f98>Ubro</span><div class="logo" data-v-fbe53f98></div></div></div>',1),Zs=v({setup(e){const t=J({phone:q().required(),password:q().required()}),{adminLogin:n}=B(),a=R();let s=k("");const i=async r=>{try{const{phone:l,password:u}=r;await n({phone:l,password:u}),s.value="",a.push({name:"admin-products.index"})}catch(l){s.value=l.message}};return(r,l)=>{const u=O("router-link");return c(),m("div",Ts,[o("div",Vs,[h(K,{rules:d(t),action:i,class:"space-y-6"},{default:y(({values:p})=>[h(P,{name:"phone",label:"Account",required:""}),h(P,{name:"password",label:"Password",type:"password"}),o("div",Hs,[o("button",js,[h(u,{class:"block",to:"/"},{default:y(()=>[zs]),_:1})]),Gs]),o("div",Qs,f(d(s)),1)]),_:1},8,["rules"]),Js])])}}});var Ks=I(Zs,[["__scopeId","data-v-fbe53f98"]]);const Ws={class:"container flex-center mt-20"},Xs={class:"bg-white p-10 rounded-2xl"},Ys=["disabled"],en={class:"mt-1 text-sm text-red-500"},tn={class:"mt-1 text-sm text-blue-500"},sn=v({setup(e){const t=J({code:q().required().length(4),codeConfirmation:q().required().oneOf([Me("code")],"code do not match")});let n=k("");const{errorMessage:a}=F(A()),s=async i=>{const{code:r}=i;n.value="",await w.mutate({mutation:x`
        mutation updateSecurityCode($code: String!) {
          updateSecurityCode(code: $code)
        }
      `,variables:{code:r}}),n.value="\u66F4\u65B0\u6210\u529F"};return(i,r)=>(c(),m("div",Ws,[o("div",Xs,[h(K,{rules:d(t),action:s,class:"w-64 space-y-6"},{default:y(({invalid:l})=>[h(P,{name:"code",label:"\u5B89\u5168\u78BC",type:"password"}),h(P,{name:"codeConfirmation",label:"\u8ACB\u518D\u8F38\u5165\u4E00\u6B21",type:"password"}),o("button",{disabled:l,class:"btn btn-primary btn-block",type:"submit"}," \u8B8A\u66F4 ",8,Ys),o("div",en,f(d(a)),1),o("div",tn,f(d(n)),1)]),_:1},8,["rules"])])]))}});var nn=I(sn,[["__scopeId","data-v-74cf5f26"]]);const on={class:"flex items-center space-x-4"},an=v({props:{deletedId:null},emits:["close","submit"],setup(e,{emit:t}){const n=e;return(a,s)=>(c(),g(Z,{title:"\u78BA\u8A8D\u522A\u9664?",onClose:s[2]||(s[2]=i=>t("close"))},{default:y(()=>[o("div",on,[o("button",{class:"btn btn-outline-primary btn-block",onClick:s[0]||(s[0]=i=>t("close"))}," \u53D6\u6D88 "),o("button",{class:"btn btn-primary btn-block",onClick:s[1]||(s[1]=i=>t("submit",n.deletedId))}," \u78BA\u8A8D ")])]),_:1}))}});const rn=e=>(V("data-v-5f681052"),e=e(),H(),e),un={class:"product-table bg-white h-full overflow-y-scroll rounded-t-2xl"},cn=rn(()=>o("li",{class:"product-row !pt-6 text-gray-800 sticky top-0 bg-white"},[o("div",null,[o("span",null,"\u54C1\u9805"),o("span",null,"\u9EDE\u6578"),o("span",null,"\u529F\u80FD")])],-1)),ln={class:"divide-x-2"},dn={class:"px-2 cursor-pointer"},pn=S(" \u4FEE\u6539 "),_n=["onClick"],mn=v({props:{products:null},emits:["delete-product"],setup(e,{emit:t}){const n=k(!1),a=k(null),s=r=>{a.value=r,Fe(()=>n.value=!0)},i=async r=>{await t("delete-product",r),n.value=!1};return(r,l)=>{const u=O("router-link");return c(),m("ul",un,[cn,(c(!0),m(M,null,N(e.products,p=>(c(),m("li",{key:p.id,class:"product-row"},[o("div",null,[o("span",null,f(p.name),1),o("span",null,f(p.point),1),o("div",ln,[o("span",dn,[h(u,{to:`/admin/products/${p.id}/update`},{default:y(()=>[pn]),_:2},1032,["to"])]),o("span",{class:"text-red-700 px-2 cursor-pointer",onClick:_=>s(p.id)}," \u522A\u9664 ",8,_n)])])]))),128)),n.value?(c(),g(an,{key:0,onClose:l[0]||(l[0]=p=>n.value=!1),onSubmit:i,"deleted-id":a.value},null,8,["deleted-id"])):$("",!0)])}}});var hn=I(mn,[["__scopeId","data-v-5f681052"]]);const vn={class:"flex justify-end mb-5"},fn={class:"btn btn-primary w-40"},bn=S(" \u65B0\u589E "),gn=v({setup(e){const t=x`
    query {
      products {
        id
        name
        point
      }
    }
  `,{result:n}=ie(t),a=ue(n,null,i=>i.products),s=async i=>{try{await w.mutate({mutation:x`
          mutation deleteProduct($id: Int!) {
            deleteProduct(id: $id)
          }
        `,variables:{id:i},update:(r,{data:{deleteProduct:l}})=>{let u=r.readQuery({query:t});u&&(u={products:u.products.filter(({id:p})=>p!==l)}),r.writeQuery({query:t,data:u})}})}catch(r){throw r}};return(i,r)=>{const l=O("router-link");return c(),m(M,null,[o("div",vn,[o("button",fn,[h(l,{class:"block",to:"/admin/products/create"},{default:y(()=>[bn]),_:1})])]),h(hn,{products:d(a),onDeleteProduct:s},null,8,["products"])],64)}}});const yn={class:"flex justify-center mt-20"},$n={class:"bg-white p-6 rounded-xl wrapper"},xn=["disabled"],kn={key:0,class:"mt-1 text-sm text-red-500"},wn=v({setup(e){const t=k(""),n=R(),a=J({name:q().required(),point:ce().required()}),s=async i=>{try{const{name:r,point:l}=i;await w.mutate({mutation:x`
          mutation createProduct($input: CreateProductInput!) {
            createProduct(input: $input) {
              id
            }
          }
        `,variables:{input:{name:r,point:Number(l)}}}),await n.push("/admin/products")}catch(r){t.value=r.message}};return(i,r)=>(c(),m("div",yn,[o("div",$n,[h(K,{rules:d(a),action:s,class:"space-y-6"},{default:y(({invalid:l})=>[h(P,{name:"name",label:"\u54C1\u9805"}),h(P,{name:"point",type:"number",label:"\u9EDE\u6578"}),o("button",{class:"btn btn-primary btn-block",type:"submit",disabled:l}," \u65B0\u589E ",8,xn)]),_:1},8,["rules"]),t.value?(c(),m("div",kn,f(t.value),1)):$("",!0)])]))}});var Cn=I(wn,[["__scopeId","data-v-2d6b8f54"]]);const En={class:"flex justify-center mt-20"},Bn={class:"bg-white p-6 rounded-xl wrapper"},In=["disabled"],An=v({setup(e){const t=R(),n=X(),a=J({name:q().required(),point:ce().required()}),s=Ne({name:"",point:0}),i=k(!0),r=async()=>{i.value=!0;const{data:{product:u}}=await w.query({query:x`
        query product($id: Int!) {
          product(id: $id) {
            id
            name
            point
          }
        }
      `,variables:{id:+n.params.id}});s.name=u.name,s.point=u.point,i.value=!1};qe(()=>{r()});const l=async u=>{const{name:p,point:_}=u;await w.mutate({mutation:x`
        mutation updateProduct($input: UpdateProductInput!) {
          updateProduct(input: $input) {
            id
            name
            point
          }
        }
      `,variables:{input:{id:Number(n.params.id),name:p,point:Number(_)}}}),await t.push("/admin/products")};return(u,p)=>(c(),m("div",En,[o("div",Bn,[i.value?$("",!0):(c(),g(K,{key:0,rules:d(a),action:l,"initial-values":d(s),class:"space-y-6"},{default:y(({invalid:_})=>[h(P,{name:"name",label:"\u54C1\u9805"}),h(P,{name:"point",type:"number",label:"\u9EDE\u6578"}),o("button",{class:"btn btn-primary btn-block",type:"submit",disabled:_}," \u66F4\u65B0 ",8,In)]),_:1},8,["rules","initial-values"]))])]))}});var Ln=I(An,[["__scopeId","data-v-5d58d394"]]);const U=Re({setup(){Oe(ze,w)},render:()=>Ue(vt)}),Pn=Te(),Sn=[Je,Ze,Ke];function Dn(){Sn.forEach(e=>Ge.add(e)),U.component("font-awesome-icon",Qe)}Dn();const Mn=Ve({locale:"en",fallbackLocale:"en",messages:{"zh-TW":gt,en:xt}}),Fn=[{path:"/",component:Vt,name:"home"},{path:"/points",component:us,name:"user-points",meta:{requiresAuth:!0}},{path:"/exchange",component:Fs,name:"user-exchange",meta:{requiresAuth:!0}},{path:"/admin/login",name:"admin-login",component:Ks},{path:"/admin/code",name:"admin-code",component:nn},{path:"/admin/products",component:gn,name:"admin-products.index",meta:{requiresAdmin:!0}},{path:"/admin/products/create",component:Cn,name:"admin-products.store",meta:{requiresAdmin:!0}},{path:"/admin/products/:id/update",component:Ln,name:"admin-products.update",meta:{requiresAdmin:!0}}],Nn=He({history:je("ubro"),routes:Fn});U.use(wt);U.use(Pn);U.use(Mn);U.use(Nn);U.mount("#app");
