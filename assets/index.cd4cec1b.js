var pe=Object.defineProperty,_e=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var te=(e,t,o)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,K=(e,t)=>{for(var o in t||(t={}))he.call(t,o)&&te(e,o,t[o]);if(ee)for(var o of ee(t))ve.call(t,o)&&te(e,o,t[o]);return e},se=(e,t)=>_e(e,me(t));import{d as ae,o as fe,I as be,c as ge,s as ye,A as $e,g as k,a as f,b as R,u as q,e as Y,f as A,r as U,h as c,i as p,j as n,F as E,k as D,l as v,w as y,m as N,t as h,n as d,p as z,q as Q,v as $,x as b,y as H,z as V,B as xe,C as ke,D as ue,E as re,G as we,H as x,J as Ce,S as Ee,K as Ae,L as Be,P as Ie,M as ie,N as ce,O as De,Q as Le,R as Pe,T as Se,U as X,V as F,W as Re,X as Ne,Y as Me,Z as le,_ as Fe,$ as qe,a0 as Ue,a1 as Oe,a2 as Te,a3 as Ve,a4 as He,a5 as Ge,a6 as je,a7 as ze,a8 as Qe,a9 as Xe,aa as Je,ab as Ze,ac as Ke}from"./vendor.737048de.js";const We=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}};We();const L=ae("error",{state:()=>({loading:!1,errorMessage:""}),actions:{setErrorMessage(e){this.errorMessage=e},setLoading(e){this.loading=e}}}),Ye=fe(({graphQLErrors:e})=>{if(e){const{message:t}=e[0];L().setErrorMessage(t)}});let j=0;const et=async(e,t)=>{L().setErrorMessage(""),j++,j===1&&!L().loading&&L().setLoading(!0);const o=await fetch(e,t);return setTimeout(()=>{j--,j===0&&L().loading&&L().setLoading(!1)},300),o},tt=new be({typePolicies:{Query:{fields:{PRODUCT_QUERY:{merge:!0}}}}}),st=ge({uri:"https://sx3pwmngq3.execute-api.us-east-1.amazonaws.com/dev/graphql",fetch:et}),nt=ye((e,{headers:t})=>{const o=localStorage.getItem("token");return o?{headers:se(K({},t),{Authorization:o||null})}:{headers:K({},t)}}),w=new $e({link:nt.concat(Ye.concat(st)),cache:tt});var ot=async()=>{try{const{data:{me:e}}=await w.query({query:k`
        query me {
          me {
            phone
            point
            isAdmin
            exchangeRecords {
              id
              point
              productName
              createdAt
            }
            consumeRecords {
              id
              point
              createdAt
            }
          }
        }
      `,fetchPolicy:"no-cache"});return e}catch(e){console.log(e)}},ne=({phone:e,password:t})=>({login:async()=>{try{const{data:{login:s}}=await w.mutate({mutation:k`
          mutation login($input: LoginInput!) {
            login(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return s.token}catch(s){throw s}},adminLogin:async()=>{try{const{data:{adminLogin:s}}=await w.mutate({mutation:k`
          mutation adminLogin($input: LoginInput!) {
            adminLogin(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return s.token}catch(s){throw s}}}),at=e=>({register:async()=>{try{await w.mutate({mutation:k`
          mutation register($input: RegisterInput!) {
            register(input: $input) {
              phone
            }
          }
        `,variables:{input:{phone:e}}})}catch(o){throw o}}});const oe={phone:"",point:0,exchangeRecords:[],consumeRecords:[],isAdmin:!1},B=ae("auth",{state:()=>({accessToken:null,user:oe}),getters:{isLogin(){return!!this.accessToken},isAdmin(){return this.user.isAdmin},point(){return this.user.point},exchangeRecords(){return this.user.exchangeRecords},consumeRecords(){return this.user.consumeRecords}},actions:{async authLogin({phone:e,password:t}){const{login:o}=ne({phone:e,password:t});try{const a=await o();this.setToken(a)}catch(a){throw a}},async authRegister({phone:e}){const{register:t}=at(e);await t(),await this.authLogin({phone:e,password:e})},async adminLogin({phone:e,password:t}){const{adminLogin:o}=ne({phone:e,password:t});try{const a=await o();this.setToken(a)}catch(a){throw a}},authLogout(){this.removeToken(),this.setUser(oe)},setToken(e){!e||(this.accessToken=e,localStorage.setItem("token",e))},removeToken(){this.accessToken=null,localStorage.removeItem("token")},setUser(e){this.user=e},async fetchMe(){const e=await ot();!e||this.setUser(e)}}});var I=(e,t)=>{const o=e.__vccOpts||e;for(const[a,s]of t)o[a]=s;return o};const de=e=>(z("data-v-38f84b63"),e=e(),Q(),e),ut={class:"w-56 bg-primary-light"},rt={class:"h-full"},it={class:"h-full p-10 flex flex-col items-center"},ct=de(()=>n("li",{class:"mb-5 logo"},null,-1)),lt={key:0},dt=de(()=>n("button",{class:"btn btn-primary w-40"},"\u7BA1\u7406\u8005",-1)),pt={key:1},_t=f({setup(e){const{isLogin:t}=R(B()),o=q(),a=Y(),s=A(()=>{const i=a.name;return i?i.includes("admin"):!1}),r=A(()=>!t.value||a.name==="home"?[]:s.value?[{label:"\u5546\u54C1",to:"/admin/products"},{label:"\u4FEE\u6539\u5B89\u5168\u78BC",to:"/admin/code"}]:[{label:"\u96C6\u9EDE\u5361",to:"/points"},{label:"\u514C\u63DB",to:"/exchange"},{label:"\u7D00\u9304",to:"/records"}]),{authLogout:u}=B(),l=async()=>{if(await u(),s.value){await o.push("/admin/login");return}await o.push("/")};return(i,_)=>{const m=U("router-link");return c(),p("aside",ut,[n("nav",rt,[n("ul",it,[ct,(c(!0),p(E,null,D(d(r),({label:g,to:C})=>(c(),p("li",{key:g},[v(m,{to:C},{default:y(()=>[N(h(g),1)]),_:2},1032,["to"])]))),128)),d(t)?(c(),p("li",pt,[n("button",{class:"btn btn-primary w-40",onClick:l},h(d(s)?"\u767B\u51FA":"\u5B8C\u6210"),1)])):(c(),p("li",lt,[v(m,{to:"/admin/login"},{default:y(()=>[dt]),_:1})]))])])])}}});var mt=I(_t,[["__scopeId","data-v-38f84b63"]]);const ht={class:"h-screen flex"},vt={key:0,class:"fixed z-50 inset-0 bg-black bg-opacity-60 flex-center text-white"},ft=f({setup(e){const{loading:t}=R(L()),o=Y(),a=q(),s=B(),r=A(()=>o.name==="admin-login");a.beforeEach(async i=>{const _=await localStorage.getItem("token");_&&(await s.setToken(_),await s.fetchMe());const m=u(_);if(m&&l(m))return await s.removeToken(),{name:"home"};if(i.meta.requiresAdmin&&!s.isAdmin)return{name:"admin-login"};if(i.meta.requiresAuth&&!s.isLogin)return{name:"home"}});const u=i=>{try{if(!i)return null;const{exp:_}=JSON.parse(atob(i.split(".")[1]));return _}catch{return null}},l=i=>Date.now()>i*1e3;return(i,_)=>{const m=U("router-view");return c(),p("div",ht,[d(t)?(c(),p("div",vt," Loading ... ")):$("",!0),d(r)?$("",!0):(c(),b(mt,{key:1})),n("main",{class:H(["flex-1 pt-16 px-10 overflow-x-hidden relative",{"bg-white":d(r)}])},[v(m)],2)])}}}),bt="\u54C8\u56C9\uFF01\u9019\u662F\u500B vue \u5C08\u6848",gt="\u7B49\u5F85\u4E2D...";var yt={hello:bt,"My name is":"\u6211\u7684\u540D\u5B57\u662F","Ching Hui":"\u6674\u60E0","I'm a Uaena, also a frontend developer :)":"\u6211\u662FUaena\uFF0C\u4E5F\u662F\u4E00\u540D\u524D\u7AEF\u5DE5\u7A0B\u5E2B :)",loading:gt};const $t="Hello! It's a vue project",xt="loading...";var kt={hello:$t,"My name is":"My name is","Ching Hui":"Ching Hui","I'm a Uaena, also a frontend developer :)":"I'm a Uaena, also a rontend developer :)",loading:xt};class wt{set(t,o,a=30){const s={value:o,ttl:Date.now()+a*1e4};localStorage.setItem(t,JSON.stringify(s))}get(t){const o=localStorage.getItem(t);if(!o)return null;const{ttl:a,value:s}=JSON.parse(o);return Date.now()>a?(localStorage.removeItem(t),null):s}}const Ct={install:e=>{const t=new wt;e.provide("storage",t)}},P=f({props:{pack:{default:"fas"},icon:{default:""}},setup(e){return(t,o)=>{const a=U("font-awesome-icon");return c(),b(a,{icon:[e.pack,e.icon]},null,8,["icon"])}}}),Et=["onClick"],At={class:"modal min-w-[300px] bg-white p-6 pt-10 rounded-lg relative"},Bt={key:0,class:"h1 text-center mb-4"},J=f({props:{title:{default:""}},emits:["close"],setup(e,{emit:t}){const o=()=>{t("close")};return(a,s)=>(c(),p("div",{class:"fixed inset-0 z-40 bg-black bg-opacity-60 flex-center",onClick:xe(o,["self"])},[n("div",At,[v(P,{icon:"plus",class:"rotate-45 absolute right-3 top-3 cursor-pointer",onClick:o}),V(a.$slots,"title",{},()=>[e.title?(c(),p("div",Bt,h(e.title),1)):$("",!0)]),V(a.$slots,"default")])],8,Et))}}),It={class:"flex items-center space-x-4"},Dt=f({emits:["close","submit"],setup(e,{emit:t}){return(o,a)=>(c(),b(J,{title:"\u65B0\u865F\u78BC,\u662F\u5426\u8981\u8A3B\u518A?",onClose:a[2]||(a[2]=s=>t("close"))},{default:y(()=>[n("div",It,[n("button",{class:"btn btn-outline-primary btn-block",onClick:a[0]||(a[0]=s=>t("close"))}," \u53D6\u6D88 "),n("button",{class:"btn btn-primary btn-block",onClick:a[1]||(a[1]=s=>t("submit"))}," \u78BA\u8A8D ")])]),_:1}))}});const Lt=e=>(z("data-v-2f1876ce"),e=e(),Q(),e),Pt={class:"flex flex-col items-center"},St=Lt(()=>n("h2",{class:"h1 text-center mb-5"},"LOGIN",-1)),Rt={class:"wrapper"},Nt={class:"phone-input flex items-center"},Mt={key:0,class:"w-10 h-10 flex-center rounded-full border border-green-500 text-green-500"},Ft={class:"phone-pad"},qt=["onClick"],Ut={key:0},Ot={key:2},Tt=f({props:{phone:null},emits:["submit","input"],setup(e,{emit:t}){const o=e,a=8,s=10,r=11,u=12,l=A(()=>/((?=(09))[0-9]{10})$/g.test(o.phone));return ke(()=>{const i=[...Array(10)].map((_,m)=>`${m}`);document.addEventListener("keyup",({key:_,keyCode:m})=>{(m>=48&&m<=57||m>=96&&m<=105)&&i.includes(_)&&t("input",_),m===a&&t("input",s)})}),(i,_)=>(c(),p("div",Pt,[St,n("div",Rt,[n("div",Nt,[ue(n("input",{"onUpdate:modelValue":_[0]||(_[0]=m=>we(phone)?phone.value=m:null),maxlength:"10",class:"flex-1 outline-none",readonly:""},null,512),[[re,e.phone]]),d(l)?(c(),p("div",Mt,[d(l)?(c(),b(P,{key:0,icon:"check",class:"text-xl"})):$("",!0)])):$("",!0)]),n("div",Ft,[(c(),p(E,null,D(12,m=>n("button",{key:m,class:H(["phone-button",{invalid:!d(l),"login-button":m===u}]),onClick:g=>t("input",m)},[m<10?(c(),p("span",Ut,h(m),1)):m===s?(c(),b(P,{key:1,icon:"plus",class:"rotate-45"})):m===r?(c(),p("span",Ot,"0")):m===u?(c(),b(P,{key:3,icon:"check",class:"check-icon"})):$("",!0)],10,qt)),64))])])]))}});var Vt=I(Tt,[["__scopeId","data-v-2f1876ce"]]);const Ht=f({setup(e){const r=x(!1),u=x("");A(()=>/((?=(09))[0-9]{10})$/g.test(u.value));const l=M=>{let T=String(M);if(M===10){u.value=u.value.slice(0,-1);return}if(M===12){G();return}M===11&&(T="0"),!(u.value.length>=10)&&(u.value+=T)},i=q(),{isLogin:_}=R(B()),{authLogin:m,authRegister:g}=B();Ce(()=>{_.value&&i.push("/points")});const C=async()=>{r.value=!1,await g({phone:u.value}),alert("\u5B8C\u6210")},G=async()=>{try{await m({phone:u.value,password:u.value})}catch(M){M.message==="this phone not register"&&(r.value=!0)}finally{}};return(M,T)=>(c(),p("div",null,[v(Vt,{onSubmit:G,phone:u.value,onInput:l},null,8,["phone"]),r.value?(c(),b(Dt,{key:0,onSubmit:C,onClose:T[0]||(T[0]=Vn=>r.value=!1)})):$("",!0)]))}});const Gt={class:"flex-center"},jt={class:"grid grid-cols-5 gap-6"},zt={class:"tag"},Qt=f({props:{points:null},setup(e){const t=e,o=[Be,Ie],a=10,s=A(()=>t.points===0?1:Math.ceil(t.points/a)),r=(l,i)=>(s.value-1-l)*a+i,u=(l,i)=>r(l,i)<=t.points;return(l,i)=>(c(),p("section",Gt,[v(d(Ae),{effect:"cards",grabCursor:!0,modules:o,pagination:{clickable:!0}},{default:y(()=>[(c(!0),p(E,null,D(d(s),(_,m)=>(c(),b(d(Ee),{key:`point-card-${_}`},{default:y(()=>[n("div",jt,[(c(),p(E,null,D(a,g=>n("div",{key:`point-${r(m,g)}`,class:H(["point",{"have-stamp":u(m,g)}])},[n("span",zt," UBRO "+h(r(m,g)),1)],2)),64))])]),_:2},1024))),128))]),_:1})]))}});var Xt=I(Qt,[["__scopeId","data-v-2dba6f70"]]);const Jt={class:"flex items-center space-x-4 mb-4"},Zt=n("label",{for:"code"},"\u5B89\u5168\u78BC",-1),Kt={class:"text-red-500 text-sm mb-1"},Wt=["disabled"],Yt=f({props:{number:null},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=B(),s=x(""),r=A(()=>`\u65B0\u589E ${o.number} \u9EDE`),{errorMessage:u}=R(L()),l=async()=>{try{await w.mutate({mutation:k`
          mutation updatePoint($input: UpdatePointInput!) {
            updatePoint(input: $input)
          }
        `,variables:{input:{point:Number(o.number),securityCode:s.value}}}),await a.fetchMe(),t("submit"),t("close")}catch(i){console.log(i)}};return(i,_)=>(c(),b(J,{title:d(r),onClose:_[1]||(_[1]=m=>t("close"))},{default:y(()=>[n("div",Jt,[Zt,ue(n("input",{"onUpdate:modelValue":_[0]||(_[0]=m=>s.value=m),placeholder:"\u8ACB\u8F38\u5165\u5B89\u5168\u78BC",name:"code",type:"password",class:"border px-2",maxlength:"4",minlength:"4"},null,512),[[re,s.value]])]),n("p",Kt,h(d(u)),1),n("button",{disabled:s.value.length<4,class:"btn btn-primary btn-block",onClick:l}," \u78BA\u8A8D\u65B0\u589E ",8,Wt)]),_:1},8,["title"]))}});const es={class:"flex flex-col flex-center"},ts={class:"wrapper"},ss={class:"grid grid-cols-2 gap-6"},ns={class:"card text-3xl flex-center"},os={class:"card p-4 flex justify-between space-x-4"},as={class:"flex-1 flex items-center space-x-6"},us={class:"flex-1 text-center font-bold text-lg"},rs=["disabled"],is=f({setup(e){const{point:t}=R(B()),o=x(!1),a=x(0),s=()=>{a.value++},r=()=>{a.value<=0||a.value--},u=()=>{a.value=0};return(l,i)=>(c(),p("div",es,[n("div",ts,[v(Xt,{points:d(t),class:"mb-5"},null,8,["points"]),n("div",ss,[n("div",ns,"\u7E3D\u9EDE\u6578\uFF1A "+h(d(t))+" \u9EDE",1),n("div",os,[n("div",as,[n("button",{onClick:r,class:"btn control-button"},[v(P,{icon:"minus"})]),n("div",us,h(a.value),1),n("button",{onClick:s,class:"btn control-button"},[v(P,{icon:"plus"})])]),n("button",{class:"btn btn-primary stamp-button",onClick:i[0]||(i[0]=_=>o.value=!0),disabled:a.value===0},[v(P,{icon:"stamp"})],8,rs)])])]),o.value?(c(),b(Yt,{key:0,number:a.value,onClose:i[1]||(i[1]=_=>o.value=!1),onSubmit:u},null,8,["number"])):$("",!0)]))}});var cs=I(is,[["__scopeId","data-v-50971a5e"]]);const ls={class:"product-table rounded-t-2xl bg-white"},ds={class:"product-row !py-4 shadow text-gray-800 sticky top-0 bg-white"},W=f({props:{fields:null},setup(e){return(t,o)=>(c(),p("ul",ls,[n("li",ds,[n("div",null,[(c(!0),p(E,null,D(e.fields,a=>(c(),p("span",{key:a},h(a),1))),128))])]),V(t.$slots,"default")]))}});const ps=["onClick"],_s={class:"check"},ms=f({props:{products:null,active:null,point:null},emits:["change"],setup(e,{emit:t}){return(o,a)=>(c(),b(W,{fields:["\u514C\u63DB","\u54C1\u9805","\u9EDE\u6578"]},{default:y(()=>[(c(!0),p(E,null,D(e.products,s=>(c(),p("li",{onClick:r=>t("change",s.id),key:s.id,class:H(["product-row cursor-pointer",{active:e.active===s.id,"bg-gray-200 bg-opacity-50 pointer-events-none":e.point<s.point}])},[n("div",null,[n("span",null,[n("div",_s,[v(P,{icon:"check"})])]),n("span",null,h(s.name),1),n("span",null,h(s.point),1)])],10,ps))),128))]),_:1}))}});var hs=I(ms,[["__scopeId","data-v-b4cf217e"]]);const vs={class:"flex items-center space-x-4"},fs=f({props:{productId:null},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=B(),s=async()=>{try{await w.mutate({mutation:k`
          mutation exchange($productId: Int!) {
            exchange(productId: $productId)
          }
        `,variables:{productId:o.productId}}),await a.fetchMe(),t("submit"),t("close")}catch(r){console.log(r)}};return(r,u)=>(c(),b(J,{title:"\u78BA\u8A8D\u514C\u63DB?",onClose:u[1]||(u[1]=l=>t("close"))},{default:y(()=>[n("div",vs,[n("button",{class:"btn btn-outline-primary btn-block",onClick:u[0]||(u[0]=l=>t("close"))}," \u53D6\u6D88 "),n("button",{class:"btn btn-primary btn-block",onClick:s},"\u78BA\u8A8D")])]),_:1}))}}),bs={class:"flex-center h-full"},gs={class:"wrapper flex flex-col h-full"},ys={class:"flex-center mb-4 space-x-5"},$s={class:"h1 !font-normal inline-block p-2"},xs=N(" \u76EE\u524D\u6709 "),ks={class:"text-primary-dark font-bold mx-1"},ws=N(" \u9EDE "),Cs={class:"flex-1 bg-white overflow-y-scroll rounded-t-2xl"},Es={class:"sticky top-0 z-10 bg-white px-6 py-3 shadow flex items-center justify-between"},As={class:"flex items-center space-x-4"},Bs=n("span",null,"\u514C\u63DB",-1),Is={class:"border-b-2 border-b-primary pb-0.5 text-xl font-medium"},Ds=N(" \u4F7F\u7528 "),Ls={class:"font-medium text-lg"},Ps=N(" \u9EDE "),Ss=["disabled"],Rs={key:0,class:"flex-center mt-10 font-medium"},Ns=f({setup(e){const{result:t,loading:o}=ie(k`
    query {
      products {
        id
        name
        point
      }
    }
  `),a=ce(t,null,g=>g.products),{point:s}=R(B()),r=x(!1),u=x(null),l=g=>{u.value=u.value===g?null:g},i=A(()=>{if(!!Array.isArray(a.value))return a.value.find(({id:g})=>g===u.value)}),_=A(()=>{var C;const g=((C=i.value)==null?void 0:C.point)||0;return s.value-g}),m=()=>{u.value=null};return(g,C)=>(c(),p("div",bs,[n("div",gs,[n("div",ys,[n("div",$s,[xs,n("span",ks,h(d(_))+" / "+h(d(s)),1),ws])]),n("div",Cs,[n("div",Es,[n("div",As,[Bs,n("span",Is,h(d(i)?d(i).name:"\u5C1A\u672A\u514C\u63DB\u4EFB\u4F55\u5546\u54C1"),1),n("span",null,[Ds,n("span",Ls,h(d(i)?d(i).point:0),1),Ps])]),n("button",{disabled:!u.value,class:"btn btn-primary w-40",onClick:C[0]||(C[0]=G=>r.value=!0)}," \u78BA\u8A8D\u514C\u63DB ",8,Ss)]),d(o)?(c(),p("div",Rs," \u6B63\u5728\u52AA\u529B\u5C0B\u627E\u6709\u4EC0\u9EBC\u53EF\u4EE5\u514C\u63DB\u7684\u597D\u6771\u897F ... ")):(c(),b(hs,{key:1,products:d(a),onChange:l,active:u.value,point:d(s)},null,8,["products","active","point"]))])]),r.value?(c(),b(fs,{key:0,"product-id":u.value,onClose:C[1]||(C[1]=G=>r.value=!1),onSubmit:m},null,8,["product-id"])):$("",!0)]))}}),Z=f({props:{rules:{default:()=>({})},action:null,initialValues:{default:()=>({})}},setup(e){const t=e,{handleSubmit:o,meta:a,values:s,resetForm:r}=De({initialValues:t.initialValues,validationSchema:t.rules}),u=o(async()=>{try{await t.action(s),r()}catch(l){throw l}});return(l,i)=>(c(),p("form",{onSubmit:i[0]||(i[0]=(..._)=>d(u)&&d(u)(..._))},[V(l.$slots,"default",{invalid:!d(a).valid,values:d(s)})],32))}}),Ms={key:0,class:"font-medium block mb-1"},Fs={key:1,class:"text-red-500 mt-1"},qs=f({props:{name:{default:""},label:{default:""}},setup(e){const t=e,{errorMessage:o,handleChange:a,value:s,meta:r}=Le(t.name,void 0,{validateOnValueUpdate:!1}),u=A(()=>o.value?{blur:a,change:a,input:a}:{blur:a,change:a,input:l=>a(l,!1)});return(l,i)=>(c(),p("div",null,[e.label?(c(),p("label",Ms,[n("span",null,h(e.label),1)])):$("",!0),V(l.$slots,"default",{error:d(o),value:d(s),validationListeners:d(u)}),d(o)?(c(),p("div",Fs,h(d(o)),1)):$("",!0)]))}}),Us=["type","placeholder","name","value"],S=f({props:{name:{default:""},label:{default:""},type:{default:"text"},placeholder:{default:""}},setup(e){const t=e,o=A(()=>t.name||t.label||"Field");return(a,s)=>(c(),b(qs,{label:e.label,name:d(o)},{default:y(({error:r,validationListeners:u,value:l})=>[n("input",Pe({class:["form-input bg-white",{"border-red-500":r}],type:e.type,placeholder:e.placeholder,name:d(o),value:l},Se(u)),null,16,Us)]),_:1},8,["label","name"]))}});const Os=e=>(z("data-v-fbe53f98"),e=e(),Q(),e),Ts={class:"container h-full flex lg:items-center"},Vs={class:"w-full grid lg:grid-cols-2 lg:gap-20"},Hs={class:"flex space-x-4"},Gs={class:"btn btn-outline-primary btn-block",type:"button"},js=N("GoBack"),zs=Os(()=>n("button",{class:"btn btn-primary btn-block",type:"submit"},"Login",-1)),Qs={class:"mt-1 text-sm text-red-500"},Xs=Re('<div class="row-start-1 flex flex-col lg:col-start-2 lg:-translate-y-1/2" data-v-fbe53f98><h2 class="h1" data-v-fbe53f98>\u7BA1\u7406\u54E1\u767B\u5165</h2><div class="flex-1 relative text-primary text-[5rem] sm:text-[12.5rem] flex items-center" data-v-fbe53f98><span class="z-10" data-v-fbe53f98>Ubro</span><div class="logo" data-v-fbe53f98></div></div></div>',1),Js=f({setup(e){const t=X({phone:F().required(),password:F().required()}),{adminLogin:o}=B(),a=q();let s=x("");const r=async u=>{try{const{phone:l,password:i}=u;await o({phone:l,password:i}),s.value="",a.push({name:"admin-products.index"})}catch(l){s.value=l.message}};return(u,l)=>{const i=U("router-link");return c(),p("div",Ts,[n("div",Vs,[v(Z,{rules:d(t),action:r,class:"space-y-6"},{default:y(({values:_})=>[v(S,{name:"phone",label:"Account",required:""}),v(S,{name:"password",label:"Password",type:"password"}),n("div",Hs,[n("button",Gs,[v(i,{class:"block",to:"/"},{default:y(()=>[js]),_:1})]),zs]),n("div",Qs,h(d(s)),1)]),_:1},8,["rules"]),Xs])])}}});var Zs=I(Js,[["__scopeId","data-v-fbe53f98"]]);const Ks={class:"container flex-center mt-20"},Ws={class:"bg-white p-10 rounded-2xl"},Ys=["disabled"],en={class:"mt-1 text-sm text-red-500"},tn={class:"mt-1 text-sm text-blue-500"},sn=f({setup(e){const t=X({code:F().required().length(4),codeConfirmation:F().required().oneOf([Ne("code")],"code do not match")});let o=x("");const{errorMessage:a}=R(L()),s=async r=>{const{code:u}=r;o.value="",await w.mutate({mutation:k`
        mutation updateSecurityCode($code: String!) {
          updateSecurityCode(code: $code)
        }
      `,variables:{code:u}}),o.value="\u66F4\u65B0\u6210\u529F"};return(r,u)=>(c(),p("div",Ks,[n("div",Ws,[v(Z,{rules:d(t),action:s,class:"w-64 space-y-6"},{default:y(({invalid:l})=>[v(S,{name:"code",label:"\u5B89\u5168\u78BC",type:"password"}),v(S,{name:"codeConfirmation",label:"\u8ACB\u518D\u8F38\u5165\u4E00\u6B21",type:"password"}),n("button",{disabled:l,class:"btn btn-primary btn-block",type:"submit"}," \u8B8A\u66F4 ",8,Ys),n("div",en,h(d(a)),1),n("div",tn,h(d(o)),1)]),_:1},8,["rules"])])]))}});var nn=I(sn,[["__scopeId","data-v-74cf5f26"]]);const on={class:"h-full flex flex-col"},an={class:"flex justify-center space-x-10 mb-10"},un=["onClick"],rn=f({setup(e){const{exchangeRecords:t,consumeRecords:o}=R(B()),a={EXCHANGE:"\u514C\u63DB\u7D00\u9304",CONSUME:"\u96C6\u9EDE\u7D00\u9304"},s=x("EXCHANGE");return(r,u)=>(c(),p("div",on,[n("div",an,[(c(),p(E,null,D(a,(l,i)=>n("div",{class:H(["tab",{active:s.value===i}]),key:i,onClick:_=>s.value=i},h(l),11,un)),64))]),s.value==="EXCHANGE"?(c(),b(W,{key:0,class:"records",fields:["#","\u54C1\u9805","\u82B1\u8CBB\u9EDE\u6578","\u514C\u63DB\u6642\u9593"]},{default:y(()=>[(c(!0),p(E,null,D(d(t),(l,i)=>(c(),p("li",{key:l.id,class:"product-row"},[n("div",null,[n("span",null,h(i+1),1),n("span",null,h(l.productName),1),n("span",null,h(l.point),1),n("span",null,h(l.createdAt),1)])]))),128))]),_:1})):$("",!0),s.value==="CONSUME"?(c(),b(W,{key:1,class:"records",fields:["#","\u9EDE\u6578","\u66F4\u65B0\u6642\u9593"]},{default:y(()=>[(c(!0),p(E,null,D(d(o),(l,i)=>(c(),p("li",{key:l.id,class:"product-row"},[n("div",null,[n("span",null,h(i+1),1),n("span",null,h(l.point),1),n("span",null,h(l.createdAt),1)])]))),128))]),_:1})):$("",!0)]))}});var cn=I(rn,[["__scopeId","data-v-0cc1c61c"]]);const ln={class:"flex items-center space-x-4"},dn=f({props:{deletedId:null},emits:["close","submit"],setup(e,{emit:t}){const o=e;return(a,s)=>(c(),b(J,{title:"\u78BA\u8A8D\u522A\u9664?",onClose:s[2]||(s[2]=r=>t("close"))},{default:y(()=>[n("div",ln,[n("button",{class:"btn btn-outline-primary btn-block",onClick:s[0]||(s[0]=r=>t("close"))}," \u53D6\u6D88 "),n("button",{class:"btn btn-primary btn-block",onClick:s[1]||(s[1]=r=>t("submit",o.deletedId))}," \u78BA\u8A8D ")])]),_:1}))}});const pn=e=>(z("data-v-5f681052"),e=e(),Q(),e),_n={class:"product-table bg-white h-full overflow-y-scroll rounded-t-2xl"},mn=pn(()=>n("li",{class:"product-row !pt-6 text-gray-800 sticky top-0 bg-white"},[n("div",null,[n("span",null,"\u54C1\u9805"),n("span",null,"\u9EDE\u6578"),n("span",null,"\u529F\u80FD")])],-1)),hn={class:"divide-x-2"},vn={class:"px-2 cursor-pointer"},fn=N(" \u4FEE\u6539 "),bn=["onClick"],gn=f({props:{products:null},emits:["delete-product"],setup(e,{emit:t}){const o=x(!1),a=x(null),s=u=>{a.value=u,Me(()=>o.value=!0)},r=async u=>{await t("delete-product",u),o.value=!1};return(u,l)=>{const i=U("router-link");return c(),p("ul",_n,[mn,(c(!0),p(E,null,D(e.products,_=>(c(),p("li",{key:_.id,class:"product-row"},[n("div",null,[n("span",null,h(_.name),1),n("span",null,h(_.point),1),n("div",hn,[n("span",vn,[v(i,{to:`/admin/products/${_.id}/update`},{default:y(()=>[fn]),_:2},1032,["to"])]),n("span",{class:"text-red-700 px-2 cursor-pointer",onClick:m=>s(_.id)}," \u522A\u9664 ",8,bn)])])]))),128)),o.value?(c(),b(dn,{key:0,onClose:l[0]||(l[0]=_=>o.value=!1),onSubmit:r,"deleted-id":a.value},null,8,["deleted-id"])):$("",!0)])}}});var yn=I(gn,[["__scopeId","data-v-5f681052"]]);const $n={class:"flex justify-end mb-5"},xn={class:"btn btn-primary w-40"},kn=N(" \u65B0\u589E "),wn=f({setup(e){const t=k`
    query {
      products {
        id
        name
        point
      }
    }
  `,{result:o}=ie(t),a=ce(o,null,r=>r.products),s=async r=>{try{await w.mutate({mutation:k`
          mutation deleteProduct($id: Int!) {
            deleteProduct(id: $id)
          }
        `,variables:{id:r},update:(u,{data:{deleteProduct:l}})=>{let i=u.readQuery({query:t});i&&(i={products:i.products.filter(({id:_})=>_!==l)}),u.writeQuery({query:t,data:i})}})}catch(u){throw u}};return(r,u)=>{const l=U("router-link");return c(),p(E,null,[n("div",$n,[n("button",xn,[v(l,{class:"block",to:"/admin/products/create"},{default:y(()=>[kn]),_:1})])]),v(yn,{products:d(a),onDeleteProduct:s},null,8,["products"])],64)}}});const Cn={class:"flex justify-center mt-20"},En={class:"bg-white p-6 rounded-xl wrapper"},An=["disabled"],Bn={key:0,class:"mt-1 text-sm text-red-500"},In=f({setup(e){const t=x(""),o=q(),a=X({name:F().required(),point:le().required()}),s=async r=>{try{const{name:u,point:l}=r;await w.mutate({mutation:k`
          mutation createProduct($input: CreateProductInput!) {
            createProduct(input: $input) {
              id
            }
          }
        `,variables:{input:{name:u,point:Number(l)}}}),await o.push("/admin/products")}catch(u){t.value=u.message}};return(r,u)=>(c(),p("div",Cn,[n("div",En,[v(Z,{rules:d(a),action:s,class:"space-y-6"},{default:y(({invalid:l})=>[v(S,{name:"name",label:"\u54C1\u9805"}),v(S,{name:"point",type:"number",label:"\u9EDE\u6578"}),n("button",{class:"btn btn-primary btn-block",type:"submit",disabled:l}," \u65B0\u589E ",8,An)]),_:1},8,["rules"]),t.value?(c(),p("div",Bn,h(t.value),1)):$("",!0)])]))}});var Dn=I(In,[["__scopeId","data-v-2d6b8f54"]]);const Ln={class:"flex justify-center mt-20"},Pn={class:"bg-white p-6 rounded-xl wrapper"},Sn=["disabled"],Rn=f({setup(e){const t=q(),o=Y(),a=X({name:F().required(),point:le().required()}),s=Fe({name:"",point:0}),r=x(!0),u=async()=>{r.value=!0;const{data:{product:i}}=await w.query({query:k`
        query product($id: Int!) {
          product(id: $id) {
            id
            name
            point
          }
        }
      `,variables:{id:+o.params.id}});s.name=i.name,s.point=i.point,r.value=!1};qe(()=>{u()});const l=async i=>{const{name:_,point:m}=i;await w.mutate({mutation:k`
        mutation updateProduct($input: UpdateProductInput!) {
          updateProduct(input: $input) {
            id
            name
            point
          }
        }
      `,variables:{input:{id:Number(o.params.id),name:_,point:Number(m)}}}),await t.push("/admin/products")};return(i,_)=>(c(),p("div",Ln,[n("div",Pn,[r.value?$("",!0):(c(),b(Z,{key:0,rules:d(a),action:l,"initial-values":d(s),class:"space-y-6"},{default:y(({invalid:m})=>[v(S,{name:"name",label:"\u54C1\u9805"}),v(S,{name:"point",type:"number",label:"\u9EDE\u6578"}),n("button",{class:"btn btn-primary btn-block",type:"submit",disabled:m}," \u66F4\u65B0 ",8,Sn)]),_:1},8,["rules","initial-values"]))])]))}});var Nn=I(Rn,[["__scopeId","data-v-5d58d394"]]);const O=Ue({setup(){Oe(ze,w)},render:()=>Te(ft)}),Mn=Ve(),Fn=[Je,Ze,Ke];function qn(){Fn.forEach(e=>Qe.add(e)),O.component("font-awesome-icon",Xe)}qn();const Un=He({locale:"en",fallbackLocale:"en",messages:{"zh-TW":yt,en:kt}}),On=[{path:"/",component:Ht,name:"home"},{path:"/points",component:cs,name:"user-points",meta:{requiresAuth:!0}},{path:"/records",component:cn,name:"user-records",meta:{requiresAuth:!0}},{path:"/exchange",component:Ns,name:"user-exchange",meta:{requiresAuth:!0}},{path:"/admin/login",name:"admin-login",component:Zs},{path:"/admin/code",name:"admin-code",component:nn},{path:"/admin/products",component:wn,name:"admin-products.index",meta:{requiresAdmin:!0}},{path:"/admin/products/create",component:Dn,name:"admin-products.store",meta:{requiresAdmin:!0}},{path:"/admin/products/:id/update",component:Nn,name:"admin-products.update",meta:{requiresAdmin:!0}}],Tn=Ge({history:je("ubro"),routes:On});O.use(Ct);O.use(Mn);O.use(Un);O.use(Tn);O.mount("#app");
