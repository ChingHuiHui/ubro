var re=Object.defineProperty,le=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var Y=(e,t,n)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Z=(e,t)=>{for(var n in t||(t={}))de.call(t,n)&&Y(e,n,t[n]);if(X)for(var n of X(t))pe.call(t,n)&&Y(e,n,t[n]);return e},ee=(e,t)=>le(e,ce(t));import{I as _e,c as me,s as ve,A as he,g as w,d as fe,a as h,u as K,b as j,e as E,f as M,r as R,o as l,h as _,i as a,j as v,k as p,F as D,l as N,w as x,m as P,t as b,p as T,n as V,q as g,v as y,x as z,T as be,y as ge,z as H,B as ye,C as $e,D as ne,E as oe,G as xe,H as $,J as ke,S as we,K as Ce,P as Ee,L as Be,M as ae,N as ue,O as Ie,Q as Ae,R as Le,U as Pe,V as G,W as q,X as Se,Y as De,Z as Ne,_ as ie,$ as qe,a0 as Me,a1 as Re,a2 as Oe,a3 as Fe,a4 as Ue,a5 as Te,a6 as Ve,a7 as He,a8 as je,a9 as ze,aa as Ge,ab as Qe,ac as Je,ad as Ze}from"./vendor.52bdfd63.js";const Ke=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};Ke();const We=new _e,Xe=me({uri:"https://sx3pwmngq3.execute-api.us-east-1.amazonaws.com/dev/graphql"}),Ye=ve((e,{headers:t})=>{const n=localStorage.getItem("token");return n?{headers:ee(Z({},t),{Authorization:n||null})}:{headers:Z({},t)}}),C=new he({link:Ye.concat(Xe),cache:We});var et=async()=>{try{const{data:{me:e}}=await C.query({query:w`
        query me {
          me {
            phone
            point
            isAdmin
          }
        }
      `,fetchPolicy:"no-cache"});return e}catch(e){console.log(e)}},te=({phone:e,password:t})=>({login:async()=>{try{const{data:{login:s}}=await C.mutate({mutation:w`
          mutation login($input: LoginInput!) {
            login(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return s.token}catch(s){throw s}},adminLogin:async()=>{try{const{data:{adminLogin:s}}=await C.mutate({mutation:w`
          mutation adminLogin($input: LoginInput!) {
            adminLogin(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:e,password:t}}});return s.token}catch(s){throw s}}}),tt=e=>({register:async()=>{try{await C.mutate({mutation:w`
          mutation register($input: RegisterInput!) {
            register(input: $input) {
              phone
            }
          }
        `,variables:{input:{phone:e}}})}catch(n){throw n}}});const se={phone:"",point:0,isAdmin:!1},I=fe("auth",{state:()=>({accessToken:null,user:se}),getters:{isLogin(){return!!this.accessToken},isAdmin(){return this.user.isAdmin},point(){return this.user.point}},actions:{async authLogin({phone:e,password:t}){const{login:n}=te({phone:e,password:t});try{const o=await n();this.setToken(o)}catch(o){throw o}},async authRegister({phone:e}){const{register:t}=tt(e);await t(),await this.authLogin({phone:e,password:e})},async adminLogin({phone:e,password:t}){const{adminLogin:n}=te({phone:e,password:t});try{const o=await n();this.setToken(o)}catch(o){throw o}},authLogout(){this.removeToken(),this.setUser(se)},setToken(e){!e||(this.accessToken=e,localStorage.setItem("token",e))},removeToken(){this.accessToken=null,localStorage.removeItem("token")},setUser(e){this.user=e},async fetchMe(){const e=await et();!e||this.setUser(e)}}});var B=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n};const st=e=>(T("data-v-98caa87a"),e=e(),V(),e),nt={class:"w-56 bg-primary-light"},ot={class:"h-full"},at={class:"h-full p-10 flex flex-col items-center"},ut={class:"mb-5 logo"},it={key:0},rt=st(()=>a("button",{class:"btn btn-primary w-40"},"\u7BA1\u7406\u8005",-1)),lt={key:1},ct=h({setup(e){const t=K(),{isLogin:n,isAdmin:o}=j(I()),s=E(()=>o.value?"/admin/products":"/"),i=E(()=>{var d;return o.value&&n.value?[{label:"\u5546\u54C1",to:"/admin/products"},{label:"\u5B89\u5168\u78BC",to:"/admin/code"}]:!o.value&&n.value&&!((d=t.name)!=null&&d.includes("admin"))?[{label:"\u96C6\u9EDE\u5361",to:"/points"},{label:"\u514C\u63DB",to:"/exchange"}]:[]}),{authLogout:u}=I(),r=M(),c=async()=>{await u(),await r.push("/")};return(d,m)=>{const f=R("router-link");return l(),_("aside",nt,[a("nav",ot,[a("ul",at,[a("li",ut,[v(f,{to:p(s),class:"w-full h-full block"},null,8,["to"])]),(l(!0),_(D,null,N(p(i),({label:k,to:F})=>(l(),_("li",{key:k},[v(f,{to:F},{default:x(()=>[P(b(k),1)]),_:2},1032,["to"])]))),128)),p(n)?(l(),_("li",lt,[a("button",{class:"btn btn-primary w-40",onClick:c},"\u5B8C\u6210")])):(l(),_("li",it,[v(f,{to:"/admin/login"},{default:x(()=>[rt]),_:1})]))])])])}}});var dt=B(ct,[["__scopeId","data-v-98caa87a"]]);const pt={class:"h-screen flex"},_t=h({setup(e){const t=K(),n=M(),o=I(),s=E(()=>t.name==="admin-login");n.beforeEach(async r=>{const c=await localStorage.getItem("token");if(!c)return;const d=i(c);if(d&&u(d))return await o.removeToken(),{name:"home"};if(await o.setToken(c),await o.fetchMe(),r.meta.requiresAuth&&!o.isLogin)return{name:"home"};if(r.meta.requiresAdmin&&!o.isAdmin)return{name:"admin-login"}});const i=r=>{try{if(!r)return null;const{exp:c}=JSON.parse(atob(r.split(".")[1]));return c}catch{return null}},u=r=>Date.now()>r*1e3;return(r,c)=>{const d=R("router-view");return l(),_("div",pt,[p(s)?y("",!0):(l(),g(dt,{key:0})),a("main",{class:z(["flex-1 pt-16 px-10 overflow-x-hidden relative",{"bg-white":p(s)}])},[v(d,null,{default:x(({Component:m})=>[v(be,{name:"fade",mode:"out-in"},{default:x(()=>[(l(),g(ge(m),{key:r.$route.name}))]),_:2},1024)]),_:1})],2)])}}});var mt=B(_t,[["__scopeId","data-v-977a82b2"]]);const vt="\u54C8\u56C9\uFF01\u9019\u662F\u500B vue \u5C08\u6848",ht="\u7B49\u5F85\u4E2D...";var ft={hello:vt,"My name is":"\u6211\u7684\u540D\u5B57\u662F","Ching Hui":"\u6674\u60E0","I'm a Uaena, also a frontend developer :)":"\u6211\u662FUaena\uFF0C\u4E5F\u662F\u4E00\u540D\u524D\u7AEF\u5DE5\u7A0B\u5E2B :)",loading:ht};const bt="Hello! It's a vue project",gt="loading...";var yt={hello:bt,"My name is":"My name is","Ching Hui":"Ching Hui","I'm a Uaena, also a frontend developer :)":"I'm a Uaena, also a rontend developer :)",loading:gt};class $t{set(t,n,o=30){const s={value:n,ttl:Date.now()+o*1e4};localStorage.setItem(t,JSON.stringify(s))}get(t){const n=localStorage.getItem(t);if(!n)return null;const{ttl:o,value:s}=JSON.parse(n);return Date.now()>o?(localStorage.removeItem(t),null):s}}const xt={install:e=>{const t=new $t;e.provide("storage",t)}},A=h({props:{pack:{default:"fas"},icon:{default:""}},setup(e){return(t,n)=>{const o=R("font-awesome-icon");return l(),g(o,{icon:[e.pack,e.icon]},null,8,["icon"])}}}),kt=["onClick"],wt={class:"modal min-w-[300px] bg-white p-6 rounded-lg relative"},Ct={key:0,class:"h1 text-center mb-4"},Q=h({props:{title:{default:""}},emits:["close"],setup(e,{emit:t}){const n=()=>{t("close")};return(o,s)=>(l(),_("div",{class:"fixed inset-0 z-50 bg-black bg-opacity-60 flex-center",onClick:ye(n,["self"])},[a("div",wt,[v(A,{icon:"plus",class:"rotate-45 absolute right-6 top-6 cursor-pointer",onClick:n}),H(o.$slots,"title",{},()=>[e.title?(l(),_("div",Ct,b(e.title),1)):y("",!0)]),H(o.$slots,"default")])],8,kt))}}),Et={class:"flex items-center space-x-4"},Bt=h({emits:["close","submit"],setup(e,{emit:t}){return(n,o)=>(l(),g(Q,{title:"\u65B0\u865F\u78BC\uFF0C\u662F\u5426\u8981\u8A3B\u518A?",onClose:o[2]||(o[2]=s=>t("close"))},{default:x(()=>[a("div",Et,[a("button",{class:"btn btn-outline-primary btn-block",onClick:o[0]||(o[0]=s=>t("close"))}," \u53D6\u6D88 "),a("button",{class:"btn btn-primary btn-block",onClick:o[1]||(o[1]=s=>t("submit"))}," \u78BA\u8A8D ")])]),_:1}))}});const It=e=>(T("data-v-2f1876ce"),e=e(),V(),e),At={class:"flex flex-col items-center"},Lt=It(()=>a("h2",{class:"h1 text-center mb-5"},"LOGIN",-1)),Pt={class:"wrapper"},St={class:"phone-input flex items-center"},Dt={key:0,class:"w-10 h-10 flex-center rounded-full border border-green-500 text-green-500"},Nt={class:"phone-pad"},qt=["onClick"],Mt={key:0},Rt={key:2},Ot=h({props:{phone:null},emits:["submit","input"],setup(e,{emit:t}){const n=e,o=8,s=10,i=11,u=12,r=E(()=>/((?=(09))[0-9]{10})$/g.test(n.phone));return $e(()=>{const c=[...Array(10)].map((d,m)=>`${m}`);document.addEventListener("keyup",({key:d,keyCode:m})=>{(m>=48&&m<=57||m>=96&&m<=105)&&c.includes(d)&&t("input",d),m===o&&t("input",s)})}),(c,d)=>(l(),_("div",At,[Lt,a("div",Pt,[a("div",St,[ne(a("input",{"onUpdate:modelValue":d[0]||(d[0]=m=>xe(phone)?phone.value=m:null),maxlength:"10",class:"flex-1 outline-none",readonly:""},null,512),[[oe,e.phone]]),p(r)?(l(),_("div",Dt,[p(r)?(l(),g(A,{key:0,icon:"check",class:"text-xl"})):y("",!0)])):y("",!0)]),a("div",Nt,[(l(),_(D,null,N(12,m=>a("button",{key:m,class:z(["phone-button",{invalid:!p(r),"login-button":m===u}]),onClick:f=>t("input",m)},[m<10?(l(),_("span",Mt,b(m),1)):m===s?(l(),g(A,{key:1,icon:"plus",class:"rotate-45"})):m===i?(l(),_("span",Rt,"0")):m===u?(l(),g(A,{key:3,icon:"check",class:"check-icon"})):y("",!0)],10,qt)),64))])])]))}});var Ft=B(Ot,[["__scopeId","data-v-2f1876ce"]]);const Ut={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white"},Tt=h({setup(e){const i=$(!1),u=$("");E(()=>/((?=(09))[0-9]{10})$/g.test(u.value));const r=S=>{let U=String(S);if(S===10){u.value=u.value.slice(0,-1);return}if(S===12){W();return}S===11&&(U="0"),!(u.value.length>=10)&&(u.value+=U)},c=M(),{isLogin:d}=j(I()),{authLogin:m,authRegister:f}=I();ke(()=>{d.value&&c.push("/points")});let k=$(!1);const F=async()=>{k.value=!0,i.value=!1,await f({phone:u.value}),k.value=!1,alert("\u5B8C\u6210")},W=async()=>{k.value=!0;try{await m({phone:u.value,password:u.value})}catch(S){S.message==="this phone not register"&&(i.value=!0)}finally{k.value=!1}};return(S,U)=>(l(),_("div",null,[p(k)?(l(),_("div",Ut," Loading ... ")):y("",!0),p(d)?y("",!0):(l(),g(Ft,{key:1,onSubmit:W,phone:u.value,onInput:r},null,8,["phone"])),i.value?(l(),g(Bt,{key:2,onSubmit:F,onClose:U[0]||(U[0]=Mn=>i.value=!1)})):y("",!0)]))}});const Vt={class:"flex-center"},Ht={class:"grid grid-cols-5 gap-6"},jt={class:"tag"},zt=h({props:{points:null},setup(e){const t=e,n=[Ce,Ee],o=10,s=E(()=>t.points===0?1:Math.ceil(t.points/o)),i=(r,c)=>(s.value-1-r)*o+c,u=(r,c)=>i(r,c)<=t.points;return(r,c)=>(l(),_("section",Vt,[v(p(we),{effect:"cards",grabCursor:!0,modules:n,pagination:{clickable:!0}},{default:x(()=>[(l(!0),_(D,null,N(p(s),(d,m)=>(l(),g(p(Be),{key:`point-card-${d}`},{default:x(()=>[a("div",Ht,[(l(),_(D,null,N(o,f=>a("div",{key:`point-${i(m,f)}`,class:z(["point",{"have-stamp":u(m,f)}])},[a("span",jt," UBRO "+b(i(m,f)),1)],2)),64))])]),_:2},1024))),128))]),_:1})]))}});var Gt=B(zt,[["__scopeId","data-v-2dba6f70"]]);const Qt={class:"flex items-center space-x-4 mb-4"},Jt=a("label",{for:"code"},"\u5B89\u5168\u78BC",-1),Zt=["disabled"],Kt=h({props:{number:null},emits:["close","submit"],setup(e,{emit:t}){const n=e,o=I(),s=$(""),i=E(()=>`\u65B0\u589E ${n.number} \u9EDE`),u=async()=>{try{await C.mutate({mutation:w`
          mutation updatePoint($input: UpdatePointInput!) {
            updatePoint(input: $input)
          }
        `,variables:{input:{point:Number(n.number),securityCode:s.value}}}),await o.fetchMe(),t("submit"),t("close")}catch(r){console.log(r)}};return(r,c)=>(l(),g(Q,{title:p(i),onClose:c[1]||(c[1]=d=>t("close"))},{default:x(()=>[a("div",Qt,[Jt,ne(a("input",{"onUpdate:modelValue":c[0]||(c[0]=d=>s.value=d),placeholder:"\u8ACB\u8F38\u5165\u5B89\u5168\u78BC",name:"code",type:"password",class:"border px-2",maxlength:"4",minlength:"4"},null,512),[[oe,s.value]])]),a("button",{disabled:s.value.length<4,class:"btn btn-primary btn-block",onClick:u}," \u78BA\u8A8D\u65B0\u589E ",8,Zt)]),_:1},8,["title"]))}});const Wt={class:"flex flex-col flex-center"},Xt={class:"wrapper"},Yt={class:"bg-white rounded-2xl p-4 w-[20rem] flex justify-between space-x-4"},es={class:"flex-1 flex items-center space-x-6"},ts={class:"flex-1 text-center font-bold text-lg"},ss=["disabled"],ns=h({setup(e){const{point:t}=j(I()),n=$(!1),o=$(0),s=()=>{o.value++},i=()=>{o.value<=0||o.value--},u=()=>{o.value=0};return(r,c)=>(l(),_("div",Wt,[a("div",Xt,[v(Gt,{points:p(t),class:"mb-5"},null,8,["points"]),a("div",Yt,[a("div",es,[a("button",{onClick:i,class:"btn control-button"},[v(A,{icon:"minus"})]),a("div",ts,b(o.value),1),a("button",{onClick:s,class:"btn control-button"},[v(A,{icon:"plus"})])]),a("button",{class:"btn btn-primary stamp-button",onClick:c[0]||(c[0]=d=>n.value=!0),disabled:o.value===0},[v(A,{icon:"stamp"})],8,ss)])]),n.value?(l(),g(Kt,{key:0,number:o.value,onClose:c[1]||(c[1]=d=>n.value=!1),onSubmit:u},null,8,["number"])):y("",!0)]))}});var os=B(ns,[["__scopeId","data-v-7ad3679d"]]);const as=e=>(T("data-v-26926b64"),e=e(),V(),e),us={class:"product-table py-6"},is=as(()=>a("li",{class:"product-row p-2 text-gray-800"},[a("div",null,[a("span",null,"\u514C\u63DB"),a("span",null,"\u54C1\u9805"),a("span",null,"\u9EDE\u6578")])],-1)),rs=["onClick"],ls={class:"check"},cs=h({props:{products:null,active:null,point:null},emits:["change"],setup(e,{emit:t}){return(n,o)=>(l(),_("ul",us,[is,(l(!0),_(D,null,N(e.products,s=>(l(),_("li",{onClick:i=>t("change",s.id),key:s.id,class:z(["product-row cursor-pointer",{active:e.active===s.id,"bg-gray-200 bg-opacity-50 pointer-events-none":e.point<s.point}])},[a("div",null,[a("span",null,[a("div",ls,[v(A,{icon:"check"})])]),a("span",null,b(s.name),1),a("span",null,b(s.point),1)])],10,rs))),128))]))}});var ds=B(cs,[["__scopeId","data-v-26926b64"]]);const ps={class:"flex items-center space-x-4"},_s=h({props:{productId:null},emits:["close","submit"],setup(e,{emit:t}){const n=e,o=I(),s=async()=>{try{await C.mutate({mutation:w`
          mutation exchange($productId: Int!) {
            exchange(productId: $productId)
          }
        `,variables:{productId:n.productId}}),await o.fetchMe(),t("submit"),t("close")}catch(i){console.log(i)}};return(i,u)=>(l(),g(Q,{title:"\u78BA\u8A8D\u514C\u63DB?",onClose:u[1]||(u[1]=r=>t("close"))},{default:x(()=>[a("div",ps,[a("button",{class:"btn btn-outline-primary btn-block",onClick:u[0]||(u[0]=r=>t("close"))}," \u53D6\u6D88 "),a("button",{class:"btn btn-primary btn-block",onClick:s},"\u78BA\u8A8D")])]),_:1}))}}),ms={class:"flex-center h-full"},vs={class:"wrapper flex flex-col h-full"},hs={class:"flex-center mb-4 space-x-5"},fs={class:"h1 !font-normal inline-block p-2"},bs=P(" \u76EE\u524D\u6709 "),gs={class:"text-primary-dark font-bold mx-1"},ys=P(" \u9EDE "),$s={class:"flex-1 bg-white overflow-y-scroll rounded-t-2xl"},xs={class:"sticky top-0 bg-white px-6 py-3 shadow flex items-center justify-between"},ks={class:"flex items-center space-x-4"},ws=a("span",null,"\u514C\u63DB",-1),Cs={class:"border-b-2 border-b-primary pb-0.5 text-xl font-medium"},Es=P(" \u4F7F\u7528 "),Bs={class:"font-medium text-lg"},Is=P(" \u9EDE "),As=["disabled"],Ls={key:0,class:"flex-center mt-10 font-medium"},Ps=h({setup(e){const{result:t,loading:n}=ae(w`
    query {
      products {
        id
        name
        point
      }
    }
  `),o=ue(t,null,f=>f.products),{point:s}=j(I()),i=$(!1),u=$(null),r=f=>{u.value=u.value===f?null:f},c=E(()=>{if(!!Array.isArray(o.value))return o.value.find(({id:f})=>f===u.value)}),d=E(()=>{var k;const f=((k=c.value)==null?void 0:k.point)||0;return s.value-f}),m=()=>{u.value=null};return(f,k)=>(l(),_("div",ms,[a("div",vs,[a("div",hs,[a("div",fs,[bs,a("span",gs,b(p(d))+" / "+b(p(s)),1),ys])]),a("div",$s,[a("div",xs,[a("div",ks,[ws,a("span",Cs,b(p(c)?p(c).name:"\u5C1A\u672A\u514C\u63DB\u4EFB\u4F55\u5546\u54C1"),1),a("span",null,[Es,a("span",Bs,b(p(c)?p(c).point:0),1),Is])]),a("button",{disabled:!u.value,class:"btn btn-primary w-40",onClick:k[0]||(k[0]=F=>i.value=!0)}," \u78BA\u8A8D\u514C\u63DB ",8,As)]),p(n)?(l(),_("div",Ls," \u6B63\u5728\u52AA\u529B\u5C0B\u627E\u6709\u4EC0\u9EBC\u53EF\u4EE5\u514C\u63DB\u7684\u597D\u6771\u897F ... ")):(l(),g(ds,{key:1,products:p(o),onChange:r,active:u.value,point:p(s)},null,8,["products","active","point"]))])]),i.value?(l(),g(_s,{key:0,"product-id":u.value,onClose:k[1]||(k[1]=F=>i.value=!1),onSubmit:m},null,8,["product-id"])):y("",!0)]))}}),J=h({props:{rules:{default:()=>({})},action:null,initialValues:{default:()=>({})}},setup(e){const t=e,{handleSubmit:n,meta:o,values:s,resetForm:i}=Ie({initialValues:t.initialValues,validationSchema:t.rules}),u=n(async()=>{try{await t.action(s),i()}catch(r){throw r}});return(r,c)=>(l(),_("form",{onSubmit:c[0]||(c[0]=(...d)=>p(u)&&p(u)(...d))},[H(r.$slots,"default",{invalid:!p(o).valid,values:p(s)})],32))}}),Ss={key:0,class:"font-medium block mb-1"},Ds={key:1,class:"text-red-500 mt-1"},Ns=h({props:{name:{default:""},label:{default:""}},setup(e){const t=e,{errorMessage:n,handleChange:o,value:s,meta:i}=Ae(t.name,void 0,{validateOnValueUpdate:!1}),u=E(()=>n.value?{blur:o,change:o,input:o}:{blur:o,change:o,input:r=>o(r,!1)});return(r,c)=>(l(),_("div",null,[e.label?(l(),_("label",Ss,[a("span",null,b(e.label),1)])):y("",!0),H(r.$slots,"default",{error:p(n),value:p(s),validationListeners:p(u)}),p(n)?(l(),_("div",Ds,b(p(n)),1)):y("",!0)]))}}),qs=["type","placeholder","name","value"],L=h({props:{name:{default:""},label:{default:""},type:{default:"text"},placeholder:{default:""}},setup(e){const t=e,n=E(()=>t.name||t.label||"Field");return(o,s)=>(l(),g(Ns,{label:e.label,name:p(n)},{default:x(({error:i,validationListeners:u,value:r})=>[a("input",Le({class:["form-input bg-white",{"border-red-500":i}],type:e.type,placeholder:e.placeholder,name:p(n),value:r},Pe(u)),null,16,qs)]),_:1},8,["label","name"]))}});const Ms=e=>(T("data-v-8d56f61e"),e=e(),V(),e),Rs={class:"container h-full flex lg:items-center"},Os={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white"},Fs={class:"w-full grid lg:grid-cols-2 lg:gap-20"},Us={class:"flex space-x-4"},Ts={class:"btn btn-outline-primary btn-block",type:"button"},Vs=P("GoBack"),Hs=Ms(()=>a("button",{class:"btn btn-primary btn-block",type:"submit"},"Login",-1)),js={class:"mt-1 text-sm text-red-500"},zs=Se('<div class="row-start-1 flex flex-col lg:col-start-2 lg:-translate-y-1/2" data-v-8d56f61e><h2 class="h1" data-v-8d56f61e>\u7BA1\u7406\u54E1\u767B\u5165</h2><div class="flex-1 relative text-primary text-[5rem] sm:text-[12.5rem] flex items-center" data-v-8d56f61e><span class="z-10" data-v-8d56f61e>Ubro</span><div class="logo" data-v-8d56f61e></div></div></div>',1),Gs=h({setup(e){const t=G({phone:q().required(),password:q().required()}),{adminLogin:n}=I(),o=M();let s=$(!1),i=$("");const u=async r=>{try{s.value=!0;const{phone:c,password:d}=r;await n({phone:c,password:d}),i.value="",s.value=!1,o.push({name:"admin-products.index"})}catch(c){i.value=c.message,s.value=!1}};return(r,c)=>{const d=R("router-link");return l(),_("div",Rs,[p(s)?(l(),_("div",Os," Loading ... ")):y("",!0),a("div",Fs,[v(J,{rules:p(t),action:u,class:"space-y-6"},{default:x(({values:m})=>[v(L,{name:"phone",label:"Account",required:""}),v(L,{name:"password",label:"Password",type:"password"}),a("div",Us,[a("button",Ts,[v(d,{class:"block",to:"/"},{default:x(()=>[Vs]),_:1})]),Hs]),a("div",js,b(p(i)),1)]),_:1},8,["rules"]),zs])])}}});var Qs=B(Gs,[["__scopeId","data-v-8d56f61e"]]);const Js={class:"container flex-center mt-20"},Zs={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white"},Ks={class:"bg-white p-10 rounded-2xl"},Ws=["disabled"],Xs={class:"mt-1 text-sm text-red-500"},Ys={class:"mt-1 text-sm text-blue-500"},en=h({setup(e){const t=G({code:q().required().length(4),codeConfirmation:q().required().oneOf([De("code")],"code do not match")});let n=$(!1),o=$(""),s=$("");const i=async u=>{try{n.value=!0;const{code:r}=u;await C.mutate({mutation:w`
          mutation updateSecurityCode($code: String!) {
            updateSecurityCode(code: $code)
          }
        `,variables:{code:r}}),o.value="",s.value="\u66F4\u65B0\u6210\u529F",n.value=!1}catch(r){o.value=r.message,s.value="",n.value=!1}};return(u,r)=>(l(),_("div",Js,[p(n)?(l(),_("div",Zs," Loading ... ")):y("",!0),a("div",Ks,[v(J,{rules:p(t),action:i,class:"w-64 space-y-6"},{default:x(({invalid:c})=>[v(L,{name:"code",label:"\u5B89\u5168\u78BC",type:"password"}),v(L,{name:"codeConfirmation",label:"\u4E8C\u6B21\u9A57\u8B49",type:"password"}),a("button",{disabled:c,class:"btn btn-primary btn-block",type:"submit"}," \u8B8A\u66F4 ",8,Ws),a("div",Xs,b(p(o)),1),a("div",Ys,b(p(s)),1)]),_:1},8,["rules"])])]))}});var tn=B(en,[["__scopeId","data-v-c7ed979a"]]);const sn={class:"flex items-center space-x-4"},nn=h({props:{deletedId:null},emits:["close","submit"],setup(e,{emit:t}){const n=e;return(o,s)=>(l(),g(Q,{title:"\u78BA\u8A8D\u522A\u9664?",onClose:s[2]||(s[2]=i=>t("close"))},{default:x(()=>[a("div",sn,[a("button",{class:"btn btn-outline-primary btn-block",onClick:s[0]||(s[0]=i=>t("close"))}," \u53D6\u6D88 "),a("button",{class:"btn btn-primary btn-block",onClick:s[1]||(s[1]=i=>t("submit",n.deletedId))}," \u78BA\u8A8D ")])]),_:1}))}});const on=e=>(T("data-v-5f681052"),e=e(),V(),e),an={class:"product-table bg-white h-full overflow-y-scroll rounded-t-2xl"},un=on(()=>a("li",{class:"product-row !pt-6 text-gray-800 sticky top-0 bg-white"},[a("div",null,[a("span",null,"\u54C1\u9805"),a("span",null,"\u9EDE\u6578"),a("span",null,"\u529F\u80FD")])],-1)),rn={class:"divide-x-2"},ln={class:"px-2 cursor-pointer"},cn=P(" \u4FEE\u6539 "),dn=["onClick"],pn=h({props:{products:null},emits:["delete-product"],setup(e,{emit:t}){const n=$(!1),o=$(null),s=u=>{o.value=u,Ne(()=>n.value=!0)},i=async u=>{await t("delete-product",u),n.value=!1};return(u,r)=>{const c=R("router-link");return l(),_("ul",an,[un,(l(!0),_(D,null,N(e.products,d=>(l(),_("li",{key:d.id,class:"product-row"},[a("div",null,[a("span",null,b(d.name),1),a("span",null,b(d.point),1),a("div",rn,[a("span",ln,[v(c,{to:`/admin/products/${d.id}/update`},{default:x(()=>[cn]),_:2},1032,["to"])]),a("span",{class:"text-red-700 px-2 cursor-pointer",onClick:m=>s(d.id)}," \u522A\u9664 ",8,dn)])])]))),128)),n.value?(l(),g(nn,{key:0,onClose:r[0]||(r[0]=d=>n.value=!1),onSubmit:i,"deleted-id":o.value},null,8,["deleted-id"])):y("",!0)])}}});var _n=B(pn,[["__scopeId","data-v-5f681052"]]);const mn={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white z-50"},vn={class:"flex justify-end mb-5"},hn={class:"btn btn-primary w-40"},fn=P(" \u65B0\u589E "),bn=h({setup(e){const t=w`
    query {
      products {
        id
        name
        point
      }
    }
  `,{result:n}=ae(t),o=ue(n,null,u=>u.products),s=$(!1),i=async u=>{try{s.value=!0,await C.mutate({mutation:w`
          mutation deleteProduct($id: Int!) {
            deleteProduct(id: $id)
          }
        `,variables:{id:u},update:(r,{data:{deleteProduct:c}})=>{let d=r.readQuery({query:t});d&&(d={products:d.products.filter(({id:m})=>m!==c)}),r.writeQuery({query:t,data:d})}}),s.value=!1}catch(r){throw r}};return(u,r)=>{const c=R("router-link");return l(),_(D,null,[s.value?(l(),_("div",mn," Loading ... ")):y("",!0),a("div",vn,[a("button",hn,[v(c,{class:"block",to:"/admin/products/create"},{default:x(()=>[fn]),_:1})])]),v(_n,{products:p(o),onDeleteProduct:i},null,8,["products"])],64)}}});const gn={class:"flex justify-center mt-20"},yn={class:"bg-white p-6 rounded-xl wrapper"},$n=["disabled"],xn={key:0,class:"mt-1 text-sm text-red-500"},kn=h({setup(e){const t=$(""),n=M(),o=G({name:q().required(),point:ie().required()}),s=async i=>{try{const{name:u,point:r}=i;await C.mutate({mutation:w`
          mutation createProduct($input: CreateProductInput!) {
            createProduct(input: $input) {
              id
            }
          }
        `,variables:{input:{name:u,point:Number(r)}}}),await n.push("/admin/products")}catch(u){t.value=u.message}};return(i,u)=>(l(),_("div",gn,[a("div",yn,[v(J,{rules:p(o),action:s,class:"space-y-6"},{default:x(({invalid:r})=>[v(L,{name:"name",label:"\u54C1\u9805"}),v(L,{name:"point",type:"number",label:"\u9EDE\u6578"}),a("button",{class:"btn btn-primary btn-block",type:"submit",disabled:r}," \u65B0\u589E ",8,$n)]),_:1},8,["rules"]),t.value?(l(),_("div",xn,b(t.value),1)):y("",!0)])]))}});var wn=B(kn,[["__scopeId","data-v-2d6b8f54"]]);const Cn={class:"flex justify-center mt-20"},En={class:"bg-white p-6 rounded-xl wrapper"},Bn=["disabled"],In=h({setup(e){const t=M(),n=K(),o=G({name:q().required(),point:ie().required()}),s=qe({name:"",point:0}),i=$(!0),u=async()=>{i.value=!0;const{data:{product:c}}=await C.query({query:w`
        query product($id: Int!) {
          product(id: $id) {
            id
            name
            point
          }
        }
      `,variables:{id:+n.params.id}});s.name=c.name,s.point=c.point,i.value=!1};Me(()=>{u()});const r=async c=>{const{name:d,point:m}=c;await C.mutate({mutation:w`
        mutation updateProduct($input: UpdateProductInput!) {
          updateProduct(input: $input) {
            id
            name
            point
          }
        }
      `,variables:{input:{id:Number(n.params.id),name:d,point:Number(m)}}}),await t.push("/admin/products")};return(c,d)=>(l(),_("div",Cn,[a("div",En,[i.value?y("",!0):(l(),g(J,{key:0,rules:p(o),action:r,"initial-values":p(s),class:"space-y-6"},{default:x(({invalid:m})=>[v(L,{name:"name",label:"\u54C1\u9805"}),v(L,{name:"point",type:"number",label:"\u9EDE\u6578"}),a("button",{class:"btn btn-primary btn-block",type:"submit",disabled:m}," \u66F4\u65B0 ",8,Bn)]),_:1},8,["rules","initial-values"]))])]))}});var An=B(In,[["__scopeId","data-v-5d58d394"]]);const O=Re({setup(){Oe(je,C)},render:()=>Fe(mt)}),Ln=Ue(),Pn=[Qe,Je,Ze];function Sn(){Pn.forEach(e=>ze.add(e)),O.component("font-awesome-icon",Ge)}Sn();const Dn=Te({locale:"en",fallbackLocale:"en",messages:{"zh-TW":ft,en:yt}}),Nn=[{path:"/",component:Tt,name:"home"},{path:"/points",component:os,name:"user-points",meta:{requiresAuth:!0}},{path:"/exchange",component:Ps,name:"user-exchange",meta:{requiresAuth:!0}},{path:"/admin/login",name:"admin-login",component:Qs},{path:"/admin/code",name:"admin-code",component:tn},{path:"/admin/products",component:bn,name:"admin-products.index",meta:{requiresAdmin:!0}},{path:"/admin/products/create",component:wn,name:"admin-products.store",meta:{requiresAdmin:!0}},{path:"/admin/products/:id/update",component:An,name:"admin-products.update",meta:{requiresAdmin:!0}}],qn=Ve({history:He("ubro"),routes:Nn});O.use(xt);O.use(Ln);O.use(Dn);O.use(qn);O.mount("#app");
