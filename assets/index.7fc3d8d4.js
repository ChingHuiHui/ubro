var rt=Object.defineProperty,lt=Object.defineProperties;var dt=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var pt=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable;var Y=(t,e,o)=>e in t?rt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,K=(t,e)=>{for(var o in e||(e={}))pt.call(e,o)&&Y(t,o,e[o]);if(X)for(var o of X(e))_t.call(e,o)&&Y(t,o,e[o]);return t},tt=(t,e)=>lt(t,dt(e));import{I as mt,c as ht,s as vt,A as ft,g as w,d as bt,a as v,u as W,b as z,e as E,f as O,r as U,o as l,h as _,i as a,j as h,k as p,F as q,l as F,w as x,p as V,m as H,n as S,t as b,q as y,v as $,x as g,y as G,z as j,B as yt,C as gt,D as ot,E as at,G as $t,H as it,S as xt,J as wt,P as kt,K as Ct,L as Et,M as Bt,N as It,O as At,Q as Lt,R as Pt,T as Q,U as M,V as St,W as Dt,X as Nt,Y as ct,Z as qt,_ as Rt,$ as Ft,a0 as Mt,a1 as Ot,a2 as Ut,a3 as Tt,a4 as Vt,a5 as Ht,a6 as jt,a7 as zt,a8 as Gt,a9 as Qt,aa as Jt,ab as Zt}from"./vendor.5dac2c1c.js";const Kt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const i of u.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerpolicy&&(u.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?u.credentials="include":n.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(n){if(n.ep)return;n.ep=!0;const u=o(n);fetch(n.href,u)}};Kt();const Wt=new mt,Xt=ht({uri:"https://sx3pwmngq3.execute-api.us-east-1.amazonaws.com/dev/graphql"}),Yt=vt((t,{headers:e})=>{const o=localStorage.getItem("token");return o?{headers:tt(K({},e),{Authorization:o||null})}:{headers:K({},e)}}),k=new ft({link:Yt.concat(Xt),cache:Wt});var te=async()=>{try{const{data:{me:t}}=await k.query({query:w`
        query me {
          me {
            phone
            point
            isAdmin
          }
        }
      `,fetchPolicy:"no-cache"});return t}catch(t){console.log(t)}},et=({phone:t,password:e})=>({login:async()=>{try{const{data:{login:n}}=await k.mutate({mutation:w`
          mutation login($input: LoginInput!) {
            login(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:t,password:e}}});return n.token}catch(n){throw n}},adminLogin:async()=>{try{const{data:{adminLogin:n}}=await k.mutate({mutation:w`
          mutation adminLogin($input: LoginInput!) {
            adminLogin(input: $input) {
              token
            }
          }
        `,variables:{input:{phone:t,password:e}}});return n.token}catch(n){throw n}}}),ee=t=>({register:async()=>{try{await k.mutate({mutation:w`
          mutation register($input: RegisterInput!) {
            register(input: $input) {
              phone
            }
          }
        `,variables:{input:{phone:t}}})}catch(o){throw o}}});const nt={phone:"",point:0,isAdmin:!1},B=bt("auth",{state:()=>({accessToken:null,user:nt}),getters:{isLogin(){return!!this.accessToken},isAdmin(){return this.user.isAdmin},point(){return this.user.point}},actions:{async authLogin({phone:t,password:e}){const{login:o}=et({phone:t,password:e});try{const s=await o();this.setToken(s)}catch(s){throw s}},async authRegister({phone:t}){const{register:e}=ee(t);await e(),await this.authLogin({phone:t,password:t})},async adminLogin({phone:t,password:e}){const{adminLogin:o}=et({phone:t,password:e});try{const s=await o();this.setToken(s)}catch(s){throw s}},authLogout(){this.removeToken(),this.setUser(nt)},setToken(t){!t||(this.accessToken=t,localStorage.setItem("token",t))},removeToken(){this.accessToken=null,localStorage.removeItem("token")},setUser(t){this.user=t},async fetchMe(){const t=await te();!t||this.setUser(t)}}});var A=(t,e)=>{const o=t.__vccOpts||t;for(const[s,n]of e)o[s]=n;return o};const ne=t=>(V("data-v-98caa87a"),t=t(),H(),t),se={class:"w-56 bg-primary-light"},oe={class:"h-full"},ae={class:"h-full p-10 flex flex-col items-center"},ie={class:"mb-5 logo"},ce={key:0},ue=ne(()=>a("button",{class:"btn btn-primary w-40"},"\u7BA1\u7406\u8005",-1)),re={key:1},le=v({setup(t){const e=W(),{isLogin:o,isAdmin:s}=z(B()),n=E(()=>s.value?"/admin/products":"/"),u=E(()=>{var d;return s.value&&o.value?[{label:"\u5546\u54C1",to:"/admin/products"},{label:"\u5B89\u5168\u78BC",to:"/admin/code"}]:!s.value&&o.value&&!((d=e.name)!=null&&d.includes("admin"))?[{label:"\u96C6\u9EDE\u5361",to:"/points"},{label:"\u514C\u63DB",to:"/exchange"}]:[]}),{authLogout:i}=B(),c=O(),r=async()=>{await i(),await c.push("/")};return(d,m)=>{const f=U("router-link");return l(),_("aside",se,[a("nav",oe,[a("ul",ae,[a("li",ie,[h(f,{to:p(n),class:"w-full h-full block"},null,8,["to"])]),(l(!0),_(q,null,F(p(u),({label:C,to:R})=>(l(),_("li",{key:C},[h(f,{to:R},{default:x(()=>[S(b(C),1)]),_:2},1032,["to"])]))),128)),p(o)?(l(),_("li",re,[a("button",{class:"btn btn-primary w-40",onClick:r},"\u5B8C\u6210")])):(l(),_("li",ce,[h(f,{to:"/admin/login"},{default:x(()=>[ue]),_:1})]))])])])}}});var de=A(le,[["__scopeId","data-v-98caa87a"]]);const ut=y(!1);function st(t){ut.value=t}async function I(t){st(!0),await t(),st(!1)}const pe={class:"h-screen flex"},_e={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white z-50"},me=v({setup(t){const e=W(),o=O(),s=B(),n=E(()=>e.name==="admin-login");o.beforeEach(async c=>{const r=await localStorage.getItem("token");if(!r)return;const d=u(r);if(d&&i(d))return await s.removeToken(),{name:"home"};if(await s.setToken(r),await s.fetchMe(),c.meta.requiresAuth&&!s.isLogin)return{name:"home"};if(c.meta.requiresAdmin&&!s.isAdmin)return{name:"admin-login"}});const u=c=>{try{if(!c)return null;const{exp:r}=JSON.parse(atob(c.split(".")[1]));return r}catch{return null}},i=c=>Date.now()>c*1e3;return(c,r)=>{const d=U("router-view");return l(),_("div",pe,[p(ut)?(l(),_("div",_e," Loading ... ")):$("",!0),p(n)?$("",!0):(l(),g(de,{key:1})),a("main",{class:G(["flex-1 pt-16 px-10 overflow-x-hidden relative",{"bg-white":p(n)}])},[h(d)],2)])}}}),he="\u54C8\u56C9\uFF01\u9019\u662F\u500B vue \u5C08\u6848",ve="\u7B49\u5F85\u4E2D...";var fe={hello:he,"My name is":"\u6211\u7684\u540D\u5B57\u662F","Ching Hui":"\u6674\u60E0","I'm a Uaena, also a frontend developer :)":"\u6211\u662FUaena\uFF0C\u4E5F\u662F\u4E00\u540D\u524D\u7AEF\u5DE5\u7A0B\u5E2B :)",loading:ve};const be="Hello! It's a vue project",ye="loading...";var ge={hello:be,"My name is":"My name is","Ching Hui":"Ching Hui","I'm a Uaena, also a frontend developer :)":"I'm a Uaena, also a rontend developer :)",loading:ye};class $e{set(e,o,s=30){const n={value:o,ttl:Date.now()+s*1e4};localStorage.setItem(e,JSON.stringify(n))}get(e){const o=localStorage.getItem(e);if(!o)return null;const{ttl:s,value:n}=JSON.parse(o);return Date.now()>s?(localStorage.removeItem(e),null):n}}const xe={install:t=>{const e=new $e;t.provide("storage",e)}},L=v({props:{pack:{default:"fas"},icon:{default:""}},setup(t){return(e,o)=>{const s=U("font-awesome-icon");return l(),g(s,{icon:[t.pack,t.icon]},null,8,["icon"])}}}),we=["onClick"],ke={class:"modal min-w-[300px] bg-white p-6 rounded-lg relative"},Ce={key:0,class:"h1 text-center mb-4"},J=v({props:{title:{default:""}},emits:["close"],setup(t,{emit:e}){const o=()=>{e("close")};return(s,n)=>(l(),_("div",{class:"fixed inset-0 z-40 bg-black bg-opacity-60 flex-center",onClick:yt(o,["self"])},[a("div",ke,[h(L,{icon:"plus",class:"rotate-45 absolute right-6 top-6 cursor-pointer",onClick:o}),j(s.$slots,"title",{},()=>[t.title?(l(),_("div",Ce,b(t.title),1)):$("",!0)]),j(s.$slots,"default")])],8,we))}}),Ee={class:"flex items-center space-x-4"},Be=v({emits:["close","submit"],setup(t,{emit:e}){return(o,s)=>(l(),g(J,{title:"\u65B0\u865F\u78BC\uFF0C\u662F\u5426\u8981\u8A3B\u518A?",onClose:s[2]||(s[2]=n=>e("close"))},{default:x(()=>[a("div",Ee,[a("button",{class:"btn btn-outline-primary btn-block",onClick:s[0]||(s[0]=n=>e("close"))}," \u53D6\u6D88 "),a("button",{class:"btn btn-primary btn-block",onClick:s[1]||(s[1]=n=>e("submit"))}," \u78BA\u8A8D ")])]),_:1}))}});const Ie=t=>(V("data-v-2f1876ce"),t=t(),H(),t),Ae={class:"flex flex-col items-center"},Le=Ie(()=>a("h2",{class:"h1 text-center mb-5"},"LOGIN",-1)),Pe={class:"wrapper"},Se={class:"phone-input flex items-center"},De={key:0,class:"w-10 h-10 flex-center rounded-full border border-green-500 text-green-500"},Ne={class:"phone-pad"},qe=["onClick"],Re={key:0},Fe={key:2},Me=v({props:{phone:null},emits:["submit","input"],setup(t,{emit:e}){const o=t,s=8,n=10,u=11,i=12,c=E(()=>/((?=(09))[0-9]{10})$/g.test(o.phone));return gt(()=>{const r=[...Array(10)].map((d,m)=>`${m}`);document.addEventListener("keyup",({key:d,keyCode:m})=>{(m>=48&&m<=57||m>=96&&m<=105)&&r.includes(d)&&e("input",d),m===s&&e("input",n)})}),(r,d)=>(l(),_("div",Ae,[Le,a("div",Pe,[a("div",Se,[ot(a("input",{"onUpdate:modelValue":d[0]||(d[0]=m=>$t(phone)?phone.value=m:null),maxlength:"10",class:"flex-1 outline-none",readonly:""},null,512),[[at,t.phone]]),p(c)?(l(),_("div",De,[p(c)?(l(),g(L,{key:0,icon:"check",class:"text-xl"})):$("",!0)])):$("",!0)]),a("div",Ne,[(l(),_(q,null,F(12,m=>a("button",{key:m,class:G(["phone-button",{invalid:!p(c),"login-button":m===i}]),onClick:f=>e("input",m)},[m<10?(l(),_("span",Re,b(m),1)):m===n?(l(),g(L,{key:1,icon:"plus",class:"rotate-45"})):m===u?(l(),_("span",Fe,"0")):m===i?(l(),g(L,{key:3,icon:"check",class:"check-icon"})):$("",!0)],10,qe)),64))])])]))}});var Oe=A(Me,[["__scopeId","data-v-2f1876ce"]]);const Ue=v({setup(t){const u=y(!1),i=y("");E(()=>/((?=(09))[0-9]{10})$/g.test(i.value));const c=D=>{let N=String(D);if(D===10){i.value=i.value.slice(0,-1);return}if(D===12){R();return}D===11&&(N="0"),!(i.value.length>=10)&&(i.value+=N)},r=O(),{isLogin:d}=z(B()),{authLogin:m,authRegister:f}=B();it(()=>{d.value&&r.push("/points")});const C=async()=>{I(async()=>{u.value=!1,await f({phone:i.value})}).then(()=>{alert("\u5B8C\u6210")})},R=async()=>{await I(async()=>{try{await m({phone:i.value,password:i.value})}catch(N){N.message==="this phone not register"&&(u.value=!0)}})};return(D,N)=>(l(),_("div",null,[p(d)?$("",!0):(l(),g(Oe,{key:0,onSubmit:R,phone:i.value,onInput:c},null,8,["phone"])),u.value?(l(),g(Be,{key:1,onSubmit:C,onClose:N[0]||(N[0]=Ds=>u.value=!1)})):$("",!0)]))}});const Te={class:"flex-center"},Ve={class:"grid grid-cols-5 gap-6"},He={class:"tag"},je=v({props:{points:null},setup(t){const e=t,o=[wt,kt],s=10,n=E(()=>e.points===0?1:Math.ceil(e.points/s)),u=(c,r)=>(n.value-1-c)*s+r,i=(c,r)=>u(c,r)<=e.points;return(c,r)=>(l(),_("section",Te,[h(p(xt),{effect:"cards",grabCursor:!0,modules:o,pagination:{clickable:!0}},{default:x(()=>[(l(!0),_(q,null,F(p(n),(d,m)=>(l(),g(p(Ct),{key:`point-card-${d}`},{default:x(()=>[a("div",Ve,[(l(),_(q,null,F(s,f=>a("div",{key:`point-${u(m,f)}`,class:G(["point",{"have-stamp":i(m,f)}])},[a("span",He," UBRO "+b(u(m,f)),1)],2)),64))])]),_:2},1024))),128))]),_:1})]))}});var ze=A(je,[["__scopeId","data-v-2dba6f70"]]);const Ge={class:"flex items-center space-x-4 mb-4"},Qe=a("label",{for:"code"},"\u5B89\u5168\u78BC",-1),Je=["disabled"],Ze=v({props:{number:null},emits:["close","submit"],setup(t,{emit:e}){const o=t,s=B(),n=y(""),u=E(()=>`\u65B0\u589E ${o.number} \u9EDE`),i=async()=>{await I(async()=>{try{await k.mutate({mutation:w`
            mutation updatePoint($input: UpdatePointInput!) {
              updatePoint(input: $input)
            }
          `,variables:{input:{point:Number(o.number),securityCode:n.value}}}),await s.fetchMe(),e("submit"),e("close")}catch(r){console.log(r)}})};return(c,r)=>(l(),g(J,{title:p(u),onClose:r[1]||(r[1]=d=>e("close"))},{default:x(()=>[a("div",Ge,[Qe,ot(a("input",{"onUpdate:modelValue":r[0]||(r[0]=d=>n.value=d),placeholder:"\u8ACB\u8F38\u5165\u5B89\u5168\u78BC",name:"code",type:"password",class:"border px-2",maxlength:"4",minlength:"4"},null,512),[[at,n.value]])]),a("button",{disabled:n.value.length<4,class:"btn btn-primary btn-block",onClick:i}," \u78BA\u8A8D\u65B0\u589E ",8,Je)]),_:1},8,["title"]))}});const Ke={class:"flex flex-col flex-center"},We={class:"wrapper"},Xe={class:"bg-white rounded-2xl p-4 w-[20rem] flex justify-between space-x-4"},Ye={class:"flex-1 flex items-center space-x-6"},tn={class:"flex-1 text-center font-bold text-lg"},en=["disabled"],nn=v({setup(t){const{point:e}=z(B()),o=y(!1),s=y(0),n=()=>{s.value++},u=()=>{s.value<=0||s.value--},i=()=>{s.value=0};return(c,r)=>(l(),_("div",Ke,[a("div",We,[h(ze,{points:p(e),class:"mb-5"},null,8,["points"]),a("div",Xe,[a("div",Ye,[a("button",{onClick:u,class:"btn control-button"},[h(L,{icon:"minus"})]),a("div",tn,b(s.value),1),a("button",{onClick:n,class:"btn control-button"},[h(L,{icon:"plus"})])]),a("button",{class:"btn btn-primary stamp-button",onClick:r[0]||(r[0]=d=>o.value=!0),disabled:s.value===0},[h(L,{icon:"stamp"})],8,en)])]),o.value?(l(),g(Ze,{key:0,number:s.value,onClose:r[1]||(r[1]=d=>o.value=!1),onSubmit:i},null,8,["number"])):$("",!0)]))}});var sn=A(nn,[["__scopeId","data-v-7ad3679d"]]);const on=t=>(V("data-v-26926b64"),t=t(),H(),t),an={class:"product-table py-6"},cn=on(()=>a("li",{class:"product-row p-2 text-gray-800"},[a("div",null,[a("span",null,"\u514C\u63DB"),a("span",null,"\u54C1\u9805"),a("span",null,"\u9EDE\u6578")])],-1)),un=["onClick"],rn={class:"check"},ln=v({props:{products:null,active:null,point:null},emits:["change"],setup(t,{emit:e}){return(o,s)=>(l(),_("ul",an,[cn,(l(!0),_(q,null,F(t.products,n=>(l(),_("li",{onClick:u=>e("change",n.id),key:n.id,class:G(["product-row cursor-pointer",{active:t.active===n.id,"bg-gray-200 bg-opacity-50 pointer-events-none":t.point<n.point}])},[a("div",null,[a("span",null,[a("div",rn,[h(L,{icon:"check"})])]),a("span",null,b(n.name),1),a("span",null,b(n.point),1)])],10,un))),128))]))}});var dn=A(ln,[["__scopeId","data-v-26926b64"]]);const pn={class:"flex items-center space-x-4"},_n=v({props:{productId:null},emits:["close","submit"],setup(t,{emit:e}){const o=t,s=B(),n=async()=>{await I(async()=>{try{await k.mutate({mutation:w`
            mutation exchange($productId: Int!) {
              exchange(productId: $productId)
            }
          `,variables:{productId:o.productId}}),await s.fetchMe(),e("submit"),e("close")}catch(i){console.log(i)}})};return(u,i)=>(l(),g(J,{title:"\u78BA\u8A8D\u514C\u63DB?",onClose:i[1]||(i[1]=c=>e("close"))},{default:x(()=>[a("div",pn,[a("button",{class:"btn btn-outline-primary btn-block",onClick:i[0]||(i[0]=c=>e("close"))}," \u53D6\u6D88 "),a("button",{class:"btn btn-primary btn-block",onClick:n},"\u78BA\u8A8D")])]),_:1}))}}),mn={class:"flex-center h-full"},hn={class:"wrapper flex flex-col h-full"},vn={class:"flex-center mb-4 space-x-5"},fn={class:"h1 !font-normal inline-block p-2"},bn=S(" \u76EE\u524D\u6709 "),yn={class:"text-primary-dark font-bold mx-1"},gn=S(" \u9EDE "),$n={class:"flex-1 bg-white overflow-y-scroll rounded-t-2xl"},xn={class:"sticky top-0 bg-white px-6 py-3 shadow flex items-center justify-between"},wn={class:"flex items-center space-x-4"},kn=a("span",null,"\u514C\u63DB",-1),Cn={class:"border-b-2 border-b-primary pb-0.5 text-xl font-medium"},En=S(" \u4F7F\u7528 "),Bn={class:"font-medium text-lg"},In=S(" \u9EDE "),An=["disabled"],Ln={key:0,class:"flex-center mt-10 font-medium"},Pn=v({setup(t){const{result:e,loading:o}=Et(w`
    query {
      products {
        id
        name
        point
      }
    }
  `),s=Bt(e,null,f=>f.products),{point:n}=z(B()),u=y(!1),i=y(null),c=f=>{i.value=i.value===f?null:f},r=E(()=>{if(!!Array.isArray(s.value))return s.value.find(({id:f})=>f===i.value)}),d=E(()=>{var C;const f=((C=r.value)==null?void 0:C.point)||0;return n.value-f}),m=()=>{i.value=null};return(f,C)=>(l(),_("div",mn,[a("div",hn,[a("div",vn,[a("div",fn,[bn,a("span",yn,b(p(d))+" / "+b(p(n)),1),gn])]),a("div",$n,[a("div",xn,[a("div",wn,[kn,a("span",Cn,b(p(r)?p(r).name:"\u5C1A\u672A\u514C\u63DB\u4EFB\u4F55\u5546\u54C1"),1),a("span",null,[En,a("span",Bn,b(p(r)?p(r).point:0),1),In])]),a("button",{disabled:!i.value,class:"btn btn-primary w-40",onClick:C[0]||(C[0]=R=>u.value=!0)}," \u78BA\u8A8D\u514C\u63DB ",8,An)]),p(o)?(l(),_("div",Ln," \u6B63\u5728\u52AA\u529B\u5C0B\u627E\u6709\u4EC0\u9EBC\u53EF\u4EE5\u514C\u63DB\u7684\u597D\u6771\u897F ... ")):(l(),g(dn,{key:1,products:p(s),onChange:c,active:i.value,point:p(n)},null,8,["products","active","point"]))])]),u.value?(l(),g(_n,{key:0,"product-id":i.value,onClose:C[1]||(C[1]=R=>u.value=!1),onSubmit:m},null,8,["product-id"])):$("",!0)]))}}),Z=v({props:{rules:{default:()=>({})},action:null,initialValues:{default:()=>({})}},setup(t){const e=t,{handleSubmit:o,meta:s,values:n,resetForm:u}=It({initialValues:e.initialValues,validationSchema:e.rules}),i=o(async()=>{try{await e.action(n),u()}catch(c){throw c}});return(c,r)=>(l(),_("form",{onSubmit:r[0]||(r[0]=(...d)=>p(i)&&p(i)(...d))},[j(c.$slots,"default",{invalid:!p(s).valid,values:p(n)})],32))}}),Sn={key:0,class:"font-medium block mb-1"},Dn={key:1,class:"text-red-500 mt-1"},Nn=v({props:{name:{default:""},label:{default:""}},setup(t){const e=t,{errorMessage:o,handleChange:s,value:n,meta:u}=At(e.name,void 0,{validateOnValueUpdate:!1}),i=E(()=>o.value?{blur:s,change:s,input:s}:{blur:s,change:s,input:c=>s(c,!1)});return(c,r)=>(l(),_("div",null,[t.label?(l(),_("label",Sn,[a("span",null,b(t.label),1)])):$("",!0),j(c.$slots,"default",{error:p(o),value:p(n),validationListeners:p(i)}),p(o)?(l(),_("div",Dn,b(p(o)),1)):$("",!0)]))}}),qn=["type","placeholder","name","value"],P=v({props:{name:{default:""},label:{default:""},type:{default:"text"},placeholder:{default:""}},setup(t){const e=t,o=E(()=>e.name||e.label||"Field");return(s,n)=>(l(),g(Nn,{label:t.label,name:p(o)},{default:x(({error:u,validationListeners:i,value:c})=>[a("input",Lt({class:["form-input bg-white",{"border-red-500":u}],type:t.type,placeholder:t.placeholder,name:p(o),value:c},Pt(i)),null,16,qn)]),_:1},8,["label","name"]))}});const Rn=t=>(V("data-v-1f9f8c1c"),t=t(),H(),t),Fn={class:"container h-full flex lg:items-center"},Mn={class:"w-full grid lg:grid-cols-2 lg:gap-20"},On={class:"flex space-x-4"},Un={class:"btn btn-outline-primary btn-block",type:"button"},Tn=S("GoBack"),Vn=Rn(()=>a("button",{class:"btn btn-primary btn-block",type:"submit"},"Login",-1)),Hn={class:"mt-1 text-sm text-red-500"},jn=St('<div class="row-start-1 flex flex-col lg:col-start-2 lg:-translate-y-1/2" data-v-1f9f8c1c><h2 class="h1" data-v-1f9f8c1c>\u7BA1\u7406\u54E1\u767B\u5165</h2><div class="flex-1 relative text-primary text-[5rem] sm:text-[12.5rem] flex items-center" data-v-1f9f8c1c><span class="z-10" data-v-1f9f8c1c>Ubro</span><div class="logo" data-v-1f9f8c1c></div></div></div>',1),zn=v({setup(t){const e=Q({phone:M().required(),password:M().required()}),{adminLogin:o}=B(),s=O();let n=y("");const u=async i=>{await I(async()=>{try{const{phone:r,password:d}=i;await o({phone:r,password:d}),n.value="",s.push({name:"admin-products.index"})}catch(r){n.value=r.message}})};return(i,c)=>{const r=U("router-link");return l(),_("div",Fn,[a("div",Mn,[h(Z,{rules:p(e),action:u,class:"space-y-6"},{default:x(({values:d})=>[h(P,{name:"phone",label:"Account",required:""}),h(P,{name:"password",label:"Password",type:"password"}),a("div",On,[a("button",Un,[h(r,{class:"block",to:"/"},{default:x(()=>[Tn]),_:1})]),Vn]),a("div",Hn,b(p(n)),1)]),_:1},8,["rules"]),jn])])}}});var Gn=A(zn,[["__scopeId","data-v-1f9f8c1c"]]);const Qn={class:"container flex-center mt-20"},Jn={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex-center text-white"},Zn={class:"bg-white p-10 rounded-2xl"},Kn=["disabled"],Wn={class:"mt-1 text-sm text-red-500"},Xn={class:"mt-1 text-sm text-blue-500"},Yn=v({setup(t){const e=Q({code:M().required().length(4),codeConfirmation:M().required().oneOf([Dt("code")],"code do not match")});let o=y(!1),s=y(""),n=y("");const u=async i=>{try{o.value=!0;const{code:c}=i;await k.mutate({mutation:w`
          mutation updateSecurityCode($code: String!) {
            updateSecurityCode(code: $code)
          }
        `,variables:{code:c}}),s.value="",n.value="\u66F4\u65B0\u6210\u529F",o.value=!1}catch(c){s.value=c.message,n.value="",o.value=!1}};return(i,c)=>(l(),_("div",Qn,[p(o)?(l(),_("div",Jn," Loading ... ")):$("",!0),a("div",Zn,[h(Z,{rules:p(e),action:u,class:"w-64 space-y-6"},{default:x(({invalid:r})=>[h(P,{name:"code",label:"\u5B89\u5168\u78BC",type:"password"}),h(P,{name:"codeConfirmation",label:"\u4E8C\u6B21\u9A57\u8B49",type:"password"}),a("button",{disabled:r,class:"btn btn-primary btn-block",type:"submit"}," \u8B8A\u66F4 ",8,Kn),a("div",Wn,b(p(s)),1),a("div",Xn,b(p(n)),1)]),_:1},8,["rules"])])]))}});var ts=A(Yn,[["__scopeId","data-v-c7ed979a"]]);const es={class:"flex items-center space-x-4"},ns=v({props:{deletedId:null},emits:["close","submit"],setup(t,{emit:e}){const o=t;return(s,n)=>(l(),g(J,{title:"\u78BA\u8A8D\u522A\u9664?",onClose:n[2]||(n[2]=u=>e("close"))},{default:x(()=>[a("div",es,[a("button",{class:"btn btn-outline-primary btn-block",onClick:n[0]||(n[0]=u=>e("close"))}," \u53D6\u6D88 "),a("button",{class:"btn btn-primary btn-block",onClick:n[1]||(n[1]=u=>e("submit",o.deletedId))}," \u78BA\u8A8D ")])]),_:1}))}});const ss=t=>(V("data-v-5f681052"),t=t(),H(),t),os={class:"product-table bg-white h-full overflow-y-scroll rounded-t-2xl"},as=ss(()=>a("li",{class:"product-row !pt-6 text-gray-800 sticky top-0 bg-white"},[a("div",null,[a("span",null,"\u54C1\u9805"),a("span",null,"\u9EDE\u6578"),a("span",null,"\u529F\u80FD")])],-1)),is={class:"divide-x-2"},cs={class:"px-2 cursor-pointer"},us=S(" \u4FEE\u6539 "),rs=["onClick"],ls=v({props:{products:null},emits:["delete-product"],setup(t,{emit:e}){const o=y(!1),s=y(null),n=i=>{s.value=i,Nt(()=>o.value=!0)},u=async i=>{await e("delete-product",i),o.value=!1};return(i,c)=>{const r=U("router-link");return l(),_("ul",os,[as,(l(!0),_(q,null,F(t.products,d=>(l(),_("li",{key:d.id,class:"product-row"},[a("div",null,[a("span",null,b(d.name),1),a("span",null,b(d.point),1),a("div",is,[a("span",cs,[h(r,{to:`/admin/products/${d.id}/update`},{default:x(()=>[us]),_:2},1032,["to"])]),a("span",{class:"text-red-700 px-2 cursor-pointer",onClick:m=>n(d.id)}," \u522A\u9664 ",8,rs)])])]))),128)),o.value?(l(),g(ns,{key:0,onClose:c[0]||(c[0]=d=>o.value=!1),onSubmit:u,"deleted-id":s.value},null,8,["deleted-id"])):$("",!0)])}}});var ds=A(ls,[["__scopeId","data-v-5f681052"]]);const ps={class:"flex justify-end mb-5"},_s={class:"btn btn-primary w-40"},ms=S(" \u65B0\u589E "),hs=v({setup(t){const e=w`
    query {
      products {
        id
        name
        point
      }
    }
  `,o=y([]),s=async()=>{await I(async()=>{try{const{data:i}=await k.query({query:e});o.value=i.products}catch(i){throw i}})};it(()=>{s()});const n=async u=>{await I(async()=>{try{await k.mutate({mutation:w`
            mutation deleteProduct($id: Int!) {
              deleteProduct(id: $id)
            }
          `,variables:{id:u},update:(c,{data:{deleteProduct:r}})=>{let d=c.readQuery({query:e});console.log(";PRODUCT_QUERY",e),console.log("data",d),d&&(d={products:d.products.filter(({id:m})=>m!==r)}),c.writeQuery({query:e,data:d})}})}catch(c){throw c}})};return(u,i)=>{const c=U("router-link");return l(),_(q,null,[a("div",ps,[a("button",_s,[h(c,{class:"block",to:"/admin/products/create"},{default:x(()=>[ms]),_:1})])]),h(ds,{products:o.value,onDeleteProduct:n},null,8,["products"])],64)}}});const vs={class:"flex justify-center mt-20"},fs={class:"bg-white p-6 rounded-xl wrapper"},bs=["disabled"],ys={key:0,class:"mt-1 text-sm text-red-500"},gs=v({setup(t){const e=y(""),o=O(),s=Q({name:M().required(),point:ct().required()}),n=async u=>{await I(async()=>{try{const{name:c,point:r}=u;await k.mutate({mutation:w`
            mutation createProduct($input: CreateProductInput!) {
              createProduct(input: $input) {
                id
              }
            }
          `,variables:{input:{name:c,point:Number(r)}}}),await o.push("/admin/products")}catch(c){e.value=c.message}})};return(u,i)=>(l(),_("div",vs,[a("div",fs,[h(Z,{rules:p(s),action:n,class:"space-y-6"},{default:x(({invalid:c})=>[h(P,{name:"name",label:"\u54C1\u9805"}),h(P,{name:"point",type:"number",label:"\u9EDE\u6578"}),a("button",{class:"btn btn-primary btn-block",type:"submit",disabled:c}," \u65B0\u589E ",8,bs)]),_:1},8,["rules"]),e.value?(l(),_("div",ys,b(e.value),1)):$("",!0)])]))}});var $s=A(gs,[["__scopeId","data-v-137ea8fe"]]);const xs={class:"flex justify-center mt-20"},ws={key:0,class:"bg-white p-6 rounded-xl wrapper"},ks=["disabled"],Cs=v({setup(t){const e=y(!1),o=O(),s=W(),n=Q({name:M().required(),point:ct().required()}),u=qt({name:"",point:0}),i=async()=>{const r=async()=>{const{data:{product:d}}=await k.query({query:w`
          query product($id: Int!) {
            product(id: $id) {
              id
              name
              point
            }
          }
        `,variables:{id:+s.params.id}});u.name=d.name,u.point=d.point};e.value=!0,await I(r),e.value=!1};Rt(()=>{i()});const c=async r=>{await I(async()=>{const{name:m,point:f}=r;await k.mutate({mutation:w`
          mutation updateProduct($input: UpdateProductInput!) {
            updateProduct(input: $input) {
              id
              name
              point
            }
          }
        `,variables:{input:{id:Number(s.params.id),name:m,point:Number(f)}}}),await o.push("/admin/products")})};return(r,d)=>(l(),_("div",xs,[e.value?$("",!0):(l(),_("div",ws,[h(Z,{rules:p(n),action:c,"initial-values":p(u),class:"space-y-6"},{default:x(({invalid:m})=>[h(P,{name:"name",label:"\u54C1\u9805"}),h(P,{name:"point",type:"number",label:"\u9EDE\u6578"}),a("button",{class:"btn btn-primary btn-block",type:"submit",disabled:m}," \u66F4\u65B0 ",8,ks)]),_:1},8,["rules","initial-values"])]))]))}});var Es=A(Cs,[["__scopeId","data-v-172e6b37"]]);const T=Ft({setup(){Mt(jt,k)},render:()=>Ot(me)}),Bs=Ut(),Is=[Qt,Jt,Zt];function As(){Is.forEach(t=>zt.add(t)),T.component("font-awesome-icon",Gt)}As();const Ls=Tt({locale:"en",fallbackLocale:"en",messages:{"zh-TW":fe,en:ge}}),Ps=[{path:"/",component:Ue,name:"home"},{path:"/points",component:sn,name:"user-points",meta:{requiresAuth:!0}},{path:"/exchange",component:Pn,name:"user-exchange",meta:{requiresAuth:!0}},{path:"/admin/login",name:"admin-login",component:Gn},{path:"/admin/code",name:"admin-code",component:ts},{path:"/admin/products",component:hs,name:"admin-products.index",meta:{requiresAdmin:!0}},{path:"/admin/products/create",component:$s,name:"admin-products.store",meta:{requiresAdmin:!0}},{path:"/admin/products/:id/update",component:Es,name:"admin-products.update",meta:{requiresAdmin:!0}}],Ss=Vt({history:Ht("ubro"),routes:Ps});T.use(xe);T.use(Bs);T.use(Ls);T.use(Ss);T.mount("#app");
